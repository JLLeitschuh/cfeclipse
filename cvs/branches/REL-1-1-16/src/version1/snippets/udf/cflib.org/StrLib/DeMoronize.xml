<?xml version="1.0" encoding="utf-8"?>
<snippet>
<name>DeMoronize</name>
<help>Fixes text using Micro$oft Latin-1 "Extentions", namely ASCII characters 128-160.</help>
<starttext><![CDATA[
/**
 * Fixes text using Microsoft Latin-1 &quot;Extentions&quot;, namely ASCII characters 128-160.
 * 
 * @param text 	 Text to be modified. (Required)
 * @return Returns a string. 
 * @author Shawn Porter (sporter@rit.net) 
 * @version 1, September 16, 2002 
 */
function DeMoronize (text) {
    var i = 1;

    // Map strategically incompatible non-ISO characters in the
    // range 0x82 -- 0x9F into plausible substitutes where
    // possible.
	Text = Replace(Text, Chr(130), ",", "All");
	Text = Replace(Text, Chr(131), "<em>f</em>", "All");
	Text = Replace(Text, Chr(132), ",,", "All");
	Text = Replace(Text, Chr(133), "...", "All");
		
	Text = Replace(Text, Chr(136), "^", "All");

	Text = Replace(Text, Chr(139), ")", "All");
	Text = Replace(Text, Chr(140), "Oe", "All");

	Text = Replace(Text, Chr(145), "`", "All");
	Text = Replace(Text, Chr(146), "'", "All");
	Text = Replace(Text, Chr(147), """", "All");
	Text = Replace(Text, Chr(148), """", "All");
	Text = Replace(Text, Chr(149), "*", "All");
	Text = Replace(Text, Chr(150), "-", "All");
	Text = Replace(Text, Chr(151), "--", "All");
	Text = Replace(Text, Chr(152), "~", "All");
	Text = Replace(Text, Chr(153), "&tm;", "All");

	Text = Replace(Text, Chr(155), ")", "All");
	Text = Replace(Text, Chr(156), "oe", "All");
	
	// Now check for any remaining untranslated characters.
	for (i = 128; i LTE 160; i = i + 1)
	{
		Text = Replace(Text, Chr(i), "", "All");
	}
	
    // Supply missing semicolon at end of numeric entity
	Text = ReReplace(Text, "&##([0-2][[:digit:]]{2})([^;])", "&##\1;\2", "All");
	
    // Fix obscure numeric rendering of &lt; &gt; &amp;
	Text = ReReplace(Text, "&##038;", "&amp;", "All");
	Text = ReReplace(Text, "&##060;", "&lt;", "All");
	Text = ReReplace(Text, "&##062;", "&gt;", "All");

	// Supply missing semicolon at the end of &amp; &quot;
	Text = ReReplace(Text, "&(^;)", "&amp;\1", "All");
	Text = ReReplace(Text, ""(^;)", "&quot;\1", "All");
	
	Return Text;
} ]]></starttext>
<endtext><![CDATA[ ]]></endtext>
</snippet>