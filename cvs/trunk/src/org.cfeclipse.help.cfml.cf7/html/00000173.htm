<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="Content-Style-Type" content="text/css">
   <script src="pages.js" type="text/javascript" language="Javascript1.2" charset="UTF-8"></script>
   <title>Exercise 1: Deleting the current trip record shown on the Trip Detail page</title>
</head>
<body>
<p align="right"><p align="right"><a href="00000172.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00000174.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<hr />
<h1>Exercise 1: Deleting the current trip record shown on the Trip Detail page</h1>
<p>In <a href="00000166.htm#1141005">Lesson 8: Implementing Browsing and Searching</a>, you created the tripeditaction.cfm page to contain server side edits for the trip edit data entry form. In this lesson, you complete the tripeditaction.cfm page.</p>
<p>Before you can write the code to delete a trip, you must understand the underlying SQL statement to delete rows from the trips table.</p>
<p>The SQL DELETE statement removes existing rows in a relational table. The DELETE statement has the following format:</p>
<pre>DELETE FROM table_name WHERE column_name = some_value
</pre><p>For example, the database table named Clients contains holds information about people, in the following rows:</p>
<table border="0" cellpadding="0" cellspacing="0">
  <tr>
    <th>
LastName
    </th>
    <th>
FirstName
    </th>
    <th>
Address
    </th>
    <th>
City
    </th>
  </tr>
  <tr>
    <td>
<p>Jones</p>
    </td>
    <td>
<p>Tom</p>
    </td>
    <td>
<p>50 Main St</p>
    </td>
    <td>
<p>New York</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>Adamson</p>
    </td>
    <td>
<p>Anita</p>
    </td>
    <td>
<p>521 Beacon St</p>
    </td>
    <td>
<p>Boston</p>
    </td>
  </tr>
  <tr>
    <td>
<p>Green</p>
    </td>
    <td>
<p>Peter</p>
    </td>
    <td>
<p>1 Broadway</p>
    </td>
    <td>
<p>New York</p>
    </td>
  </tr>
</table>

<p>To delete everyone from New York from the table, use the following statement:</p>
<pre>DELETE FROM Clients WHERE City = &#39;New York&#39;
</pre><p>After the database management system processes the preceding statement, the table contains the following row only:</p>
<table border="0" cellpadding="0" cellspacing="0">
  <tr>
    <th>
LastName
    </th>
    <th>
FirstName
    </th>
    <th>
Address
    </th>
    <th>
City
    </th>
  </tr>
  <tr>
    <td>
<p>Adamson</p>
    </td>
    <td>
<p>Anita</p>
    </td>
    <td>
<p>521 Beacon St</p>
    </td>
    <td>
<p>Boston</p>
    </td>
  </tr>
</table>

<p>To ensure that the Trip Maintenance application deletes only the proper trip, you must use the unique <code>tripID</code> key when issuing the SQL DELETE statement. The <code>RecordID</code> field holds the <code>tripID</code>. Using the hidden <code>RecordID</code> <code>input</code> tag from the Trip Detail page, the following SQL statement deletes a row from the Trips table:</p>
<pre>DELETE FROM trips WHERE tripID = #Form.RecordID#
</pre><h4>To enable users to delete trips:</h4>
<ol>
<li>
   Open the maintenanceaction.cfm file in the my_app directory in your editor.
</li>
<li>
   Add the highlighted code in the file.
<pre>
&lt;cfif IsDefined(&quot;Form.btnSearch&quot;)&gt;
	&lt;!--- Code to execute if the user clicked Search. ---&gt;
	&lt;cflocation url=&quot;tripsearchform.cfm&quot;&gt;
&lt;cfelseif IsDefined(&quot;Form.btnDelete&quot;)&gt;
	&lt;!--- Code to execute if the user clicked Delete. ---&gt;
	&lt;cfquery name=&quot;DeleteRecord&quot; datasource=&quot;CompassTravel&quot;&gt;
		DELETE FROM trips WHERE tripID = #Form.RecordID#
	&lt;/cfquery&gt;
&lt;cflocation url=&quot;tripdetail.cfm&quot;&gt;
&lt;cfelseif IsDefined(&quot;Form.btnEdit&quot;)&gt;
	&lt;!--- Code to execute if the user clicked Edit. ---&gt;
&lt;cfelseif IsDefined(&quot;Form.btnAdd&quot;)&gt;
	&lt;!--- Code to execute if the user clicked Add. ---&gt;
&lt;/cfif&gt;
</pre>
</li>
<li>
   Save the page.
</li>
</ol>
<h4>To test the delete capability:</h4>
<ol>
<li>
   View the tripdetail.cfm page in a browser. 
<p>The current trip is Nepal. Notice that the destination for the Nepal Summit Challenge<strong> </strong>trip is Imji Himal, Nepal. </p>
</li>
<li>
   Click Search.
<p>The Trip Search page appears. </p>
</li>
<li>
   In the Trip Search page, select Begins With in the selection box for Trip Location. 
</li>
<li>
   Enter <strong>Imji</strong> in the Trip Location field.
</li>
<li>
   Click Search. 
</li>
<li>
   Verify that only one trip is found whose location<strong> </strong>begins with Imji. 
</li>
<li>
   To return to the Trip Detail page for this trip, click Nepal Summit Challenge
</li>
<li>
   In the Trip Detail page, click Delete.
</li>
<li>
   Click Search.
</li>
<li>
   Select Beings With in the selection box for Trip Location.
</li>
<li>
   Enter <strong>Imji</strong> in the Trip Location field.
</li>
<li>
   Click Search.
<p>There should be no records, because you deleted the trip.</p>
</li>
</ol>


<hr />
<p align="right"><p align="right"><a href="00000172.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00000174.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<p><a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00000173.htm" target="mm_window">View comments in LiveDocs</a></p>
 </body>
</html>



