<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="Content-Style-Type" content="text/css">
   <script src="pages.js" type="text/javascript" language="Javascript1.2" charset="UTF-8"></script>
   <title>cfsearch</title>
</head>
<body>
<p align="right"><p align="right"><a href="00000329.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00000331.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<hr />
<h1>cfsearch</h1>
<h4><a name="wp1355867"></a>Description</h4>
<p>Searches one or more Verity collections.</p>
<p>A collection must be created and indexed before this tag can return search results.</p>
<p>A collection can be <i>created</i> in these ways:</p>
<ul>
<li>
   With the <a href="00000230.htm#1097667"><code>cfcollection</code></a> tag
</li>
<li>
   In the ColdFusion&#160;MX Administrator 
</li>
<li>
   Using a native Verity indexing tool, such as Vspider or MKVDK. For more information on Vspider and MKVDK, see <a href="00001776.htm#1000101">Introducing Verity and Verity Tools</a> in <i>Configuring and Administering ColdFusion&#160;MX</i>.
</li>
</ul>
<p>If you use a native Verity tool to create a collection, it must be registered. A collection can be <i>registered with ColdFusion</i> in the following ways:</p>
<ul>
<li>
   With the <a href="00000230.htm#1097667"><code>cfcollection</code></a> tag
</li>
<li>
   In the ColdFusion&#160;MX Administrator
</li>
</ul>
<p>A collection can be <i>indexed</i> in the following ways:</p>
<ul>
<li>
   In ColdFusion, with the <a href="00000278.htm#1100286"><code>cfindex</code></a> tag
</li>
<li>
   In the ColdFusion MX Administrator, which calls the <code>cfindex</code> tag 
</li>
<li>
   Using a native Verity indexing tool, such as Vspider or MKVDK 
</li>
</ul>
<p>For more information, see <a href="00001301.htm#1164916">Building a Search Interface</a> in <i>ColdFusion MX Developer's Guide</i>.</p>
<h4><a name="wp2691416"></a>Category</h4>
<p><a href="00000202.htm#2459750">Extensibility tags</a></p>
<h4><a name="wp2691424"></a>Syntax</h4>
<pre>&lt;cfsearch <br />   name = &quot;search_name&quot;<br />   collection = &quot;collection_name&quot;<br />category = &quot;category[,category2,...]&quot;<br />categoryTree = &quot;tree_location&quot;<br />   status = &quot;&quot;<br />   type = &quot;criteria&quot;<br />   criteria = &quot;search_expression&quot;<br />   maxRows = &quot;number&quot;<br />   startRow = &quot;row_number&quot;<br />   suggestions = &quot;suggestion_option&quot;<br />   contextPassages = &quot;number_of_passages&quot;<br />   contextBytes = &quot;number_of_bytes&quot;<br />   contextHighlightBegin = &quot;html_string&quot;<br />   contextHighlightEnd = &quot;html_string&quot;<br />   previousCriteria = &quot;criteria&quot;<br />   language = &quot;language&quot;&gt;
</pre><h4><a name="wp1960135"></a>See also</h4>
<p><a href="00000230.htm#1097667">cfcollection</a>, <a href="00000243.htm#1098198">cfexecute</a>, <a href="00000278.htm#1100286">cfindex</a>, <a href="00000302.htm#2820239">cfobject</a>, <a href="00000323.htm#1102863">cfreport</a>, <a href="00000351.htm#2682044">cfwddx</a></p>
<h4><a name="wp2439765"></a>History</h4>
<p>ColdFusion&#160;MX&#160;7: </p>
<ul>
<li>
   Added <code>category</code>, <code>categoryTree</code>, <code>status</code>, <code>suggestions</code>, <code>contextPassages</code>, <code>contextBytes</code>, <code>contextHighlightBegin</code>, <code>contextHighlightEnd</code>, and <code>previousCriteria</code> attributes. 
</li>
<li>
   Added <code>author</code>, <code>category</code>, <code>categoryTree</code>, <code>context</code>, <code>rank</code>, <code>size</code>, <code>recordsSearched</code>, and <code>type</code> result columns.
</li>
<li>
   Added information on the status structure and its associated keys.
</li>
<li>
   Removed references to a separate K2 server and k2server.ini file.
</li>
<li>
   Removed references to unregistered collections.
</li>
<li>
   Removed references to external collections. ColdFusion&#160;MX now manages all collections through the Verity Search service.
</li>
<li>
   Changed <code>cflock</code> recommendation. It is no longer a best practice to surround the <code>cfsearch</code> tag with a <code>cflock</code> tag.
</li>
</ul>
<p>ColdFusion&#160;MX: </p>
<ul>
<li>
   Deprecated the <code>external</code> attribute. It might not work, and might cause an error, in later releases. (ColdFusion stores this information about each collection; it automatically detects whether a collection is internal or external.) This tag supports absolute (also known as fully qualified) collection pathnames and mapped collection names. 
</li>
<li>
   Changed query result behavior: the <code>cfindex</code> tag can index the query results from a <code>cfsearch</code> operation. 
</li>
<li>
   Changed Verity operations behavior: ColdFusion supports Verity operations on Acrobat PDF files.
</li>
<li>
   Changed multiple collection behavior: this tag can search multiple collections. In a multiple collection search, you cannot combine collections that are registered with K2Server and registered in another way.
</li>
<li>
   Changed acceptable collection naming: this tag accepts collection names that include spaces. 
</li>
<li>
   Changed the following support: this tag supports Verity 2.6.1 and the LinguistX and ICU locales. 
</li>
<li>
   Changed thrown exceptions: this tag can throw the SEARCHENGINE exception.
</li>
</ul>
<h4><a name="wp1428228"></a>Attributes</h4>
<table border="0" cellpadding="0" cellspacing="0">
  <tr>
    <th>
Attribute
    </th>
    <th>
Req/Opt
    </th>
    <th>
Default
    </th>
    <th>
Description
    </th>
  </tr>
  <tr>
    <td>
<p>name</p>
    </td>
    <td>
<p>Required</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>Name of the search query. </p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>collection </p>
    </td>
    <td>
<p>Required</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>One or more collection names. You can specify more than one collection unless you are performing a category search (that is, specifying <code>category</code> or <code>categoryTree</code>).</p>
    </td>
  </tr>
  <tr>
    <td>
<p>category</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>A list of categories, separated by commas, to which the search is limited. If specified, and the collection does not have categories enabled, ColdFusion throws an exception.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>categoryTree</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>The location in a hierarchical category tree at which to start the search. ColdFusion searches at and below this level. If specified, and the collection does not have categories enabled, ColdFusion throws an exception. Can be used in addition to the <code>category</code> attribute.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>status</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>Specifies the name of the structure variable into which ColdFusion places search information, including alternative criteria suggestions (spelling corrections). For a list of keys in this structure, see <a href="00000330.htm#2805325">Status structure keys</a>.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>type </p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>simple </p>
    </td>
    <td>
<p>Used to specify the parser that Verity uses to process the criteria.</p>
<ul>
<li>
   simple: STEM and MANY operators are implicitly used. 
</li>
<li>
   explicit: operators must be invoked explicitly. Also known as Bool_Plus.
</li>
<li>
   internet: for documents that are mostly WYSIWIG (what-you-see-is-what-you-get) documents. Also known as Internet_advanced.
</li>
<li>
   internet_basic: minimizes search time.
</li>
<li>
   natural: specifies the Query By Example (QBE) parser. Also known as FreeText.
</li>
</ul>
<p>For more information, see <a href="00001322.htm#1160419">Using Verity Search Expressions</a> in <i>ColdFusion MX Developer's Guide</i>. Also see your Verity documentation.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>criteria</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>Search criteria. Follows the syntax rules of the <code>type</code> attribute. If you pass a mixed-case entry in this attribute, the search is case-sensitive. If you pass all uppercase or all lowercase, the search is case-insensitive. Follow Verity syntax and delimiter character rules; see <a href="00001322.htm#1160419">Using Verity Search Expressions</a> in <i>ColdFusion MX Developer's Guide</i>.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>maxRows</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>All</p>
    </td>
    <td>
<p>Maximum number of rows to return in query results.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>startRow</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>1</p>
    </td>
    <td>
<p>First row number to get.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>suggestions</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>never</p>
    </td>
    <td>
<p>Specifies whether Verity returns spelling suggestions for possibly misspelled words. Use one of the following options:</p>
<ul>
<li>
   Always: Verity always returns spelling suggestions.
</li>
<li>
   Never: Verity never returns spelling suggestions.
</li>
<li>
   positive integer: Verity returns spelling suggestions if the number of documents retrieved by the search is less than or equal to the number specified. 
</li>
</ul>
<p>There is a small performance penalty for retrieving suggestion data.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>contextPassages</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>0</p>
    </td>
    <td>
<p>The number of passages/sentences Verity returns in the context summary (that is, the <code>context</code> column of the results). The default i s 0, which disables context summary.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>contextBytes</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>300</p>
    </td>
    <td>
<p>The maximum number of bytes Verity returns in the context summary. </p>
    </td>
  </tr>
  <tr>
    <td>
<p>contextHighlightBegin</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>&lt;b&gt;</p>
    </td>
    <td>
<p>The HTML to prepend to search terms in the context summary. Use this attribute in conjunction with <code>contextHighlightEnd</code> to highlight search terms in the context summary.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>contextHighlightEnd</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>&lt;/b&gt;</p>
    </td>
    <td>
<p>The HTML to append to search terms in the context summary. Use this attribute in conjunction with <code>contextHighlightBegin</code> to highlight search terms in the context summary.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>previousCriteria</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>The name of a result set from an existing set of search results. Verity searches the result set for <code>criteria</code> without regard to the previous search score or rank. Use this attribute to implement searching within result sets.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>language</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>english</p>
    </td>
    <td>
<p>Deprecated. This attribute is now ignored and the language of the collection is used to perform the search. </p>
    </td>
  </tr>
</table>

<h4><a name="wp1103148"></a>Usage</h4>
<p>The <code>cfsearch</code> tag returns a query object whose columns you can reference in a <code>cfoutput</code> tag. For example, the following code specifies a search for the exact terms &quot;filming&quot; or &quot;filmed&quot;:</p>
<pre>&lt;cfsearch<br />name = &quot;mySearch&quot;<br />collection = &quot;myCollection&quot;<br />criteria = &#39;&lt;WILDCARD&gt;`film{ing,ed}`&#39;<br />type=&quot;explicit&quot;<br />startrow=1
   maxrows = &quot;100&quot;&gt;
&lt;cfdump var = &quot;#mySearch#&gt;
</pre><p>In this example, the single-quotation mark (<code>&#39;</code>) and backtick (<code>`</code>) characters are used as delimiters; for more information, see <a href="00001322.htm#1160419">Using Verity Search Expressions</a> in <i>ColdFusion MX Developer's Guide</i>.</p>
<p>To optimize search performance, always specify the <code>maxrows</code> attribute, setting it to a value that matches your application's needs. A value less than 300 helps to ensure optimal performance.</p>
<p>Macromedia does not recommend using the <a href="00000285.htm#1100787"><code>cflock</code></a> tag with this tag; Verity provides the locking function. Using the <a href="00000285.htm#1100787"><code>cflock</code></a><code> </code>tag slows search performance.</p>
<h4><a name="wp2694035"></a>The cfsearch tag result columns</h4>
<table border="0" cellpadding="0" cellspacing="0">
  <tr>
    <th>
Variable
    </th>
    <th>
Description
    </th>
  </tr>
  <tr>
    <td>
<pre>context
</pre>    </td>
    <td>
<p>A context summary containing the search terms, highlighted in bold (by default). This is enabled if you set the <code>contextpassages</code> attribute to a number greater than zero.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<pre>url
</pre>    </td>
    <td>
<p>Value of <code>URLpath</code> attribute in the <code>cfindex</code> tag used to populate a collection.</p>
    </td>
  </tr>
  <tr>
    <td>
<pre>key
</pre>    </td>
    <td>
<p>Value of the <code>key</code> attribute in the <code>cfindex</code> tag used to populate a collection.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<pre>title
</pre>    </td>
    <td>
<p>Value of <code>title</code> attribute in <code>cfindex</code> tag used to populate the collection, including PDF and Office document titles. If a title is not extracted from the document, the tag uses the <code>cfindex</code> <code>title</code> attribute value for each row. </p>
    </td>
  </tr>
  <tr>
    <td>
<pre>score
</pre>    </td>
    <td>
<p>Relevancy score of document based on search criteria</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<pre>custom1, custom2,
custom3, custom4
</pre>    </td>
    <td>
<p>Value of custom fields in <code>cfindex</code> tag used to populate a collection.</p>
    </td>
  </tr>
  <tr>
    <td>
<pre>size
</pre>    </td>
    <td>
<p>The number of bytes in the index document.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<pre>rank
</pre>    </td>
    <td>
<p>The rank of this document in the search results. </p>
    </td>
  </tr>
  <tr>
    <td>
<pre>author
</pre>    </td>
    <td>
<p>Extracted from the HTML, Office, and PDF documents when available.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<pre>type
</pre>    </td>
    <td>
<p>The MIME type of the document. </p>
    </td>
  </tr>
  <tr>
    <td>
<pre>category
</pre>    </td>
    <td>
<p>A list of the categories that were specified for this document when it was indexed.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<pre>categoryTree
</pre>    </td>
    <td>
<p>A hierarchical category tree, or serial list of categories, that was specified for this document when it was indexed. Only a single tree is returned.</p>
    </td>
  </tr>
  <tr>
    <td>
<pre>summary
</pre>    </td>
    <td>
<p>Contents of automatic summary generated by <code>cfindex</code>. </p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<pre>recordCount
</pre>    </td>
    <td>
<p>Number of records returned in record set</p>
    </td>
  </tr>
  <tr>
    <td>
<pre>currentRow
</pre>    </td>
    <td>
<p>Current row that <code>cfoutput</code> is processing.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<pre>columnList
</pre>    </td>
    <td>
<p>List of column names within record set.</p>
    </td>
  </tr>
  <tr>
    <td>
<pre>recordsSearched
</pre>    </td>
    <td>
<p>Number of records searched. This is the same value for each row in the record set. Corresponds to the <code>searched</code> key in the status structure.</p>
    </td>
  </tr>
</table>

<h4><a name="wp2805325"></a>Status structure keys</h4>
<table border="0" cellpadding="0" cellspacing="0">
  <tr>
    <th>
Variable
    </th>
    <th>
Description
    </th>
  </tr>
  <tr>
    <td>
<pre>found
</pre>    </td>
    <td>
<p>The number of documents that contain the search criteria. </p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<pre>searched
</pre>    </td>
    <td>
<p>The number of documents searched. Corresponds to the <code>recordsSearched</code> column in the search results. </p>
    </td>
  </tr>
  <tr>
    <td>
<pre>time
</pre>    </td>
    <td>
<p>The number of milliseconds the search took, as reported by the Verity K2 search service. </p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<pre>suggestedQuery
</pre>    </td>
    <td>
<p>An alternative query, as suggested by Verity, that might produce better results. This often contains corrected spellings of search terms. Present only when the <code>suggestions</code> tag attribute criteria is met.</p>
    </td>
  </tr>
  <tr>
    <td>
<pre>keywords
</pre>    </td>
    <td>
<p>A structure containing each search term as a key to an array of up to five possible alternative terms, in order of preference. Present only when the <code>suggestions</code> attribute criteria is met.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<pre>keywordScore
</pre>    </td>
    <td>
<p>A structure in the same format as for keywords, except it also includes Verity-reported weighted values from 0 to .99, in which higher scores indicate better-quality results.</p>
    </td>
  </tr>
</table>

<p>To permit application users to search Verity collections for nonstandard strings, words, or characters (for example, &quot;AB23.45.67&quot; or &quot;---&gt;&quot;) that would otherwise cause an error, you can create a text file that lists these elements and defines their formats for Verity. Name the file style.lex and put copies of the file in these directories:</p>
<ul>
<li>
   Windows: 
<ul><li><i>cf_root</i>\verity\k2\common\style (typically, <i>cf_root</i> = C:\CFusionMX7)</li>
<li><i>cf_root</i>\verity\Data\stylesets\ColdFusionK2</li>
</ul></li>
<li>
   UNIX: 
<ul><li><i>cf_root</i>//verity/k2/common/style (typically, <i>cf_root</i> = /opt/coldfusionmx7)</li>
<li><i>cf_root</i>/verity/Data/stylesets/ColdFusionK2 </li>
</ul></li>
</ul>
<p>In the multiserver and J2EE configurations, you install Verity in a separate directory.</p>
<p><strong>Note: </strong>To search for a character such as an angle bracket (&lt; or &gt;), you must use a <code>criteria</code> attribute value such as <code>&quot;&amp;lt:&quot;</code> or <code>&quot;&amp;lt:&quot;</code>. The bracket characters are reserved in Verity, and using a backslash to escape the character (<code>criteria=&quot;\&lt;&quot;</code>) does not work in this context. For more information, see <a href="00001322.htm#1160419">Using Verity Search Expressions</a> in <i>ColdFusion MX Developer's Guide</i>.</p><h4><a name="wp2672958"></a>Example</h4>
<pre>&lt;!--- #1 (TYPE=SIMPLE) -----------------------------&gt;
&lt;cfsearch 
   name=&quot;name&quot; 
   collection=&quot;snippets,syntax,snippets&quot; 
   criteria=&quot;example&quot; 
   maxrows = &quot;100&quot;&gt;
&lt;p&gt;
&lt;cfoutput&gt;Search Result total =  #name.RecordCount# &lt;/cfoutput&gt;&lt;br&gt;
&lt;cfoutput&gt;
   url=#name.url#&lt;br&gt;
   key=#name.key#&lt;br&gt;
   title=#name.title#&lt;br&gt;
   score=#name.score#&lt;br&gt;
   custom1=#name.custom1#&lt;br&gt;
   custom2=#name.custom2#&lt;br&gt;
   summary=#name.summary#&lt;br&gt;
   recordcount=#name.recordcount#&lt;br&gt;
   currentrow=#name.currentrow#&lt;br&gt;
   columnlist=#name.columnlist#&lt;br&gt;
   recordssearched=#name.recordssearched#&lt;br&gt;
&lt;/cfoutput&gt;
&lt;cfdump var = #name#&gt;
&lt;br&gt;

&lt;!--- #2 (TYPE=EXPLICIT) -----------------------------&gt;
&lt;cfsearch 
   name = &quot;snippets&quot;
   collection = &quot;snippets&quot;
   criteria = &#39;&lt;wildcard&gt;`film{ing,ed}`&#39;
   type=&quot;explicit&quot;
   startrow=1
   maxrows = &quot;100&quot;&gt;
&lt;cfoutput 
   query=&quot;snippets&quot;&gt;
   url=#url#&lt;br&gt;
   key=#key#&lt;br&gt;
   title=#title#&lt;br&gt;
   score=#score#&lt;br&gt;
   custom1=#custom1#&lt;br&gt;
   custom2=#custom2#&lt;br&gt;
   summary=#summary#&lt;br&gt;
   recordcount=#recordcount#&lt;br&gt;
   currentrow=#currentrow#&lt;br&gt;
   columnlist=#columnlist#&lt;br&gt;
   recordssearched=#recordssearched#&lt;br&gt;
&lt;/cfoutput&gt;
&lt;cfdump var = #snippets#&gt; 
&lt;br&gt;

&lt;!--- #3 (search by CF key) -----------------------------&gt;
&lt;cfsearch 
   name = &quot;book&quot;
   collection = &quot;custom_book&quot;
   criteria = &quot;cf_key=bookid2&quot;
   maxrows = &quot;100&quot;&gt;
&lt;cfoutput&gt;
   url=#book.url#&lt;br&gt;
   key=#book.key#&lt;br&gt;
   title=#book.titleE#&lt;br&gt;
   score=#book.score#&lt;br&gt;
   custom1=#book.custom1#&lt;br&gt;
   custom2=#book.custom2#&lt;br&gt;
   summary=#book.summary#&lt;br&gt;
   recordcount=#book.recordcount#&lt;br&gt;
   currentrow=#book.currentrow#&lt;br&gt;
   columnlist=#book.columnlist#&lt;br&gt;
   recordssearched=#book.recordssearched#&lt;br&gt;
&lt;/cfoutput&gt;
&lt;cfdump var = #book#&gt; 
</pre>

<hr />
<p align="right"><p align="right"><a href="00000329.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00000331.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<p><a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00000330.htm" target="mm_window">View comments in LiveDocs</a></p>
 </body>
</html>



