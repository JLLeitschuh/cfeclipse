<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="Content-Style-Type" content="text/css">
   <script src="pages.js" type="text/javascript" language="Javascript1.2" charset="UTF-8"></script>
   <title>onAddBuddyResponse</title>
</head>
<body>
<p align="right"><p align="right"><a href="00000747.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00000749.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<hr />
<h1>onAddBuddyResponse</h1>
<h4><a name="wp1169191"></a>Description</h4>
<p>Handles incoming responses from other users to requests from the gateway to be added to their buddy lists. Also receives requests from buddies to have you remove them from your buddy list.</p>
<h4><a name="wp1169193"></a>Syntax</h4>
<pre>onAddBuddyResponse(CFEvent)
</pre><h4><a name="wp1169195"></a>See also</h4>
<p><a href="00000751.htm#1184666"><code>onIncomingMessage</code></a>, <a href="00000747.htm#1169057"><code>onAddBuddyRequest</code></a>, <a href="00000749.htm#1169283"><code>onBuddyStatus</code></a>, <a href="00000750.htm#1169392"><code>onIMServerMessage</code></a></p>
<h4><a name="wp1169212"></a>Parameters</h4>
<p>The method must take one parameter, a CFEvent structure with the following fields:</p>
<table border="0" cellpadding="0" cellspacing="0">
  <tr>
    <th>
Field
    </th>
    <th>
Description
    </th>
  </tr>
  <tr>
    <td>
<p>gatewayType</p>
    </td>
    <td>
<p>Gateway type, either XMPP or SAMETIME.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>gatewayID</p>
    </td>
    <td>
<p>The ID of the gateway instance, as configured in ColdFusion MX Administrator.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>originatorID</p>
    </td>
    <td>
<p>The IM ID of the message originator.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>cfcMethod</p>
    </td>
    <td>
<p>This CFC method; by default, onAddBuddyResponse.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>data.MESSAGE</p>
    </td>
    <td>
<p>One of the following:</p>
<ul>
<li>
   accept&#160;The request was accepted.
</li>
<li>
   decline&#160;The request was declined, or the buddy is asking you to remove them from your list.
</li>
</ul>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>data.SENDER</p>
    </td>
    <td>
<p>The sender's ID; identical to the originatorID.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>data.RECIPIENT</p>
    </td>
    <td>
<p>The recipient's ID, as specified in the gateway's configuration file.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>data.TIMESTAMP</p>
    </td>
    <td>
<p>The date and time when the message was sent.</p>
    </td>
  </tr>
</table>

<h4><a name="wp1169254"></a>Returns</h4>
<p>The function does not return a value.</p>
<h4><a name="wp1169256"></a>Example</h4>
<p>The following example adds the buddy's status to the Application scope buddyStatus structure if the message sender accepted an add buddy request. It logs all responses.</p>
<pre>&lt;cffunction name=&quot;onAddBuddyResponse&quot;&gt;
   &lt;cfargument name=&quot;CFEvent&quot; type=&quot;struct&quot; required=&quot;YES&quot;&gt;
   &lt;cflock scope=&quot;APPLICATION&quot; timeout=&quot;10&quot; type=&quot;EXCLUSIVE&quot;&gt;
      &lt;cfscript&gt;
         //Do the following only if the buddy accepted the request.
         if (NOT StructKeyExists(Application, &quot;buddyStatus&quot;)) {
            Application.buddyStatus=StructNew();
            }
         if (#CFEVENT.Data.MESSAGE# IS &quot;accept&quot;) {
            //Create a new entry in the buddyStatus record for the buddy.
            if (NOT StructKeyExists(Application.buddyStatus,
                  CFEvent.Data.SENDER)) {
               Application.buddyStatus[#CFEvent.Data.SENDER#]=StructNew();
            }
            //Set the buddy status information to indicate buddy was added.
            Application.buddyStatus[#CFEvent.Data.SENDER#].status=
               &quot;Buddy accepted us&quot;;
            Application.buddyStatus[#CFEvent.Data.SENDER#].timeStamp=
               CFEvent.Data.TIMESTAMP;
            Application.buddyStatus[#CFEvent.Data.SENDER#].message=
               CFEvent.Data.MESSAGE;
         }
      &lt;/cfscript&gt;
   &lt;/cflock&gt;
   &lt;!--- Log the information for all responses. ---&gt;
   &lt;cflog file=&quot;#CFEvent.GatewayID#Status&quot;
      text=&quot;onAddBuddyResponse; BUDDY: #CFEvent.Data.SENDER# RESPONSE:
#CFEvent.Data.MESSAGE# TIMESTAMP: #CFEvent.Data.TIMESTAMP#&quot;&gt;
&lt;/cffunction&gt;
</pre>

<hr />
<p align="right"><p align="right"><a href="00000747.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00000749.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<p><a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00000748.htm" target="mm_window">View comments in LiveDocs</a></p>
 </body>
</html>



