<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="Content-Style-Type" content="text/css">
   <script src="pages.js" type="text/javascript" language="Javascript1.2" charset="UTF-8"></script>
   <title>Handling end tags</title>
</head>
<body>
<p align="right"><p align="right"><a href="00001079.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001081.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<hr />
<h1>Handling end tags</h1>
<p>The examples of custom tags shown so far in this chapter all reference a custom tag using just a start tag, as in:</p>
<pre>&lt;cf_date&gt;
</pre><p>In this case, ColdFusion calls the custom tag page date.cfm to process the tag. </p>
<p>However, you can create custom tags that have both a start and an end tag. For example, the following tag has both a start and an end tag:</p>
<pre>&lt;cf_date&gt; 
   ...
&lt;/cf_date&gt;
</pre><p>ColdFusion calls the custom tag page date.cfm twice for a tag that includes an end tag: once for the start tag and once for the end tag. As part of the date.cfm page, you can determine if the call is for the start or end tag, and perform the appropriate processing. </p>
<p>ColdFusion will also call the custom tag page twice if you use the shorthand form of an end tag:</p>
<pre>&lt;cf_date/&gt; 
</pre><p>You can also call a custom tag using the <code>cfmodule</code> tag, as shown in the following example:</p>
<pre>&lt;cfmodule ...&gt;
   ...
&lt;/cfmodule&gt;
</pre><p>If you specify an end tag to <a href="00000300.htm#1810047"><code>cfmodule</code></a>, then ColdFusion calls your custom tag as if it had both a start and an end tag. </p>
<h3><a name="wp1125433"></a>Determining if an end tag is specified</h3>
<p>You can write a custom tag that requires users to include an end tag. If a tag must have an end tag provided, you can use <code>thisTag.HasEndTag</code> in the custom tag page to verify that the user included the end tag.</p>
<p>For example, in date.cfm, you could include the following code to determine whether the end tag is specified:</p>
<pre>&lt;cfif thisTag.HasEndTag is &#39;False&#39;&gt;
   &lt;!--- Abort the tag---&gt;
   &lt;cfabort showError=&quot;An end tag is required.&quot;&gt;
&lt;/cfif&gt;
</pre><h3><a name="wp1127104"></a>Determining the tag execution mode</h3>
<p>The variable <code>thisTag.ExecutionMode</code> contains the mode of invocation of a custom tag page. The variable has one of the following values:</p>
<ul>
<li>
   <strong>Start</strong>&#160;Mode for processing the start tag.
</li>
<li>
   <strong>End</strong>&#160;Mode for processing the end tag.
</li>
<li>
   <strong>Inactive</strong> &#160;Mode when the custom tag uses nested tags. For more information, see <a href="00001083.htm#1114228">Nesting custom tags</a>.
</li>
</ul>
<p>If an end tag is not explicitly provided, ColdFusion invokes the custom tag page only once, in Start mode.</p>
<p>A custom tag page named bold.cfm that makes text bold could be written as follows:</p>
<pre>&lt;cfif thisTag.ExecutionMode is &#39;start&#39;&gt;
   &lt;!--- Start tag processing ---&gt;
   &lt;B&gt;
&lt;cfelse&gt;
   &lt;!--- End tag processing ---&gt;
   &lt;/B&gt;
&lt;/cfif&gt;
</pre><p>You then use this tag to convert the text to bold:</p>
<pre>&lt;cf_bold&gt;This is bold text&lt;/cf_bold&gt;
</pre><p>You can also use <code>cfswitch</code> to determine the execution mode of a custom tag: </p>
<pre>&lt;cfswitch expression=#thisTag.ExecutionMode#&gt;
   &lt;cfcase value= &#39;start&#39;&gt;
      &lt;!--- Start tag processing ---&gt;
   &lt;/cfcase&gt;
   &lt;cfcase value=&#39;end&#39;&gt;
      &lt;!--- End tag processing ---&gt;
   &lt;/cfcase&gt;
&lt;/cfswitch&gt;
</pre><h3><a name="wp1127069"></a>Considerations when using end tags</h3>
<p>How you code your custom tag to divide processing between the start tag and end tag is greatly dependent on the function of the tag. However, you can use the following rules to help you make your decisions:</p>
<ul>
<li>
   Use the start tag to validate input attributes, set default values, and validate the presence of the end tag if it is required by the custom tag. 
</li>
<li>
   Use the end tag to perform the actual processing of the tag, including any body text passed to the tag between the start and end tags. For more information on body text, see <a href="00001081.htm#1128784">Processing body text</a>. 
</li>
<li>
   Perform output in either the start or end tag; do not divide it between the two tags. 
</li>
</ul>


<hr />
<p align="right"><p align="right"><a href="00001079.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001081.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<p><a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00001080.htm" target="mm_window">View comments in LiveDocs</a></p>
 </body>
</html>



