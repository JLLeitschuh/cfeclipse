<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="Content-Style-Type" content="text/css">
   <script src="pages.js" type="text/javascript" language="Javascript1.2" charset="UTF-8"></script>
   <title>cfpop</title>
</head>
<body>
<p align="right"><p align="right"><a href="00000310.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00000312.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<hr />
<h1>cfpop</h1>
<h4><a name="wp1355801"></a>Description</h4>
<p>Retrieves or deletes e-mail messages from a POP mail server.</p>
<h4><a name="wp1957504"></a>Category</h4>
<p><a href="00000206.htm#2460062">Internet Protocol tags</a></p>
<h4><a name="wp1829066"></a>Syntax</h4>
<pre>&lt;cfpop <br />   server = &quot;servername&quot;<br />   port = &quot;port_number&quot;<br />   username = &quot;username&quot;<br />   password = &quot;password&quot;<br />   action = &quot;action&quot;<br />   name = &quot;queryname&quot;<br />   messageNumber = &quot;number&quot;<br />   uid = &quot;number&quot; <br />   attachmentPath = &quot;path&quot;<br />   timeout = &quot;seconds&quot;<br />   maxRows = &quot;number&quot;<br />   startRow = &quot;number&quot;<br />   generateUniqueFilenames = &quot;yes&quot; or &quot;no&quot;<br />   debug = &quot;yes&quot; or &quot;no&quot;&gt;
</pre><h4><a name="wp1957511"></a>See also</h4>
<p><a href="00000259.htm#1800554">cfftp</a>, <a href="00000272.htm#1632966">cfhttp</a>, <a href="00000283.htm#1100581">cfldap</a>, <a href="00000297.htm#2355015">cfmail</a>, <a href="00000298.htm#1101294">cfmailparam</a>, <a href="00000624.htm#136340">SetLocale</a>; <a href="00001592.htm#1120458">Sending and Receiving E-Mail</a> in <i>ColdFusion MX Developer's Guide</i>.</p>
<h4><a name="wp2742498"></a>History</h4>
<p>ColdFusion MX&#160;6.1: </p>
<ul>
<li>
   Added support for multipart mail messages with Text and HTML parts.
</li>
<li>
   Changed the attachment name separator: the TAB character is now the separator between attachment names in the <code>attachments</code> and <code>attachmentfiles</code> query fields if a message has multiple attachments. This behavior is identical to ColdFusion 5 and earlier versions.
</li>
</ul>
<p>ColdFusion MX: Changed the attachment name separator: the comma separates names in the <code>attachments</code> and <code>attachmentfiles</code> query fields if a message has multiple attachments. </p>
<h4><a name="wp2752398"></a>Attributes</h4>
<table border="0" cellpadding="0" cellspacing="0">
  <tr>
    <th>
Attribute
    </th>
    <th>
Req/Opt
    </th>
    <th>
Default
    </th>
    <th>
Description
    </th>
  </tr>
  <tr>
    <td>
<p>server</p>
    </td>
    <td>
<p>Required</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>POP server identifier:</p>
<ul>
<li>
   A host name; for example, &quot;<code>biff.upperlip.com</code>&quot;.
</li>
<li>
   An IP address; for example, &quot;<code>192.1.2.225</code>&quot;.
</li>
</ul>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>port</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>110</p>
    </td>
    <td>
<p>POP port.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>username</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>A user name.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>password</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>Password that corresponds to <code>username</code>.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>action</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>getHeaderOnly</p>
    </td>
    <td>
<ul>
<li>
   getHeaderOnly: returns message header information only
</li>
<li>
   getAll: returns message header information, message text, and attachments if <code>attachmentPath</code> is specified
</li>
<li>
   delete: deletes messages on POP server 
</li>
</ul>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>name</p>
    </td>
    <td>
<p>Required if <code>action</code> <code>=</code> <code>&quot;getAll&quot;</code> or <code>&quot;getHeaderOnly&quot;</code></p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>Name for query object that contains the retrieved message information.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>message<br />Number</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>Message number or comma-delimited list of message numbers to get or delete. Invalid message numbers are ignored.</p>
<p>Ignored if <code>uid</code> is specified.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>uid</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>UID or a comma-delimited list of UIDs to get or delete. Invalid UIDs are ignored.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>attachmentPath</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>If <code>action=&quot;getAll&quot;</code>, specifies a directory in which to save any attachments. If the directory does not exist, ColdFusion creates it.</p>
<p>If you omit this attribute, ColdFusion does not save any attachments. If you specify a relative path, the path root is the ColdFusion temporary directory, which is returned by the <code>GetTempDirectory</code> function.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>timeout</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>60</p>
    </td>
    <td>
<p>Maximum time, in seconds, to wait for mail processing.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>maxRows</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>retrieves all available rows</p>
    </td>
    <td>
<p>Number of messages to return or delete, starting with the number in <code>startRow</code>. Ignored if <code>messageNumber</code> or <code>uid</code> is specified.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>startRow</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>1</p>
    </td>
    <td>
<p>First row number to get or delete. Ignored if <code>messageNumber</code> or <code>uid</code> is specified.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>generate<br />Unique<br />Filenames</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>No</p>
    </td>
    <td>
<ul>
<li>
   Yes: generate unique filenames for files attached to an e-mail message, to avoid naming conflicts when files are saved.
</li>
<li>
   No
</li>
</ul>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>debug</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>No</p>
    </td>
    <td>
<ul>
<li>
   Yes: sends debugging output to standard output. By default, if the console window is unavailable on server configurations, ColdFusion sends output to cf_root/runtime/logs/coldfusion-out.log. On J2EE configurations, with JRun, the default location is <i>jrun_home</i>/logs/<i>servername</i>-out.log. <br /><i>Caution</i>: If you set this option to Yes, ColdFusion MX writes detailed debugging information to the log, including all retrieved message contents, and can generate large logs quickly.
</li>
<li>
   No: does not generate debugging output.
</li>
</ul>
    </td>
  </tr>
</table>

<h4><a name="wp1102001"></a>Usage</h4>
<p>The <code>cfpop</code> tag retrieves one or more mail messages from a POP server and populates a ColdFusion query object with the resulting messages, one message per row. Alternatively, it deletes one or more messages from the POP server.</p>
<p><strong>Note: </strong>When the <code>cfpop</code> tag encounters malformed mail messages, it does not generate errors; instead, it returns empty fields.</p><p>To optimize performance, two retrieve options are available. Message header information is typically short, and therefore quick to transfer. Message text and attachments can be very long, and therefore take longer to process.</p>
<h4><a name="wp1957587"></a>cfpop query variables</h4>
<p>The following table describes the variables that provide information about the query that is returned by <code>cfpop</code>: </p>
<table border="0" cellpadding="0" cellspacing="0">
  <tr>
    <th>
Variable names
    </th>
    <th>
Description
    </th>
  </tr>
  <tr>
    <td>
<p>queryname.recordCount</p>
    </td>
    <td>
<p>Number of records returned by query</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>queryname.currentRow</p>
    </td>
    <td>
<p>Current row that <code>cfoutput</code> is processing</p>
    </td>
  </tr>
  <tr>
    <td>
<p>queryname.columnList</p>
    </td>
    <td>
<p>List of column names in query</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>queryname.UID</p>
    </td>
    <td>
<p>Unique identifier for the e-mail message file</p>
    </td>
  </tr>
</table>

<h4><a name="wp2752483"></a>Query message header and body columns</h4>
<p>The following table lists the message header and body columns that are returned if <code>action</code> = &quot;<code>getHeaderOnly&quot;</code> or &quot;<code>getAll&quot;</code>: </p>
<table border="0" cellpadding="0" cellspacing="0">
  <tr>
    <th>
Column name
    </th>
    <th>
getHeaderOnly returns 
    </th>
    <th>
getAll returns
    </th>
  </tr>
  <tr>
    <td>
<p>queryname.date</p>
    </td>
    <td>
<p>yes</p>
    </td>
    <td>
<p>yes</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>queryname.from</p>
    </td>
    <td>
<p>yes</p>
    </td>
    <td>
<p>yes</p>
    </td>
  </tr>
  <tr>
    <td>
<p>queryname.messagenumber</p>
    </td>
    <td>
<p>yes</p>
    </td>
    <td>
<p>yes</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>queryname.messageid</p>
    </td>
    <td>
<p>yes</p>
    </td>
    <td>
<p>yes</p>
    </td>
  </tr>
  <tr>
    <td>
<p>queryname.replyto</p>
    </td>
    <td>
<p>yes</p>
    </td>
    <td>
<p>yes</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>queryname.subject</p>
    </td>
    <td>
<p>yes</p>
    </td>
    <td>
<p>yes</p>
    </td>
  </tr>
  <tr>
    <td>
<p>queryname.cc</p>
    </td>
    <td>
<p>yes</p>
    </td>
    <td>
<p>yes</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>queryname.to</p>
    </td>
    <td>
<p>yes</p>
    </td>
    <td>
<p>yes</p>
    </td>
  </tr>
  <tr>
    <td>
<p>queryname.body</p>
    </td>
    <td>
<p>no</p>
    </td>
    <td>
<p>yes</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>queryname.textBody</p>
    </td>
    <td>
<p>no</p>
    </td>
    <td>
<p>yes</p>
    </td>
  </tr>
  <tr>
    <td>
<p>queryname.HTMLBody</p>
    </td>
    <td>
<p>no</p>
    </td>
    <td>
<p>yes</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>queryname.header</p>
    </td>
    <td>
<p>yes</p>
    </td>
    <td>
<p>yes</p>
    </td>
  </tr>
  <tr>
    <td>
<p>queryname.attachments</p>
    </td>
    <td>
<p>no</p>
    </td>
    <td>
<p>yes</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>queryname.attachmentfiles</p>
    </td>
    <td>
<p>no</p>
    </td>
    <td>
<p>yes</p>
    </td>
  </tr>
</table>

<p>If the mail message includes a part with a Content-Type of text/plain, the queryname.textBody column contains the part's message content. If the mail message includes a part with a Content-Type of text/HTML, the queryname.HTMLBody column contains the part's message content. If no Content-Type matches these types, the columns are empty. The queryname.Body column always contains the first message body found.</p>
<p>The queryname.attachments column contains a tab-separated list of all the attachment names. The queryname.attachmentfiles column contains a tab-separated list of the locations of the attachment files. Use the <code>cffile</code> tag to delete these temporary files when you have processed them.</p>
<p>To create a ColdFusion date/time object from the date-time string that is extracted from a mail message in the <code>queryname.date</code> column, use the following table:</p>
<table border="0" cellpadding="0" cellspacing="0">
  <tr>
    <th>
Locale 
    </th>
    <th>
How to create a ColdFusion date/time object from queryname.date
    </th>
  </tr>
  <tr>
    <td>
<p>English (US) </p>
    </td>
    <td>
<p>Use the <a href="00000594.htm#134381"><code>ParseDateTime</code></a> function. If you specify the <code>pop-conversion</code> attribute, the function adjusts the date/time object to UTC.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>Other</p>
    </td>
    <td>
<p>Extract the date part of string; pass it to the <a href="00000579.htm#133322"><code>LSParseDateTime</code></a> function.</p>
    </td>
  </tr>
</table>

<p><strong>Note: </strong>To set the default display format of date, time, number, and currency values, use the <a href="00000624.htm#136340"><code>SetLocale</code></a> function. </p><p>For more information on <code>cfpop</code>, see <a href="00001592.htm#1120458">Sending and Receiving E-Mail</a> in <i>ColdFusion MX Developer's Guide</i>.</p>
<h4><a name="wp1102034"></a>Example</h4>
<pre>&lt;!--- This view-only example shows the use of cfpop. ---&gt;
&lt;h3&gt;cfpop Example&lt;/h3&gt;
&lt;p&gt;cfpop lets you retrieve and manipulate mail in a POP3 mailbox. <br />This view-only example shows how to create one feature of <br />a mail client, to display the mail headers in a POP3 mailbox.
&lt;p&gt;To execute this, un-comment this code and run with a mail-enabled CF Server.
&lt;!--- 
&lt;cfif IsDefined(&quot;form.server &quot;)&gt;
   &lt;!--- Make sure server, username are not empty. ---&gt;
   &lt;cfif form.server is not &quot;&quot; and form.username is not &quot;&quot;&gt;
      &lt;cfpop server = &quot;#form.popserver# &quot; username = #form.username# password = #form.pwd#
      action = &quot;getHeaderOnly&quot; name = &quot;GetHeaders &quot;&gt;
      &lt;h3&gt;Message Headers in Your Inbox&lt;/h3&gt;
      &lt;p&gt;Number of Records: 
      &lt;cfoutput&gt;#GetHeaders.recordCount#&lt;/cfoutput&gt;&lt;/p&gt;

      &lt;ul&gt;
         &lt;cfoutput query = &quot;GetHeaders&quot;&gt;
         &lt;li&gt;Row: #currentRow#: From: #From# -- Subject: #Subject#
         &lt;/cfoutput&gt;
      &lt;/ul&gt;
   &lt;/cfif&gt;
&lt;/cfif&gt;

&lt;form action = &quot;cfpop.cfm &quot; method = &quot;post&quot;&gt;
   &lt;p&gt;Enter your mail server:
   &lt;p&gt;&lt;input type = &quot;Text&quot; name = &quot;popserver&quot;&gt;
   &lt;p&gt;Enter your username:
   &lt;p&gt;&lt;input type = &quot;Text&quot; name = &quot;username&quot;&gt;
   &lt;p&gt;Enter your password:
   &lt;p&gt;&lt;input type = &quot;password&quot; name = &quot;pwd&quot;&gt;
   &lt;input type = &quot;Submit&quot; name = &quot;get message headers&quot;&gt;
&lt;/form&gt; 
---&gt;
</pre>

<hr />
<p align="right"><p align="right"><a href="00000310.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00000312.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<p><a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00000311.htm" target="mm_window">View comments in LiveDocs</a></p>
 </body>
</html>



