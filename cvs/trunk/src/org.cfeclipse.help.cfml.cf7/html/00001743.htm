<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="Content-Style-Type" content="text/css">
   <script src="pages.js" type="text/javascript" language="Javascript1.2" charset="UTF-8"></script>
   <title>Connecting to Microsoft SQL Server</title>
</head>
<body>
<p align="right"><p align="right"><a href="00001742.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001744.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<hr />
<h1>Connecting to Microsoft SQL Server</h1>
<p>To see a list of SQL Server versions that ColdFusion&#160;MX supports, go to <a href="http://www.macromedia.com/go/sysreqscf" target="mm_window">www.macromedia.com/go/sysreqscf</a>. Use the settings in the following table to connect ColdFusion&#160;MX to Microsoft SQL Server:</p>
<table border="0" cellpadding="0" cellspacing="0">
  <tr>
    <th>
Setting
    </th>
    <th>
Description
    </th>
  </tr>
  <tr>
    <td>
<p>CF Data Source Name</p>
    </td>
    <td>
<p>The data source name (DSN) used by ColdFusion&#160;MX to connect to the data source.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>Database</p>
    </td>
    <td>
<p>The database to which this data source connects.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>Server</p>
    </td>
    <td>
<p>The name of the server that hosts the database that you want to use. If the database is local, enclose the word <i>local</i> in parentheses. If you are running SQL Server locally (or using MSDE), specify 127.0.0.1 for the</p>
<p>server name instead of the actual instance name.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>Port</p>
    </td>
    <td>
<p>The number of the TCP/IP port that the server monitors for connections.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>Username</p>
    </td>
    <td>
<p>The user name that ColdFusion&#160;MX passes to the JDBC driver to connect to the data source if a ColdFusion application does not supply a user name (for example, in a <code>cfquery</code> tag).</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>Password</p>
    </td>
    <td>
<p>The password that ColdFusion&#160;MX passes to the JDBC driver to connect to the data source if a ColdFusion application does not supply a password (for example, in a <code>cfquery</code> tag).</p>
    </td>
  </tr>
  <tr>
    <td>
<p>Description</p>
    </td>
    <td>
<p>(Optional) A description for this connection.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>Connection String</p>
    </td>
    <td>
<p>A field that passes database-specific parameters, such as login credentials, to the data source.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>Select Method</p>
    </td>
    <td>
<p>Determines whether server cursors are used for SQL queries.</p>
<ul>
<li>
   The Direct method provides more efficient retrieval of data when you retrieve record sets in a forward-only direction and you limit your SQL Server connection to a single open SQL statement at a time. This is typical for ColdFusion applications.
</li>
<li>
   The Cursor method lets you have multiple open SQL statements on a connection. This is not typical for ColdFusion applications, unless you use pooled statements.
</li>
</ul>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>Limit Connections</p>
    </td>
    <td>
<p>Specifies whether ColdFusion&#160;MX limits the number of database connections for the data source. If you enable this option, use the Restrict Connections To field to specify the maximum.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>Restrict Connections To</p>
    </td>
    <td>
<p>Specifies the maximum number of database connections for the data source. To use this restriction, you must enable the Limit Connections option.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>Maintain Connections</p>
    </td>
    <td>
<p>ColdFusion&#160;MX establishes a connection to a data source for every operation that requires one. Enable this option to improve performance by caching the data source connection. </p>
    </td>
  </tr>
  <tr>
    <td>
<p>String Format</p>
    </td>
    <td>
<p>Enable this option if your application uses Unicode data in DBMS-specific Unicode datatypes, such as National Character or nchar.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>Max Pooled Statements</p>
    </td>
    <td>
<p>Enables reuse of prepared statements (that is, stored procedures and queries that use the <code>cfqueryparam</code> tag). Although you tune this setting based on your application, start by setting it to the sum of the following:</p>
<ul>
<li>
   Unique <code>cfquery</code> tags that use the <code>cfqueryparam</code> tag
</li>
<li>
   Unique <code>cfstoredproc</code> tags
</li>
</ul>
    </td>
  </tr>
  <tr>
    <td>
<p>Timeout (min)</p>
    </td>
    <td>
<p>The number of minutes that ColdFusion MX maintains an unused connection before destroying it.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>Interval (min)</p>
    </td>
    <td>
<p>The time (in minutes) that the server waits between cycles to check for expired data source connections to close.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>Disable Connections</p>
    </td>
    <td>
<p>If selected, suspends all client connections.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>Login Timeout (sec)</p>
    </td>
    <td>
<p>The number of seconds before ColdFusion&#160;MX times out the data source connection login attempt.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>CLOB</p>
    </td>
    <td>
<p>Select to return the entire contents of any CLOB/Text columns in the database for this data source. If not selected, ColdFusion&#160;MX retrieves the number of characters specified in the Long Text Buffer setting.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>BLOB </p>
    </td>
    <td>
<p>Select to return the entire contents of any BLOB/Image columns in the database for this data source. If not selected, ColdFusion&#160;MX retrieves the number of characters specified in the BLOB Buffer setting.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>LongText Buffer</p>
    </td>
    <td>
<p>The default buffer size, used if Enable Long Text Retrieval(CLOB) is not selected. The default value is <code>64000</code> bytes.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>BLOB Buffer</p>
    </td>
    <td>
<p>The default buffer size, used if the BLOB option is not selected. The default value is <code>64000</code> bytes.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>Allowed SQL</p>
    </td>
    <td>
<p>The SQL operations that can interact with the current data source.</p>
    </td>
  </tr>
</table>

<h2><a name="wp1277632"></a>Settings for the Northwind sample database</h2>
<p>SQL Server ships with a sample database named Northwind. Establishing a connection to the Northwind database can help you learn ColdFusion&#160;MX while using a familiar database.</p>
<p>To establish a connection to the SQL Server Northwind database, you must set up the database int he SQL Server Enterprise manager and in the ColdFusion MX Administrator.</p>
<h4>To set up the database in the SQL Server Enterprise manager:</h4>
<ol>
<li>
   Expand the server group.
</li>
<li>
   Expand the server.
</li>
<li>
   Under the Security folder, right-click on Logins.
</li>
<li>
   Select New Login.
</li>
<li>
   Select Windows Authentication or SQL Server Authentication settings. 
</li>
<li>
   Select the Northwind database, and specify the language.
</li>
<li>
   Ensure that the database server is using mixed authentication. While in Enterprise Manager, right click on the server, select Properties &gt; Security and then select the Security tab. Ensure that the SQL Server and Windows radio button is clicked.
</li>
<li>
   Click OK.
</li>
</ol>
<h4>To set up the database in the ColdFusion&#160;MX Administrator:</h4>
<ol>
<li>
   Open the ColdFusion&#160;MX Administrator.
</li>
<li>
   Click Data &amp; Services &gt; Data Sources.
</li>
<li>
   Type <strong>northwind</strong> in the Data Source Name field, and select Microsoft SQL Server in the Driver drop-down list box.
</li>
<li>
   Click Add.
</li>
<li>
   Type <strong>Northwind</strong> in the Database Name field, <strong>127.0.0.1</strong> (or the database server IP address) in the Server field, and <strong>1433</strong> in the Port field.
<p><strong>Note: </strong>Do not specify a user name or password when defining the data source.</p></li>
<li>
   Save the data source.
</li>
</ol>
<h2><a name="wp1283677"></a>Troubleshooting SQL Server connections</h2>
<p>If you are having trouble establishing a connection to SQL Server, review the following considerations:</p>
<ul>
<li>
   If you installed SQL Server using a server name other than the default, you must use your chosen domain\servername wherever there's a reference to (local).
</li>
</ul>
<p>The following situations can cause a Connection Refused error:</p>
<ul>
<li>
   If you specified authentication information in SQL Server, ensure that you have not defined a username and password in the ColdFusion data source.
</li>
<li>
   You are running a connection-limited version of SQL Server and the request exceeds the limit for TCP/IP connections.
<p>You can prevent this exception by setting the Limit Connections and Restrict Connections To options in ColdFusion&#160;MX Administrator on the Advanced Settings page for the data sources, and specifying a number less than the SQL Server maximum.</p>
</li>
<li>
   SQL Server does not enable the TCP/IP protocol. This problem can happen when SQL Server is on the same computer as ColdFusion&#160;MX. To fix this problem, perform the following steps:
<ol><li>In SQL Server Enterprise Manager, right-click on the name of your SQL Server and click Properties.</li><li>Click Network Configuration and the General Tab.</li><li>Move TCP/IP from the Disabled Protocols section to the Enabled Protocols section.</li><li>Click OK.</li><li>Restart the SQL Server services.</li><li>Verify your data source.</li></ol></li>
<li>
   If you have are having trouble connecting, consider using mixed-mode authentication for SQL Server (Windows and SQL) and removing the user name and password from the ColdFusion data source.
</li>
</ul>


<hr />
<p align="right"><p align="right"><a href="00001742.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001744.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<p><a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00001743.htm" target="mm_window">View comments in LiveDocs</a></p>
 </body>
</html>



