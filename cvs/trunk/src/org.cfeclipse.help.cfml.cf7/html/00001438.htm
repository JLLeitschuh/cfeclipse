<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="Content-Style-Type" content="text/css">
   <script src="pages.js" type="text/javascript" language="Javascript1.2" charset="UTF-8"></script>
   <title>Dynamically linking from a pie chart</title>
</head>
<body>
<p align="right"><p align="right"><a href="00001437.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001439.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<hr />
<h1>Dynamically linking from a pie chart</h1>
<p>In the following example, when you click a pie wedge, ColdFusion displays a table that contains the detailed salary information for the department represented by the wedge. The example is divided into two parts: creating the detail page and making the pie chart dynamic.</p>
<h4><a name="wp1130308"></a>Part 1: creating the detail page</h4>
<p>This page displays salary information for the department you selected when you click on a wedge of the pie chart. The department name is passed to this page using the <code>$ITEMLABEL$</code> variable. </p>
<h4>To create the detail page:</h4>
<ol>
<li>
   Create a new application page with the following content:
<pre>
&lt;cfquery name=&quot;GetSalaryDetails&quot; datasource=&quot;cfdocexamples&quot;&gt;
	SELECT Departmt.Dept_Name, 
		Employee.FirstName, 
		Employee.LastName, 
		Employee.StartDate,
		Employee.Salary,
		Employee.Contract
	FROM Departmt, Employee
	WHERE Departmt.Dept_Name = &#39;#URL.Item#&#39;
	AND Departmt.Dept_ID = Employee.Dept_ID
	ORDER BY Employee.LastName, Employee.Firstname
&lt;/cfquery&gt;

&lt;html&gt;
&lt;head&gt;
	&lt;title&gt;Employee Salary Details&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;

&lt;h1&gt;&lt;cfoutput&gt;#GetSalaryDetails.Dept_Name[1]# Department<br />
Salary Details&lt;/cfoutput&gt;&lt;/h1&gt;
&lt;table border cellspacing=0 cellpadding=5&gt;
&lt;tr&gt;
	&lt;th&gt;Employee Name&lt;/th&gt;
	&lt;th&gt;StartDate&lt;/th&gt;
	&lt;th&gt;Salary&lt;/th&gt;
	&lt;th&gt;Contract?&lt;/th&gt;
&lt;/tr&gt;
&lt;cfoutput query=&quot;GetSalaryDetails&quot; &gt;
&lt;tr&gt;
	&lt;td&gt;#FirstName# #LastName#&lt;/td&gt;
	&lt;td&gt;#dateFormat(StartDate, &quot;mm/dd/yyyy&quot;)#&lt;/td&gt;
	&lt;td&gt;#numberFormat(Salary, &quot;$999,999&quot;)#&lt;/td&gt;
	&lt;td&gt;#Contract#&lt;/td&gt;
&lt;/tr&gt;
&lt;/cfoutput&gt;
&lt;/table&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>
</li>
<li>
   Save the page as Salary_details.cfm in the myapps directory under the web root directory. 
</li>
</ol>
<h4><a name="wp1130352"></a>Reviewing the code</h4>
<p>The following table describes the code and its function:</p>
<table border="0" cellpadding="0" cellspacing="0">
  <tr>
    <th>
Code
    </th>
    <th>
Description
    </th>
  </tr>
  <tr>
    <td>
<pre>&lt;cfquery name=&quot;GetSalaryDetails&quot;<br />      datasource=&quot;cfdocexamples&quot;&gt;
   SELECT<br />      Departmt.Dept_Name, 
      Employee.FirstName, 
      Employee.LastName, 
      Employee.StartDate,
      Employee.Salary,
      Employee.Contract
   FROM Departmt, Employee
   WHERE<br />      Departmt.Dept_Name =<br />         &#39;#URL.Item#&#39;
   AND Departmt.Dept_ID =<br />      Employee.Dept_ID
   ORDER BY Employee.LastName,<br />      Employee.Firstname
&lt;/cfquery&gt;
</pre>    </td>
    <td>
<p>Get the salary data for the department whose name was passed in the URL parameter string. Sort the data by the employee's last and first names. </p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<pre>&lt;table border cellspacing=0 cellpadding=5&gt;
&lt;tr&gt;
   &lt;th&gt;Employee Name&lt;/td&gt;
   &lt;th&gt;StartDate&lt;/td&gt;
   &lt;th&gt;Salary&lt;/td&gt;
   &lt;th&gt;Contract?&lt;/td&gt;
&lt;/tr&gt;
&lt;cfoutput query=&quot;GetSalaryDetails&quot; &gt;
&lt;tr&gt;
   &lt;td&gt;#FirstName# #LastName#&lt;/td&gt;
   &lt;td&gt;#dateFormat(StartDate, <br />      &quot;mm/dd/yyyy&quot;)#&lt;/td&gt;
   &lt;td&gt;#numberFormat(Salary, &quot;$999,999&quot;)#&lt;/td&gt;<br />   &lt;td&gt;#Contract#&lt;/td&gt;
&lt;/tr&gt;
&lt;/cfoutput&gt;
&lt;/table&gt;
</pre>    </td>
    <td>
<p>Display the data retrieved by the query as a table. Format the start date into standard month/date/year format, and format the salary with a leading dollar sign, comma separator, and no decimal places.</p>
    </td>
  </tr>
</table>

<h4><a name="wp1130392"></a>Part 2: making the chart dynamic</h4>
<ol>
<li>
   Open chartdata.cfm in your editor.
</li>
<li>
   Edit the <a href="00000226.htm#2619630"><code>cfchart</code></a> tag for the pie chart so it appears as follows:
<pre>
&lt;cfchart 
		font=&quot;Times&quot;
		fontBold=&quot;yes&quot;
		backgroundColor=&quot;##CCFFFF&quot;
		show3D=&quot;yes&quot;
		url=&quot;Salary_Details.cfm?Item=$ITEMLABEL$&quot;
		&gt;
		
	&lt;cfchartseries 
		type=&quot;pie&quot; 
		query=&quot;DeptSalaries&quot; 
		valueColumn=&quot;AvgByDept&quot; 
		itemColumn=&quot;Dept_Name&quot;
		colorlist=&quot;##990066,##660099,##006699,##069666&quot;
	/&gt;
&lt;/cfchart&gt;
</pre>
</li>
<li>
   Save the file as chartdetail.cfm.
</li>
<li>
   View the chartdata.cfm page in your browser.
</li>
<li>
   Click the slices of the pie chart to request the Salary_details.cfm page and pass in the department name of the wedge you clicked. The salary information for that department appears. 
</li>
</ol>
<h4><a name="wp1130413"></a>Reviewing the code</h4>
<p>The following table describes the highlighted code and its function:</p>
<table border="0" cellpadding="0" cellspacing="0">
  <tr>
    <th>
Code
    </th>
    <th>
Description
    </th>
  </tr>
  <tr>
    <td>
<pre>url=<br />   &quot;Salary_Details.cfm?Item=$ITEMLABEL$&quot;
</pre>    </td>
    <td>
<p>When the user clicks a wedge of the pie chart, call the Salary_details.cfm page in the current directory, and pass it the parameter named Item that contains the department name of the selected wedge.</p>
    </td>
  </tr>
</table>



<hr />
<p align="right"><p align="right"><a href="00001437.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001439.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<p><a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00001438.htm" target="mm_window">View comments in LiveDocs</a></p>
 </body>
</html>



