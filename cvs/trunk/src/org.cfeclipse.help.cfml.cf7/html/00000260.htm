<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="Content-Style-Type" content="text/css">
   <script src="pages.js" type="text/javascript" language="Javascript1.2" charset="UTF-8"></script>
   <title>cfftp: Opening and closing FTP server connections</title>
</head>
<body>
<p align="right"><p align="right"><a href="00000259.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00000261.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<hr />
<h1>cfftp: Opening and closing FTP server connections</h1>
<h4><a name="wp1800596"></a>Description</h4>
<p>To establish a connection with an FTP server, you use the <code>open</code> action with a <code>connection</code> attribute. </p>
<h4><a name="wp1800598"></a>Syntax</h4>
<pre>&lt;cfftp <br />   action = &quot;action&quot;<br />   username = &quot;name&quot;<br />   password = &quot;password&quot;<br />   server = &quot;server&quot;<br />   timeout = &quot;timeout in seconds&quot;<br />   port = &quot;port&quot;<br />   connection = &quot;name&quot;<br />   proxyServer = &quot;proxy server&quot;<br />   retryCount = &quot;number&quot;<br />   stopOnError = &quot;yes&quot; or &quot;no&quot;<br />   passive = &quot;yes&quot; or &quot;no&quot;&gt;
</pre><h4><a name="wp1878216"></a>See also</h4>
<p><a href="00000272.htm#1632966"><code>cfhttp</code></a><code>, </code><a href="00000283.htm#1100581"><code>cfldap</code></a><code>, </code><a href="00000297.htm#2355015"><code>cfmail</code></a><code>, </code><a href="00000311.htm#1101854"><code>cfpop</code></a></p>
<h4><a name="wp2220179"></a>Attributes</h4>
<table border="0" cellpadding="0" cellspacing="0">
  <tr>
    <th>
Attribute
    </th>
    <th>
Req/Opt
    </th>
    <th>
Default
    </th>
    <th>
Description
    </th>
  </tr>
  <tr>
    <td>
<p>action</p>
    </td>
    <td>
<p>Required</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>FTP operation to perform. </p>
<ul>
<li>
   open: creates an FTP connection
</li>
<li>
   close: terminates an FTP connection
</li>
</ul>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>username</p>
    </td>
    <td>
<p>Required if <code>action = &quot;open&quot;</code></p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>User name to pass in the FTP operation. </p>
    </td>
  </tr>
  <tr>
    <td>
<p>password</p>
    </td>
    <td>
<p>Required if <code>action = &quot;open&quot;</code></p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>Password to log in the user.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>server</p>
    </td>
    <td>
<p>Required if <code>action = &quot;open&quot;</code></p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>FTP server to which to connect; for example, <code>ftp.myserver.com</code></p>
    </td>
  </tr>
  <tr>
    <td>
<p>timeout</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>30</p>
    </td>
    <td>
<p>Value in seconds for the timeout of all operations, including individual data request operations. </p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>port</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>21</p>
    </td>
    <td>
<p>Remote port to which to connect. </p>
    </td>
  </tr>
  <tr>
    <td>
<p>connection</p>
    </td>
    <td>
<p>Optional, but always used with <code>open</code> or <code>close</code></p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>Name of the FTP connection. If you specify the <code>username</code>, <code>password</code>, and <code>server</code> attributes, and if no connection exists for them, ColdFusion creates one. Calls to <code>cfftp</code> with the same connection name reuse the connection.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>proxyServer</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>String. Name of proxy server (or servers) to use, if proxy access is specified. </p>
    </td>
  </tr>
  <tr>
    <td>
<p>retryCount</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>1&#160;</p>
    </td>
    <td>
<p>Number of retries until failure is reported. </p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>stopOnError</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>no</p>
    </td>
    <td>
<ul>
<li>
   yes: halts processing, displays an appropriate error.
</li>
<li>
   no: populates these variables:
<ul><li>cfftp.succeeded - yes or no.</li>
<li>cfftp.errorCode - Error number. See the IETF Network <br />		Working Group RFC 959: File Transfer Protocol (FTP)<br /><a href="http://www.ietf.org/rfc/rfc0959.txt" target="mm_window">		www.ietf.org/rfc/rfc0959.txt</a>. </li>
<li>cfftp.errorText - Message text. </li>
</ul></li>
</ul>
<p>For conditional operations, use <code>cfftp.errorCode</code>. Do not use <code>cfftp.errorText</code> for this purpose.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>passive</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>no</p>
    </td>
    <td>
<ul>
<li>
   yes: enables passive mode.
</li>
<li>
   no
</li>
</ul>
    </td>
  </tr>
</table>

<h4><a name="wp2058586"></a>Usage</h4>
<p>When you establish a connection with <code>cfftp action=&quot;open&quot;</code> and specify a name in the <code>connection</code> attribute, ColdFusion caches the connection so that you can reuse it to perform additional FTP operations. When you use a cached connection for subsequent FTP operations, you do not have to specify the <code>username</code>, <code>password</code>, or <code>server</code> connection attributes. The FTP operations that use the same <code>connection</code> name automatically use the information stored in the cached connection. Using a cached connection helps save connection time and improves file transfer performance. </p>
<p>You do not need to open a connection for single, simple, FTP operations, such as <code>GetFile</code> or <code>PutFile</code>.</p>
<p>To keep a connection open throughout a session or longer, put the connection name in the Session or Application scope; for example, specify <code>connection=&quot;Session.FTPConnection&quot;</code>. However, if you do this, you must specify the full variable name in all FTP operations, and you must use the <code>close</code> action when you are finished. Keeping a connection open prevents others from using the FTP server; so close a connection as soon as possible. If you do not assign the connection name to Session or Application variable, the connection remains open for the current page only, and you do not have to close it manually. </p>
<p>Changes to a cached connection, such as changing <code>retryCount</code> or <code>timeout</code> values, might require reestablishing the connection. </p>
<h4><a name="wp1800750"></a>Example</h4>
<pre>&lt;p&gt;cfftp lets users implement File Transfer Protocol operations. <br />By default, cfftp caches an open connection to an FTP server.
&lt;p&gt;cfftp operations are usually of two types:
&lt;ul&gt;
   &lt;li&gt;Establishing a connection
   &lt;li&gt;Performing file and directory operations
&lt;/ul&gt;
&lt;p&gt;This example opens and verifies a connection, lists the files in a <br />directory, and closes the connection.
&lt;p&gt;Open a connection
&lt;cfftp action = &quot;open&quot;
   username = &quot;anonymous&quot;
   connection = &quot;My_query&quot;
   password = &quot;youremail@email.com&quot;
   server = &quot;ftp.tucows.com&quot;
   stopOnError = &quot;Yes&quot;&gt;
&lt;p&gt;Did it succeed? &lt;cfoutput&gt;#cfftp.succeeded#&lt;/cfoutput&gt;
&lt;p&gt;List the files in a directory:
&lt;cfftp action = &quot;LISTDIR&quot;
    stopOnError = &quot;Yes&quot;
    name = &quot;ListFiles&quot;
    directory = &quot;/&quot;
    connection = &quot;my_query&quot;&gt;
&lt;cfoutput query = &quot;ListFiles&quot;&gt;
   #name#&lt;br&gt;
&lt;/cfoutput&gt;

&lt;p&gt;Close the connection:
&lt;cfftp action = &quot;close&quot;
connection = &quot;My_query&quot;
stopOnError = &quot;Yes&quot;&gt;
&lt;p&gt;Did it succeed? &lt;cfoutput&gt;#cfftp.succeeded#&lt;/cfoutput&gt;
</pre>

<hr />
<p align="right"><p align="right"><a href="00000259.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00000261.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<p><a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00000260.htm" target="mm_window">View comments in LiveDocs</a></p>
 </body>
</html>



