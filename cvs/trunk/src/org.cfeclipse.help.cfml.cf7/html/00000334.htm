<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="Content-Style-Type" content="text/css">
   <script src="pages.js" type="text/javascript" language="Javascript1.2" charset="UTF-8"></script>
   <title>cfset</title>
</head>
<body>
<p align="right"><p align="right"><a href="00000333.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00000335.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<hr />
<h1>cfset</h1>
<h4><a name="wp1355881"></a>Description</h4>
<p>Sets a value in ColdFusion. Used to create a variable, if it does not exist, and assign it a value. Also used to call functions.</p>
<h4><a name="wp1960525"></a>Category</h4>
<p><a href="00000209.htm#2460154">Variable manipulation tags</a></p>
<h4><a name="wp1103447"></a>Syntax</h4>
<pre>&lt;cfset <br />   var variable_name = expression
   &gt;
</pre><h4><a name="wp1960532"></a>See also</h4>
<p><a href="00000233.htm#3839604">cfcookie</a>, <a href="00000310.htm#1101730">cfparam</a>, <a href="00000318.htm#1102654">cfregistry</a>, <a href="00000327.htm#1844410">cfsavecontent</a>, <a href="00000328.htm#1843993">cfschedule</a>; <a href="00000866.htm#2689636">Elements of CFML</a> in <i>ColdFusion MX Developer's Guide</i></p>
<h4><a name="wp2392901"></a>Attributes</h4>
<table border="0" cellpadding="0" cellspacing="0">
  <tr>
    <th>
Attribute
    </th>
    <th>
Req/Opt
    </th>
    <th>
Default
    </th>
    <th>
Description
    </th>
  </tr>
  <tr>
    <td>
<p>var</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>A keyword. Does not take a value. Identifies the variable as being local to a function. The variable only exists for the time of the current invocation of the function.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>variable_name</p>
    </td>
    <td>
<p>Required</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>A variable.</p>
    </td>
  </tr>
</table>

<h4><a name="wp1781236"></a>Usage</h4>
<p>The following sections provide detailed descriptions of some of the uses for the <code>cfset</code> tag.</p>
<h4><a name="wp2699592"></a>Calling functions</h4>
<p>When you use the <code>cfset</code> tag to call a function, you do not need to assign the function return value to a variable if the function does not return a value or you do not need to use the value returned by the function. For example, the following line is a valid ColdFusion <code>cfset</code> tag for deleting the MyVariable variable from the Application scope: </p>
<pre>&lt;cfset StructDelete(Application, &quot;MyVariable&quot;)&gt; 
</pre><h4><a name="wp2699571"></a>Arrays</h4>
<p>The following example assigns a new array to the variable <code>months</code>:</p>
<pre>&lt;cfset months = ArrayNew(1)&gt;
</pre><p>This example creates a variable <code>Array_Length</code> that resolves to the length of the array <code>Scores</code>:</p>
<pre>&lt;cfset Array_Length = ArrayLen(Scores)&gt;
</pre><p>This example assigns, to index position two in the array <code>months</code>, the value <code>February</code>:</p>
<pre>&lt;cfset months[2] = &quot;February&quot;&gt;
</pre><h4><a name="wp1103456"></a>Dynamic variable names</h4>
<p>In this example, the variable name is itself a variable:</p>
<pre>&lt;cfset myvariable = &quot;current_value&quot;&gt;
&lt;cfset &quot;#myvariable#&quot; = 5&gt;
</pre><h4><a name="wp1103460"></a>Function local variables</h4>
<p>The <code>var</code> keyword specifies that the variable being defined is only available inside the body of a function that you define using the <code>cffunction</code> tag. The variable value that is set in one invocation of the function is not available in any other invocation of the function. The <code>var</code> keyword is the equivalent of the <code>var</code> statement in CFScript. The following rules apply to the <code>var</code> keyword:</p>
<ul>
<li>
   Any <code>cfset</code> tag that uses the <code>var</code> keyword must be inside the body of a <code>cffunction</code> tag. If you use the <code>var</code> keyword in a <code>cfset</code> tag outside a <code>cffunction</code> tag body, ColdFusion displays an error message. 
</li>
<li>
   You must place all <code>cfset</code> tags that use the <code>var</code> keyword at the beginning of the <code>cffunction</code> tag body, before any other ColdFusion tags. 
</li>
</ul>
<p>The following example shows how to use the new keyword:</p>
<pre>&lt;cffunction name=&quot;myFunct&quot;&gt;
   &lt;cfset var myVar = &quot;This is a test&quot;&gt;
   &lt;cfreturn myVar &amp; &quot; Message.&quot;&gt;
&lt;/cffunction&gt;
&lt;cfoutput&gt;#myFunct()#&lt;/cfoutput&gt;
</pre><p>In this example, the variable myVar exists only when the function myFunct executes, and it is not available elsewhere on the ColdFusion page. </p>
<h4><a name="wp2700195"></a>COM objects</h4>
<p>In this example, a COM object is created. A <code>cfset</code> defines a value for each method or property in the COM object interface. The last <code>cfset</code> creates a variable to store the return value from the COM object's <code>SendMail</code> method.</p>
<pre>&lt;cfobject action = &quot;Create&quot; 
   name = &quot;Mailer&quot; 
   class = &quot;SMTPsvg.Mailer&quot;&gt; 

&lt;cfset MAILER.FromName = form.fromname&gt; 
&lt;cfset MAILER.RemoteHost = RemoteHost&gt; 
&lt;cfset MAILER.FromAddress = form.fromemail&gt; 
&lt;cfset MAILER.AddRecipient(&quot;form.fromname&quot;, &quot;form.fromemail&quot;)&gt; 
&lt;cfset MAILER.Subject = &quot;Testing cfobject&quot;&gt; 
&lt;cfset MAILER.BodyText = &quot;form.msgbody&quot;&gt; 
&lt;cfset Mailer.SMTPLog = &quot;logfile&quot;&gt; 
&lt;cfset success = MAILER.SendMail()&gt; 
&lt;cfoutput&gt; #success# &lt;/cfoutput&gt;
</pre><h4><a name="wp2756150"></a>Example</h4>
<pre>&lt;!--- This example shows how to use cfset. ---&gt;
&lt;cfquery name = &quot;GetMessages&quot; dataSource = &quot;cfdocexamples&quot;&gt;
   SELECT *
   FROM   Messages
&lt;/cfquery&gt;

&lt;h3&gt;cfset Example&lt;/h3&gt;
&lt;p&gt;cfset sets and reassigns values to local or global variables within a page.

&lt;cfset NumRecords = GetMessages.recordCount&gt;
&lt;p&gt;For example, the variable NumRecords has been declared on this <br />page to hold the number of records returned from query<br />(&lt;cfoutput&gt;#NumRecords#&lt;/cfoutput&gt;).

&lt;p&gt;In addition, cfset can be used to pass variables from other pages, <br />such as this example, which takes the url parameter Test from this link: <br />(&lt;a href = &quot;cfset.cfm?test = &lt;cfoutput&gt;
                  #URLEncodedFormat(&quot;hey, you, get off of my cloud&quot;)#               &lt;/cfoutput&gt;
               &quot;&gt;click here&lt;/A&gt;) to display a message: 
&lt;p&gt;
&lt;cfif IsDefined (&quot;url.test&quot;) is &quot;True&quot;&gt;
   &lt;cfoutput&gt;&lt;b&gt;&lt;I&gt;#url.test#&lt;/i&gt;&lt;/b&gt;&lt;/cfoutput&gt;
&lt;cfelse&gt;
   &lt;h3&gt;The variable url.test has not been passed from another page.&lt;/h3&gt;
&lt;/cfif&gt;

&lt;p&gt;cfset can also be used to collect environmental variables, such as the <br />time, the IP address of the user, or another function or expression.

&lt;cfset the_date = #DateFormat(Now())# &amp; &quot; &quot; &amp; #TimeFormat(Now())#&gt;
&lt;cfset user_ip = CGI.REMOTE_ADDR&gt;
&lt;cfset complex_expr = (23 MOD 12) * 3&gt;
&lt;cfset str_example = Reverse(Left(GetMessages.body, 35))&gt;

&lt;cfoutput&gt; 
   &lt;ul&gt; 
      &lt;li&gt;The date: #the_date# 
      &lt;li&gt;User IP Address: #user_ip# 
      &lt;li&gt;Complex Expression ((23 MOD 12) * 3): #complex_expr# 
      &lt;li&gt;String Manipulation (the first 35 characters of 
            the body of the first message in our query) 
            &lt;br&gt;&lt;b&gt;Reversed&lt;/b&gt;: #str_example# 
            &lt;br&gt;&lt;b&gt;Normal&lt;/b&gt;: #Reverse(str_example)# 
   &lt;/ul&gt; 
&lt;/cfoutput&gt; 
</pre>

<hr />
<p align="right"><p align="right"><a href="00000333.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00000335.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<p><a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00000334.htm" target="mm_window">View comments in LiveDocs</a></p>
 </body>
</html>



