<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="Content-Style-Type" content="text/css">
   <script src="pages.js" type="text/javascript" language="Javascript1.2" charset="UTF-8"></script>
   <title>About record sets</title>
</head>
<body>
<p align="right"><p align="right"><a href="00001263.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001265.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<hr />
<h1>About record sets</h1>
<p>Query of Queries is based on manipulating the record set, which you can create using the <a href="00000316.htm#1102316"><code>cfquery</code></a> tag and other ways.</p>
<p>When you execute a database query, ColdFusion retrieves the data in a <i>record set</i>. In addition to presenting record set data to the user, you can manipulate this record set to improve your application's performance.</p>
<p>Because a record set contains rows (records) and columns (fields), you can think of it as a virtual database table, or as a spreadsheet. For example, the <a href="00000311.htm#1101854"><code>cfpop</code></a> tag retrieves a record set in which each row is a message and each column is a message component, such as To, From, and Subject.</p>
<h2><a name="wp1135362"></a>Creating a record set</h2>
<p>You can perform a Query of Queries on any ColdFusion tag or function that generates a record set, including the following:</p>
<ul>
<li>
   <a href="00000230.htm#1097667"><code>cfcollection</code></a> 
</li>
<li>
   <a href="00000235.htm#1097918"><code>cfdirectory</code></a> 
</li>
<li>
   <a href="00000259.htm#1800554"><code>cfftp</code></a> 
</li>
<li>
   <a href="00000272.htm#1632966"><code>cfhttp</code></a> 
</li>
<li>
   <a href="00000278.htm#1100286"><code>cfindex</code></a> 
</li>
<li>
   <a href="00000283.htm#1100581"><code>cfldap</code></a> 
</li>
<li>
   <a href="00000297.htm#2355015"><code>cfmail</code></a> 
</li>
<li>
   <a href="00000311.htm#1101854"><code>cfpop</code></a> 
</li>
<li>
   <a href="00000314.htm#1102246"><code>cfprocresult</code></a> 
</li>
<li>
   <a href="00000316.htm#1102316"><code>cfquery</code></a><code> </code>(against a database or against another Query of Queries)
</li>
<li>
   <a href="00000330.htm#1103106"><code>cfsearch</code></a> 
</li>
<li>
   <a href="00000338.htm#2607555"><code>cfstoredproc</code></a> 
</li>
<li>
   <a href="00000351.htm#2682044"><code>cfwddx</code></a> 
</li>
<li>
   The <a href="00000600.htm#134773"><code>QueryNew</code></a> function 
</li>
</ul>
<h2><a name="wp1135428"></a>Creating a record set with a function</h2>
<p>In addition to creating a record set by using a <a href="00000316.htm#1102316"><code>cfquery</code></a> or other CFML tags, you can create it with the <a href="00000600.htm#134773"><code>QueryNew</code></a><code>()</code> function.</p>
<h4>To create a record set with the QueryNew() function:</h4>
<ol>
<li>
   Create a ColdFusion page with the following content:
<pre>
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;The queryNew function&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h2&gt;QueryNew Example&lt;/h2&gt;

&lt;!--- create a query, specify data types for each column ---&gt;
&lt;cfset qInstruments = queryNew(&quot;name, instrument, years_playing&quot;, 
&quot;CF_SQL_VARCHAR, CF_SQL_VARCHAR, CF_SQL_INTEGER&quot;)&gt;

&lt;!--- add rows ---&gt;
&lt;cfset newrow = queryaddrow(qInstruments, 3)&gt;

&lt;!--- set values in cells ---&gt;
&lt;cfset temp = querysetcell(qInstruments, &quot;name&quot;, &quot;Thor&quot;, 1)&gt;
&lt;cfset temp = querysetcell(qInstruments, &quot;instrument&quot;, &quot;hammer&quot;, 1)&gt;
&lt;cfset temp = querysetcell(qInstruments, &quot;years_playing&quot;, &quot;1000&quot;, 1)&gt;

&lt;cfset temp = querysetcell(qInstruments, &quot;name&quot;, &quot;Bjorn&quot;, 2)&gt;
&lt;cfset temp = querysetcell(qInstruments, &quot;instrument&quot;, &quot;sitar&quot;, 2)&gt;
&lt;cfset temp = querysetcell(qInstruments, &quot;years_playing&quot;, &quot;24&quot;, 2)&gt;

&lt;cfset temp = querysetcell(qInstruments, &quot;name&quot;, &quot;Raoul&quot;, 3)&gt;
&lt;cfset temp = querysetcell(qInstruments, &quot;instrument&quot;, &quot;flute&quot;, 3)&gt;
&lt;cfset temp = querysetcell(qInstruments, &quot;years_playing&quot;, &quot;12&quot;, 3)&gt;

&lt;!--- output the query ---&gt;
&lt;cfoutput query=&quot;qInstruments&quot;&gt;
	&lt;pre&gt;#name#	#instrument# #years_playing#&lt;/pre&gt;
&lt;/cfoutput&gt;	

&lt;h3&gt;Individual record retrieval:&lt;/h3&gt;
&lt;cfoutput&gt;
&lt;p&gt;#qInstruments.name[2]# has played #qInstruments.instrument[2]# for<br />
#qInstruments.years_playing[2]# years.&lt;/p&gt;
&lt;/cfoutput&gt;

&lt;/body&gt;
&lt;/html&gt;
</pre>
</li>
<li>
   Save the page as queryNew.cfm in the myapps directory under the <i>web_root </i>directory.
</li>
<li>
   Display queryNew.cfm in your browser
</li>
</ol>


<hr />
<p align="right"><p align="right"><a href="00001263.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001265.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<p><a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00001264.htm" target="mm_window">View comments in LiveDocs</a></p>
 </body>
</html>



