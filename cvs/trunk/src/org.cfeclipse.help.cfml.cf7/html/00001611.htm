<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="Content-Style-Type" content="text/css">
   <script src="pages.js" type="text/javascript" language="Javascript1.2" charset="UTF-8"></script>
   <title>Using the cfhttp Post method</title>
</head>
<body>
<p align="right"><p align="right"><a href="00001610.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001612.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<hr />
<h1>Using the cfhttp Post method</h1>
<p>Use the Post method to send cookie, form field, CGI, URL, and file variables to a specified ColdFusion page or CGI program for processing. For Post operations, you must use the <a href="00000273.htm#1100049"><code>cfhttpparam</code></a> tag for each variable you want to post. The Post method passes data to a specified ColdFusion page or an executable that interprets the variables being sent and returns data.</p>
<p>For example, when you build an HTML form using the Post method, you specify the name of the page to which form data is passed. You use the Post method in <code>cfhttp</code> in a similar way. However, with <a href="00000272.htm#1632966"><code>cfhttp</code></a>, the page that receives the Post does not, itself, display anything.</p>
<h4>To pass variables to a ColdFusion page:</h4>
<ol>
<li>
   Create a ColdFusion page with the following content:
<pre>
&lt;html&gt;
&lt;head&gt;
	&lt;title&gt;HTTP Post Test&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;HTTP Post Test&lt;/h1&gt;
&lt;cfhttp method=&quot;Post&quot;
	url=&quot;http://127.0.0.1:8500/myapps/post_test_server.cfm&quot;&gt;
	&lt;cfhttpparam type=&quot;Cookie&quot;
		value=&quot;cookiemonster&quot;
		name=&quot;mycookie6&quot;&gt;
	&lt;cfhttpparam type=&quot;CGI&quot;
		value=&quot;cgivar &quot;
		name=&quot;mycgi&quot;&gt;
	&lt;cfhttpparam type=&quot;URL&quot;
		value=&quot;theurl&quot;
		name=&quot;myurl&quot;&gt;
	&lt;cfhttpparam type=&quot;Formfield&quot;
		value=&quot;twriter@macromedia.com&quot;
		name=&quot;emailaddress&quot;&gt;
	&lt;cfhttpparam type=&quot;File&quot;
		name=&quot;myfile&quot;
		file=&quot;c:\pix\trees.gif&quot;&gt;
&lt;/cfhttp&gt;
&lt;cfoutput&gt;
File Content:&lt;br&gt;
	#cfhttp.filecontent#&lt;br&gt;
Mime Type:  #cfhttp.MimeType#&lt;br&gt;
&lt;/cfoutput&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>
</li>
<li>
   Replace the path to the GIF file to a path on your server (just before the closing <code>cfhttp</code> tag).
</li>
<li>
   Save the file as post_test.cfm in the myapps directory under your <i>web_root</i>.
</li>
</ol>
<p><strong>Note: </strong>You must write a page to view the variables. This is the next procedure.</p><h4><a name="wp1124812"></a>Reviewing the code</h4>
<p>The following table describes the code and its function:</p>
<table border="0" cellpadding="0" cellspacing="0">
  <tr>
    <th>
Code
    </th>
    <th>
Description
    </th>
  </tr>
  <tr>
    <td>
<pre>&lt;cfhttp method=&quot;Post&quot;
   url=&quot;http://127.0.0.1:8500/myapps/post_test_   server.cfm&quot;&gt;
</pre>    </td>
    <td>
<p>Post an HTTP request to the specified page.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<pre>&lt;cfhttpparam type=&quot;Cookie&quot;
   value=&quot;cookiemonster&quot;
   name=&quot;mycookie6&quot;&gt;
</pre>    </td>
    <td>
<p>Send a cookie in the request.</p>
    </td>
  </tr>
  <tr>
    <td>
<pre>&lt;cfhttpparam type=&quot;CGI&quot;
   value=&quot;cgivar &quot;
   name=&quot;mycgi&quot;&gt;
</pre>    </td>
    <td>
<p>Send a CGI variable in the request.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<pre>   &lt;cfhttpparam type=&quot;URL&quot;
      value=&quot;theurl&quot;
      name=&quot;myurl&quot;&gt;
</pre>    </td>
    <td>
<p>Send a URL in the request.</p>
    </td>
  </tr>
  <tr>
    <td>
<pre>&lt;cfhttpparam type=&quot;Formfield&quot;
   value=&quot;twriter@macromedia.com&quot;
   name=&quot;emailaddress&quot;&gt;
</pre>    </td>
    <td>
<p>Send a Form field in the request.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<pre>&lt;cfhttpparam type=&quot;File&quot;
   name=&quot;myfile&quot;
   file=&quot;c&quot;\pix\trees.gif&quot;&gt;
</pre>    </td>
    <td>
<p>Send a file in the request. </p>
<p>The <code>&lt;/</code><a href="00000272.htm#1632966"><code>cfhttp</code></a><code>&gt;</code> tag ends the http request.</p>
    </td>
  </tr>
  <tr>
    <td>
<pre>&lt;cfoutput&gt;
File Content:&lt;br&gt;
   #cfhttp.filecontent#&lt;br&gt;
</pre>    </td>
    <td>
<p>Display the contents of the file that the page that is posted to creates by processing the request. In this example, this is the output from the <a href="00000309.htm#1101659"><code>cfoutput</code></a> tag in server.cfm.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<pre>Mime Type:  #cfhttp.MimeType#&lt;br&gt;
&lt;/cfoutput&gt;
</pre>    </td>
    <td>
<p>Display the MIME type of the created file.</p>
    </td>
  </tr>
</table>

<h4>To view the variables:</h4>
<ol>
<li>
   Create a ColdFusion page with the following content:
<pre>
&lt;html&gt;
&lt;head&gt;&lt;title&gt;HTTP Post Test&lt;/title&gt; &lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;HTTP Post Test&lt;/h1&gt;
&lt;cffile destination=&quot;C:\temp\&quot;
	nameconflict=&quot;Overwrite&quot;
	filefield=&quot;Form.myfile&quot;
	action=&quot;Upload&quot;
	attributes=&quot;Normal&quot;&gt;
&lt;cfoutput&gt;
	The URL variable is: #URL.myurl# &lt;br&gt;
	The Cookie variable is: #Cookie.mycookie6# &lt;br&gt;
	The CGI variable is: #CGI.mycgi#. &lt;br&gt;
	The Formfield variable is: #Form.emailaddress#. &lt;br&gt;
	The file was uploaded to #File.ServerDirectory#\#File.ServerFile#.
&lt;/cfoutput&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>
</li>
<li>
   Replace C:\temp\ with an appropriate directory path on your hard drive.
</li>
<li>
   Save the file as post_test_server.cfm in the myapps directory under your <i>web_root</i>.
</li>
<li>
   View post_test.cfm in your browser and look for the file in C:\temp\ (or your replacement path).
</li>
</ol>
<h4><a name="wp1104197"></a>Reviewing the code</h4>
<p>The following table describes the code and its function:</p>
<table border="0" cellpadding="0" cellspacing="0">
  <tr>
    <th>
Code
    </th>
    <th>
Description
    </th>
  </tr>
  <tr>
    <td>
<pre>&lt;cffile destination=&quot;C:\temp\&quot;
   nameconflict=&quot;Overwrite&quot;
   filefield=&quot;Form.myfile&quot;
   action=&quot;Upload&quot;
   attributes=&quot;Normal&quot;&gt;
</pre>    </td>
    <td>
<p>Write the transferred document to a file on the server. You send the file using the <a href="00000273.htm#1100049"><code>cfhttpparam</code></a><code> type=&quot;File&quot;</code> attribute, but the receiving page gets it as a Form variable, not a File variable. This <a href="00000245.htm#1098395"><code>cffile</code></a> tag creates File variables, as follows.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<pre>&lt;cfoutput&gt;
</pre>    </td>
    <td>
<p>Output information. The results are not displayed by this page. They are passed back to the posting page in its <code>cfhttp.filecontent</code> variable.</p>
    </td>
  </tr>
  <tr>
    <td>
<pre>The URL variable is: #URL.myurl# &lt;br&gt;
</pre>    </td>
    <td>
<p>Output the value of the URL variable sent in the HTTP request.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<pre>The Cookie variable is: #Cookie.mycookie# &lt;br&gt;
</pre>    </td>
    <td>
<p>Output the value of the Cookie variable sent in the HTTP request.</p>
    </td>
  </tr>
  <tr>
    <td>
<pre>The CGI variable is: #CGI.mycgi# &lt;br&gt;
</pre>    </td>
    <td>
<p>Output the value of the CGI variable sent in the HTTP request.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<pre>The Form variable is:<br />#Form.emailaddress#. &lt;br&gt;
</pre>    </td>
    <td>
<p>Output the Form variable sent in the HTTP request. You send the variable using the <code>type=&quot;formField&quot;</code> attribute but the receiving page gets it as a Form variable.</p>
    </td>
  </tr>
  <tr>
    <td>
<pre>The file was uploaded to #File.ServerDirectory#\#File.<br />ServerFile#.
&lt;/cfoutput&gt;
</pre>    </td>
    <td>
<p>Output the results of the <code>cffile</code> tag on this page. This time, the variables really are File variables.</p>
    </td>
  </tr>
</table>

<h4>To return results of a CGI program:</h4>
<p>The following code runs a CGI program search.exe on a website and displays the results, including both the MIME type and length of the response. The search.exe program must expect a &quot;search&quot; parameter. </p>
<pre>&lt;cfhttp method=&quot;Post&quot;
      url=&quot;http://www.my_favorite_site.com/search.exe&quot;
      resolveurl=&quot;Yes&quot;&gt;
   &lt;cfhttpparam type=&quot;Formfield&quot; 
      name=&quot;search&quot; 
      value=&quot;Macromedia ColdFusion&quot;&gt;
&lt;/cfhttp&gt;
&lt;cfoutput&gt;
   Response Mime Type: #cfhttp.MimeType#&lt;br&gt;
   Response Length: #len(cfhttp.filecontent)# &lt;br&gt;
   Response Content: &lt;br&gt;
      #htmlcodeformat(cfhttp.filecontent)#&lt;br&gt;
&lt;/cfoutput&gt;
</pre>

<hr />
<p align="right"><p align="right"><a href="00001610.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001612.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<p><a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00001611.htm" target="mm_window">View comments in LiveDocs</a></p>
 </body>
</html>



