<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="Content-Style-Type" content="text/css">
   <script src="pages.js" type="text/javascript" language="Javascript1.2" charset="UTF-8"></script>
   <title>Using subreports</title>
</head>
<body>
<p align="right"><p align="right"><a href="00001473.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001475.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<hr />
<h1>Using subreports</h1>
<p>Subreports let you nest a report within your report. The data you display in a subreport is typically related to the data in the main report and you enable this by passing one or more subreport parameters to the subreport. However, the data displayed in a subreport can also be unrelated to the data in the main report.</p>
<p>Reasons to use subreports including the following:</p>
<ul>
<li>
   You wish to avoid complex SQL, such as a RIGHT OUTER JOIN.
</li>
<li>
   Your report requires data from multiple databases.
</li>
</ul>
<p>The following figure illustrates the use of subreport parameters and the relationship between a report and a subreport:</p>
<p><br />
<img src="images/subrepor.jpg" border="0" hspace="0" vspace="0"/>
<br />
</p>
<p><strong>Note: </strong>Although the Report Builder supports multiple levels of nesting, it displays one level of nesting only.</p><p>For additional information on subreports, see Report Builder online Help.</p>
<h3><a name="wp130718"></a>Defining a subreport</h3>
<p>You can define a subreport and include it in a report, or you can define it as part of inserting the subreport in the main report.</p>
<p>However, regardless of how you define it, a subreport has the following characteristics:</p>
<ul>
<li>
   Data displayed in the detail band only. A subreport uses no header or footer bands.
</li>
<li>
   If the subreport is related to the main report, it must include an internal query that uses a SELECT statement with a WHERE clause specifying the name of the input parameter used in the main report's Subreport Expression property.
</li>
</ul>
<h3><a name="wp130777"></a>Adding an existing subreport to a report</h3>
<p>If you have already defined a subreport, you add it to the main report and define subreport parameters, as necessary.</p>
<h4>To add an existing subreport to a report:</h4>
<ol>
<li>
   Define or open your main report.
</li>
<li>
   Click the Subreport icon in the toolbox.
</li>
<li>
   Drag an area for the subreport in the desired report band.
<p>The Subreport Source panel appears.</p>
</li>
<li>
   Select From an Existing Report, specify the subreport, and click Next.
<p>The Report to Subreport Parameter Binding panel appears.</p>
</li>
<li>
   Select the fields in the main report that correspond to fields in the subreport and click Next.
<p>The Finish Subreport Setup panel appears.</p>
</li>
<li>
   Click Finish.
<p>The Report Builder adds the subreport to the main report, saving the report to subreport mappings as subreport parameters. </p>
</li>
<li>
   To modify subreport parameter settings, select the subreport and click on Subreport Parameters in the Properties sheet.
</li>
</ol>
<h3><a name="wp130719"></a>Adding a new subreport to a report</h3>
<p>If you are certain of the data required for a subreport, you can define a new subreport while adding it to the main report.</p>
<h4>To add a new subreport to a report:</h4>
<ol>
<li>
   Define or open your main report.
</li>
<li>
   Click the Subreport icon in the toolbox.
</li>
<li>
   Drag an area for the subreport in the desired report band.
<p>The Subreport Source panel appears.</p>
</li>
<li>
   Select As a New Report and click Next.
<p>The Define Query Fields panel appears.</p>
</li>
<li>
   Click Query Builder.
<p>The Query Builder appears.</p>
</li>
<li>
   Select the tables and columns for the subreport.
</li>
<li>
   Specify a WHERE clause for the report by using the Condition and Criteria columns for the key columns. 
<p>Specify WHERE for Condition and either <code>=&#39;#CFVariable#&#39;</code> (string column) or <code>=#CFVariable#</code> (numeric column) for Criteria, and then overtype <code>CFVariable</code> with the name of the input parameter for the subreport (you define the input parameter name later in the procedure.)</p>
</li>
<li>
   Click Save.
</li>
<li>
   Click Next.
<p>The Define Report Grouping panel appears.</p>
</li>
<li>
   Specify grouping fields, if appropriate for your subreport.
</li>
<li>
   Click Next.
<p>The Report Layout panel appears.</p>
</li>
<li>
   Specify Free Form or Grid. Then click Next.
<p>The Report Style panel appears.</p>
</li>
<li>
   Specify Only Detail Band and click Next.
<p>The Report Theme panel appears.</p>
</li>
<li>
   Specify a color scheme and click Next.
<p>The Report Name panel appears.</p>
</li>
<li>
   Specify headings, as appropriate, and click Next.
<p>The Subreport Binding panel appears.</p>
</li>
<li>
   For each parameter required by the subreport, specify the following:
<ul><li>Parameter name.</li>
<li>Associated value from the main report (click the drop-down list box).</li>
<li>Data type.</li>
</ul></li>
<li>
   Click Next.
<p>The Subreport Filename panel appears.</p>
</li>
<li>
   Specify a fully qualified filename for the subreport.
</li>
<li>
   Click Next.
<p>The Finish Subreport Setup panel appears.</p>
</li>
<li>
   Click Finish.
</li>
<li>
   Modify the subreport, as necessary.
<p>The Report Builder adds the subreport to the main report.</p>
</li>
</ol>
<h3><a name="wp131112"></a>Modifying subreport settings</h3>
<p>The Report Builder lets you change subreport name and modify subreport parameters in a main report.</p>
<h4>To modify subreport settings:</h4>
<ol>
<li>
   Click the subreport element in the main report.
<p>Subreport settings display in the Properties sheet.</p>
</li>
<li>
   To change the subreport, modify Subreport Expression.
</li>
<li>
   To modify subreport parameters:
<ol><li>Click the Subreport Parameters property.</li><li>Click the ... button.</li><p>The Subreport Parameters dialog box appears.</p>
<li>Add, modify, or delete subreport parameters.</li><li>Click OK.</li></ol></li>
</ol>


<hr />
<p align="right"><p align="right"><a href="00001473.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001475.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<p><a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00001474.htm" target="mm_window">View comments in LiveDocs</a></p>
 </body>
</html>



