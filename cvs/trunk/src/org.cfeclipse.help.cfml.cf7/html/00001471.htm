<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="Content-Style-Type" content="text/css">
   <script src="pages.js" type="text/javascript" language="Javascript1.2" charset="UTF-8"></script>
   <title>Using CFML in reports</title>
</head>
<body>
<p align="right"><p align="right"><a href="00001470.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001472.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<hr />
<h1>Using CFML in reports</h1>
<p>CFML is the scripting language for the Report Builder. By leveraging CFML, you can easily create reports that select and format data to meet your needs. You can use CFML in the following areas of the Report Builder:</p>
<ul>
<li>
   Advanced query mode
</li>
<li>
   Report functions
</li>
<li>
   Expressions
</li>
</ul>
<h3><a name="wp134350"></a>Advanced query mode</h3>
<p>In some cases, you may want to use create a complex query, reuse an existing query, or encapsulate additional CFML processing as part of query creation for the report. In this case, you can use advanced query mode to create CFML that returns a query. When you click the Advanced button at the top of the Query Builder, the Report Builder displays a text entry area in which you can enter CFML that generates a query. ColdFusion executes this tag at report execution time and passes the query result set to the report.</p>
<p><strong>Note: </strong>When you use advanced query mode, the Query Builder does not create query fields automatically. You must create the associated query fields manually.</p><p>The CFML used in advanced query mode must include a query object whose name matches that in the Variable containing query object field. You can use any CFML tag that returns a query object or the <code>QueryNew</code> function. The CFML can use multiple query objects, but can only return one.</p>
<p><strong>Note: </strong>If you set an empty variable (for example, &lt;cfset name=&quot;&quot;&gt;), the Report Builder throws a Report data binding error.</p><p>This example CFML uses the <code>cfhttp</code> tag to retrieve a query:</p>
<pre>&lt;cfhttp url=&quot;http://quote.yahoo.com/download/quotes.csv?Symbols=csco,jnpr&amp;format=sc1l1&amp;ext=.csv&quot;
method=&quot;GET&quot;
name=&quot;qStockItems&quot;
columns=&quot;Symbol,Change,LastTradedPrice&quot;
textqualifier=&quot;&quot;&quot;&quot;
delimiter=&quot;,&quot;
firstrowasheaders=&quot;no&quot;&gt; 
</pre><p>Another possible use of advanced query mode is to test for passed parameters in the URL or FORM scopes and use these parameters to retrieve data, as the following example shows:</p>
<pre>&lt;!--- First look for URL parm.
      URL overrides cfreportparam. ---&gt;
&lt;cfif isDefined(&quot;url.deptidin&quot;)&gt;
  &lt;cfset param.deptidin = url.deptidin&gt;
&lt;/cfif&gt;

&lt;!-- Then look for FORM parm. Overrides URL parm. ---&gt;
&lt;cfif isDefined(&quot;form.deptidin&quot;)&gt;
  &lt;cfset param.deptidin = form.deptidin&gt;
&lt;/cfif&gt;

&lt;cfquery name=&quot;CFReportDataQuery&quot; datasource=&quot;cfdocexamples&quot;&gt;
SELECT    LastName, FirstName, Dept_ID
FROM      Employee 
WHERE     (Dept_ID = #param.deptidin#)
&lt;/cfquery&gt;
</pre>

<hr />
<p align="right"><p align="right"><a href="00001470.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001472.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<p><a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00001471.htm" target="mm_window">View comments in LiveDocs</a></p>
 </body>
</html>



