<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="Content-Style-Type" content="text/css">
   <script src="pages.js" type="text/javascript" language="Javascript1.2" charset="UTF-8"></script>
   <title>Using cfcontent</title>
</head>
<body>
<p align="right"><p align="right"><a href="00001623.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001625.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<hr />
<h1>Using cfcontent</h1>
<p>The <a href="00000232.htm#2850760"><code>cfcontent</code></a> tag downloads files from the server to the client. You can use this tag to set the MIME type of the content returned by a ColdFusion page and, optionally, define the filename of a file to be downloaded by the current page. By default, ColdFusion returns a MIME content type of text/html so that a web browser renders your template text as a web page.</p>
<p>As with <a href="00000245.htm#1098395"><code>cffile</code></a> and <a href="00000235.htm#1097918"><code>cfdirectory</code></a><code>,</code> you can disable <a href="00000232.htm#2850760"><code>cfcontent</code></a> processing in the ColdFusion&#160;MX Administrator. </p>
<h2><a name="wp1106857"></a>About MIME types</h2>
<p>A <i>MIME type</i> is a label that identifies the contents of a file. the browser uses the MIME type specification to determine how to interact with the file. For example, the browser could open a spreadsheet program when it encounters a file identified by its MIME content type as a spreadsheet file.</p>
<p>A MIME content type consists of<code> &quot;type/subtype&quot;</code> format. The following are common MIME content types:</p>
<ul>
<li>
   text/html
</li>
<li>
   image/gif
</li>
<li>
   application/pdf
</li>
</ul>
<h2><a name="wp1088159"></a>Changing the MIME content type with cfcontent</h2>
<p>You use the <a href="00000232.htm#2850760"><code>cfcontent</code></a> tag to change the MIME content type that returns to the browser along with the content generated from your ColdFusion page.</p>
<p>The <code>cfcontent</code> tag has one required attribute, <code>type</code>, which defines the MIME content type returned by the current page.</p>
<h4>To change the MIME content type with cfcontent:</h4>
<ol>
<li>
   Create an HTML page with the following content:
<pre>
&lt;h1&gt;cfcontent_message.htm&lt;/h1&gt;

&lt;p&gt;This is a &lt;em&gt;test message&lt;/em&gt; written in HTML.&lt;/p&gt;
&lt;p&gt;This is the &lt;em&gt;second paragraph&lt;/em&gt; of the test message.  
As you might expect, it is also written in HTML.&lt;/p&gt;
</pre>
</li>
<li>
   Save the file as cfcontent_message.htm in the myapps directory under your <i>web_root</i>.
<p>This HTML file will be called by the ColdFusion file that you write in steps 3 through 7.</p>
</li>
<li>
   Create a ColdFusion page with the following content:
<pre>
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;cfcontent Example&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;
&lt;h3&gt;cfcontent Example&lt;/h3&gt;

&lt;cfcontent 
	type = &quot;text/html&quot; 
	file = &quot;C:\CFusionMX7\wwwroot\myapps\cfcontent_message.htm&quot; 
	deleteFile = &quot;No&quot;&gt;
&lt;/body&gt;
&lt;/html&gt;    
</pre>
</li>
<li>
   If necessary, edit the <code>file =</code> line to point to your myapps directory.
</li>
<li>
   Save the file as cfcontent.cfm in the myapps directory under your <i>web_root</i> and view it in the browser.
<p>The text of the called file (cfcontent_message.htm) displays as normal HTML, as shown in the following figure:</p>
<p><br />
<img src="images/cfconte3.jpg" alt="Text of the called file in a browser." border="0" hspace="0" vspace="0"/>
<br />
</p>
</li>
<li>
   In cfcontent.cfm, change <code>type = &quot;text/html&quot;</code> to <code>type = &quot;text/plain&quot;</code>.
</li>
<li>
   Save the file and view it in the browser (refresh it if necessary).
<p>The text displays as unformatted text, in which HTML tags are treated as text:</p>
<p><br />
<img src="images/cfconte4.jpg" alt="Unformatted HTML text." border="0" hspace="0" vspace="0"/>
<br />
</p>
</li>
</ol>
<p>The following example shows how the cfcontent tag can create an Excel spreadsheet that contains your data.</p>
<h4>To create an Excel spreadsheet with cfcontent:</h4>
<ol>
<li>
   Create a ColdFusion page with the following content:
<pre>
&lt;!--- Use cfsetting to block output of HTML 
outside of cfoutput tags. ---&gt;
&lt;cfsetting enablecfoutputonly=&quot;Yes&quot;&gt;

&lt;!--- Get employee info. ---&gt;
&lt;cfquery name=&quot;GetEmps&quot; datasource=&quot;cfdocexamples&quot;&gt;
	SELECT * FROM Employee
&lt;/cfquery&gt;

&lt;!--- Set content type. ---&gt;
&lt;cfcontent type=&quot;application/msexcel&quot;&gt;

&lt;!--- Suggest default name for XLS file. ---&gt;
&lt;!--- &quot;Content-Disposition&quot; in cfheader also ensures 
relatively correct Internet Explorer behavior. ---&gt;
&lt;cfheader name=&quot;Content-Disposition&quot; value=&quot;filename=Employees.xls&quot;&gt;

&lt;!--- Format data using cfoutput and a table. 
		Excel converts the table to a spreadsheet.
		The cfoutput tags around the table tags force output of the HTML when
		using cfsetting enablecfoutputonly=&quot;Yes&quot; ---&gt;
&lt;cfoutput&gt;
	&lt;table cols=&quot;4&quot;&gt;
		&lt;cfloop query=&quot;GetEmps&quot;&gt;
			&lt;tr&gt;
				&lt;td&gt;#Emp_ID#&lt;/td&gt;
				&lt;td&gt;#FirstName#&lt;/td&gt;
				&lt;td&gt;#LastName#&lt;/td&gt;
			&lt;/tr&gt;
		&lt;/cfloop&gt;
	&lt;/table&gt;
&lt;/cfoutput&gt;
</pre>
</li>
<li>
   Save the file as employees_to_excel.cfm in the myapps directory under your <i>web_root</i> and view it in the browser.
<p>The data appears in an Excel spreadsheet, as in the following figure:</p>
<p><br />
<img src="images/cfconten.jpg" alt="Data in an Excel spreadsheet." border="0" hspace="0" vspace="0"/>
<br />
</p>
</li>
</ol>


<hr />
<p align="right"><p align="right"><a href="00001623.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001625.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<p><a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00001624.htm" target="mm_window">View comments in LiveDocs</a></p>
 </body>
</html>



