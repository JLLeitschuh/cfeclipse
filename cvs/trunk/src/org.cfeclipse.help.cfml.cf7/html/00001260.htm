<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="Content-Style-Type" content="text/css">
   <script src="pages.js" type="text/javascript" language="Javascript1.2" charset="UTF-8"></script>
   <title>Inserting data</title>
</head>
<body>
<p align="right"><p align="right"><a href="00001259.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001261.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<hr />
<h1>Inserting data</h1>
<p>You usually use two application pages to insert data into a database:</p>
<ul>
<li>
   An insert form
</li>
<li>
   An insert action page
</li>
</ul>
<p>You can create an insert form with standard HTML form tags or with <a href="00000256.htm#2433198"><code>cfform</code></a> tags (see <a href="00001350.htm#1166643">Creating custom forms with the cfform tag</a>). When the user submits the form, form variables are passed to a ColdFusion action page that performs an insert operation (and whatever else is called for) on the specified data source. The insert action page can contain either a <a href="00000280.htm#1100472"><code>cfinsert</code></a> tag or a <a href="00000316.htm#1102316"><code>cfquery</code></a> tag with a SQL INSERT statement. The insert action page should also contain a confirmation message for the end user.</p>
<h2><a name="wp1101332"></a>Creating an HTML insert form</h2>
<p>The following procedure creates a form using standard HTML tags. The form looks like the following in your web browser:</p>
<p><br />
<img src="images/form_ht3.jpg" alt="An HTML insert form in a web browser" border="0" hspace="0" vspace="0"/>
<br />
</p>
<h4>To create an insert form:</h4>
<ol>
<li>
   Create a ColdFusion page with the following content:
<pre>
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Insert Data Form&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;
&lt;h2&gt;Insert Data Form&lt;/h2&gt;

&lt;table&gt;
&lt;!--- begin html form; 
put action page in the &quot;action&quot; attribute of the form tag ---&gt;
&lt;form action=&quot;insert_action.cfm&quot; method=&quot;post&quot;&gt;
&lt;tr&gt;
	&lt;td&gt;Employee ID:&lt;/td&gt;
	&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;Emp_ID&quot; size=&quot;4&quot; maxlength=&quot;4&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
	&lt;td&gt;First Name:&lt;/td&gt;
	&lt;td&gt;&lt;input type=&quot;Text&quot; name=&quot;FirstName&quot; size=&quot;35&quot; maxlength=&quot;50&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
	&lt;td&gt;Last Name:&lt;/td&gt;
	&lt;td&gt;&lt;input type=&quot;Text&quot; name=&quot;LastName&quot; size=&quot;35&quot; maxlength=&quot;50&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
	&lt;td&gt;Department Number:&lt;/td&gt;
	&lt;td&gt;&lt;input type=&quot;Text&quot; name=&quot;Dept_ID&quot; size=&quot;4&quot; maxlength=&quot;4&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
	&lt;td&gt;Start Date:&lt;/td&gt;
	&lt;td&gt;&lt;input type=&quot;Text&quot; name=&quot;StartDate&quot; size=&quot;16&quot; maxlength=&quot;16&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
	&lt;td&gt;Salary:&lt;/td&gt;
	&lt;td&gt;&lt;input type=&quot;Text&quot; name=&quot;Salary&quot; size=&quot;10&quot; maxlength=&quot;10&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
	&lt;td&gt;Contractor:&lt;/td&gt;
	&lt;td&gt;&lt;input type=&quot;checkbox&quot; name=&quot;Contract&quot; value=&quot;Yes&quot; checked&gt;Yes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
	&lt;td&gt;&amp;nbsp;&lt;/td&gt;
	&lt;td&gt;&lt;input type=&quot;Submit&quot; value=&quot;Submit&quot;&gt;&amp;nbsp;&lt;input type=&quot;Reset&quot;
value=&quot;Clear Form&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/form&gt;
&lt;!--- end html form ---&gt;
&lt;/table&gt;

&lt;/body&gt;
&lt;/html&gt;
</pre>
</li>
<li>
   Save the file as insert_form.cfm in the myapps directory under your <i>web_root</i> and view it in your web browser.
</li>
</ol>
<p><strong>Note: </strong>The form will not work until you write an action page for it. For more information, see <a href="00001260.htm#1101373">Creating an action page to insert data</a>.</p><h2><a name="wp1114533"></a>Data entry form notes and considerations</h2>
<p>If you use the <a href="00000280.htm#1100472"><code>cfinsert</code></a> tag in the action page to insert the data into the database, you should follow these rules for creating the form page: </p>
<ul>
<li>
   You only need to create HTML form fields for the database columns into which you will insert data.
</li>
<li>
   By default, <code>cfinsert</code> inserts all of the form's fields into the database columns with the same names. For example, it puts the Form.Emp_ID value in the database Emp_ID column. The tag ignores form fields that lack corresponding database column names.
</li>
</ul>
<p><strong>Note: </strong>You can also use the <code>formfields</code> attribute of the <code>cfinsert</code> tag to specify which fields to insert; for example, <code>formfields=&quot;prod_ID,Emp_ID,status&quot;</code>.</p><h2><a name="wp1101373"></a>Creating an action page to insert data</h2>
<p>You can use the <a href="00000280.htm#1100472"><code>cfinsert</code></a> tag or the <a href="00000316.htm#1102316"><code>cfquery</code></a> tag to create an action page that inserts data into a database. </p>
<h3><a name="wp1120781"></a>Creating an insert action page with cfinsert</h3>
<p>The <a href="00000280.htm#1100472"><code>cfinsert</code></a> tag is the easiest way to handle simple inserts from either a <a href="00000256.htm#2433198"><code>cfform</code></a> or an HTML form. This tag inserts data from all the form fields with names that match database field names.</p>
<h4>To create an insert action page with cfinsert:</h4>
<ol>
<li>
   Create a ColdFusion page with the following content:
<pre>
&lt;html&gt;
&lt;head&gt; &lt;title&gt;Input form&lt;/title&gt; &lt;/head&gt;

&lt;body&gt;
&lt;!--- If the Contractor check box is clear, 
	set the value of the Form.Contract to &quot;No&quot; ---&gt;
&lt;cfif not isdefined(&quot;Form.Contract&quot;)&gt;
   &lt;cfset Form.Contract = &quot;No&quot;&gt;
&lt;/cfif&gt;

&lt;!--- Insert the new record ---&gt;
&lt;cfinsert datasource=&quot;cfdocexamples&quot; tablename=&quot;Employee&quot;&gt;

&lt;h1&gt;Employee Added&lt;/h1&gt;
&lt;cfoutput&gt;You have added #Form.FirstName# #Form.Lastname# to the
			employee database.
&lt;/cfoutput&gt;

&lt;/body&gt;
&lt;/html&gt;
</pre>
</li>
<li>
   Save the page as insert_action.cfm.
</li>
<li>
   View insert_form.cfm in your web browser and enter values.
<p><strong>Note: </strong>You might want to compare views of the Employee table in the cfdocexamples data source before and after inserting values in the form.</p></li>
<li>
   Click Submit. 
<p>ColdFusion inserts your values into the Employee table and displays a confirmation message.</p>
</li>
</ol>
<h4><a name="wp1127690"></a>Reviewing the code</h4>
<p>The following table describes the code and its function:</p>
<table border="0" cellpadding="0" cellspacing="0">
  <tr>
    <th>
Code
    </th>
    <th>
Description
    </th>
  </tr>
  <tr>
    <td>
<pre>&lt;cfif not isdefined(&quot;Form.Contract&quot;)&gt;
   &lt;cfset Form.Contract = &quot;No&quot;&gt;
&lt;/cfif&gt;
</pre>    </td>
    <td>
<p>Sets the value of Form.Contract to No if it is not defined. If the Contractor check box is unchecked, no value is passed to the action page; however, the database field must have some value.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<pre>&lt;cfinsert datasource=&quot;cfdocexamples&quot;<br />   tablename=&quot;Employee&quot;&gt;
</pre>    </td>
    <td>
<p>Creates a new row in the Employee table of the cfdocexamples database. Inserts data from the form into the database fields with the same names as the form fields. </p>
    </td>
  </tr>
  <tr>
    <td>
<pre>&lt;cfoutput&gt;You have added<br />#Form.FirstName# #Form.Lastname#<br />to the employee database.
&lt;/cfoutput&gt;
</pre>    </td>
    <td>
<p>Informs the user that values were inserted into the database.</p>
    </td>
  </tr>
</table>

<p><strong>Note: </strong>If you use form variables in <a href="00000280.htm#1100472"><code>cfinsert</code></a> or <a href="00000350.htm#1104662"><code>cfupdate</code></a> tags, ColdFusion automatically validates any form data it sends to numeric, date, or time database columns. You can use the hidden field validation functions for these fields to display a custom error message. For more information, see <a href="00001330.htm#1096836">Introduction to Retrieving and Formatting Data</a>.</p><h3><a name="wp1120810"></a>Creating an insert action page with cfquery</h3>
<p>For more complex inserts from a form submittal, you can use a SQL INSERT statement in a <a href="00000316.htm#1102316"><code>cfquery</code></a> tag instead of using a <a href="00000280.htm#1100472"><code>cfinsert</code></a> tag. The SQL INSERT statement is more flexible because you can insert information selectively or use functions within the statement.</p>
<p>The following procedure assumes that you have created the insert_action.cfm page, as described in <a href="00001260.htm#1120781">Creating an insert action page with cfinsert</a>.</p>
<h4>To create an insert action page with cfquery:</h4>
<ol>
<li>
   In insert_action.cfm, replace the <code>cfinsert</code> tag with the following highlighted <code>cfquery</code> code:
<pre>
&lt;html&gt;
&lt;head&gt;
	&lt;title&gt;Input form&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;
&lt;!--- If the Contractor check box is clear), 
	set the value of the Form.Contract to &quot;No&quot; ---&gt;
&lt;cfif not isdefined(&quot;Form.Contract&quot;)&gt;
   &lt;cfset Form.Contract = &quot;No&quot;&gt;
&lt;/cfif&gt;

&lt;!--- Insert the new record ---&gt;
&lt;cfquery name=&quot;AddEmployee&quot; datasource=&quot;cfdocexamples&quot;&gt;
	INSERT INTO Employee
	VALUES (#Form.Emp_ID#, &#39;#Form.FirstName#&#39;,<br />
&#39;#Form.LastName#&#39;, #Form.Dept_ID#,<br />
&#39;#Form.StartDate#&#39;, #Form.Salary#, &#39;#Form.Contract#&#39;)
&lt;/cfquery&gt;

&lt;h1&gt;Employee Added&lt;/h1&gt;
&lt;cfoutput&gt;You have added #Form.FirstName# #Form.Lastname# to the
			employee database.
&lt;/cfoutput&gt;

&lt;/body&gt;
&lt;/html&gt;
</pre>
</li>
<li>
   Save the page.
</li>
<li>
   View insert_form.cfm in your web browser and enter values.
</li>
<li>
   Click Submit. 
<p>ColdFusion inserts your values into the Employee table and displays a confirmation message.</p>
</li>
</ol>
<h4><a name="wp1109212"></a>Reviewing the code</h4>
<p>The following table describes the highlighted code and its function:</p>
<table border="0" cellpadding="0" cellspacing="0">
  <tr>
    <th>
Code
    </th>
    <th>
Description
    </th>
  </tr>
  <tr>
    <td>
<pre>&lt;cfquery name=&quot;AddEmployee&quot; datasource=&quot;cfdocexamples&quot;&gt;
   INSERT INTO Employee
   VALUES (#Form.Emp_ID#,<br />      &#39;#Form.FirstName#&#39;,<br />      &#39;#Form.LastName#&#39;,<br />      #Form.Dept_ID#,<br />      &#39;#Form.StartDate#&#39;,<br />      #Form.Salary#,<br />      &#39;#Form.Contract#&#39;)
&lt;/cfquery&gt;
</pre>    </td>
    <td>
<p>Inserts a new row into the Employee table of the cfdocexamples database. Specifies each form field to be added.</p>
<p>Because you are inserting data into all database fields in the same left-to-right order as in the database, you do not have to specify the database field names in the query.</p>
<p>Because #From.Emp_ID#, #Form.Dept_ID#, and #Form.Salary# are numeric, they do not need to be enclosed in quotation marks.</p>
    </td>
  </tr>
</table>

<h3><a name="wp1113995"></a>Inserting into specific fields</h3>
<p>The preceding example inserts data into all the fields of a table (the Employee table has seven fields). There might be times when you do not want users to add data into all fields. To insert data into specific fields, the SQL statement in the <a href="00000316.htm#1102316"><code>cfquery</code></a> must specify the field names following both INSERT INTO and VALUES. For example, the following <code>cfquery</code> omits salary and start date information from the update. Database values for these fields are 0 and NULL, respectively, according to the database's design.</p>
<pre>&lt;cfquery name=&quot;AddEmployee&quot; datasource=&quot;cfdocexamples&quot;&gt;
   INSERT INTO Employee
      (Emp_ID,FirstName,LastName,
      Dept_ID,Contract)   
   VALUES 
      (#Form.Emp_ID#,&#39;#Form.FirstName#&#39;,&#39;#Form.LastName#&#39;, 
      #Form.Dept_ID#,&#39;#Form.Contract#&#39;)
&lt;/cfquery&gt;
</pre>

<hr />
<p align="right"><p align="right"><a href="00001259.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001261.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<p><a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00001260.htm" target="mm_window">View comments in LiveDocs</a></p>
 </body>
</html>



