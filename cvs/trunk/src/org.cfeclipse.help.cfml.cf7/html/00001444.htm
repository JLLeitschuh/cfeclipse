<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="Content-Style-Type" content="text/css">
   <script src="pages.js" type="text/javascript" language="Javascript1.2" charset="UTF-8"></script>
   <title>Creating sections, headers, and footers</title>
</head>
<body>
<p align="right"><p align="right"><a href="00001443.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001445.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<hr />
<h1>Creating sections, headers, and footers</h1>
<p>You can use the <a href="00000237.htm#3766460"><code>cfdocumentitem</code></a> and <a href="00000238.htm#3766659"><code>cfdocumentsection</code></a> tags to fine-tune your printable output, as follows:</p>
<ul>
<li>
   <code>cfdocumentitem</code>&#160;Creates page breaks, headers, or footers.
</li>
<li>
   <code>cfdocumentsection</code>&#160;Divides output into sections, optionally specifying custom margins. Within a section, use the <code>cfdocumentitem</code> tag to specify unique headers and footers for each section.
</li>
</ul>
<h3><a name="wp120716"></a>cfdocumentitem</h3>
<p>You use one or more <code>cfdocumentitem</code> tags to specify headers and footers or to create a page break. You can use <code>cfdocumentitem</code> tags with or without the <code>cfdocumentsection</code> tag, as follows:</p>
<ul>
<li>
   With <code>cfdocumentsection</code>&#160;The <code>cfdocumentitem</code> attribute applies only to the section, and overrides previously specified headers and footers.
</li>
<li>
   Without <code>cfdocumentsection</code>&#160;The <code>cfdocumentitem</code> attribute applies to the entire document, as follows:
<ul><li>If the tag is at the top of the document, it applies to the entire document.</li>
<li>If the tag is in the middle of the document, it applies to the rest of the document.</li>
<li>If the tag is at the end of the document, it has no affect.</li>
</ul></li>
</ul>
<p>You can use the <code>cfdocumentitem</code> tag to create a running header for an entire document, as the following example shows:</p>
<pre>&lt;cfdocument format=&quot;PDF&quot;&gt;
&lt;!--- Running header ---&gt;
<code><strong>&lt;cfdocumentitem type=&quot;header&quot;&gt;</strong></code>
<code><strong>  &lt;font size=&quot;-3&quot;&gt;&lt;i&gt;Directory Report&lt;/i&gt;&lt;/font&gt;</strong></code>
<code><strong>&lt;/cfdocumentitem&gt;</strong></code>
&lt;h3&gt;cfdirectory Example&lt;/h3&gt;
&lt;!--- Use cfdirectory to display directories by name and size ---&gt;
&lt;cfdirectory
  directory=&quot;#GetDirectoryFromPath(GetTemplatePath())#&quot;
  name=&quot;myDirectory&quot; recurse=&quot;yes&quot;
  sort=&quot;directory ASC, name ASC, size DESC&quot;&gt;
&lt;!---- Output the contents of the cfdirectory as a cftable -----&gt;
&lt;cftable query=&quot;myDirectory&quot;
  htmltable colheaders&gt;
  &lt;cfcol header=&quot;DIRECTORY:&quot; text=&quot;#directory#&quot;&gt;
  &lt;cfcol header=&quot;NAME:&quot; text=&quot;#Name#&quot;&gt;
  &lt;cfcol header=&quot;SIZE:&quot; text=&quot;#Size#&quot;&gt;
&lt;/cftable&gt;
&lt;/cfdocument&gt;
</pre><h3><a name="wp120348"></a>cfdocumentsection</h3>
<p>When using <code>cfdocumentsection</code>, all text in the document must be enclosed within <code>cfdocumentsection</code> tags. ColdFusion MX ignores HTML and CFML outside of <code>cfdocumentsection</code> tags. The margin attributes override margins specified in previous sections or in the parent <code>cfdocument</code> tag. If you specify margin attributes, the units are controlled by the unit attribute of the parent <code>cfdocument</code> tag; the default for the unit attribute is inches.</p>
<p>Within a section, use the <code>cfdocumentitem</code> tag to specify unique headers and footers for each section and a page break before each section, as the following example shows:</p>
<pre>&lt;cfquery datasource=&quot;cfdocexamples&quot; name=&quot;empSalary&quot;&gt;
SELECT Emp_ID, firstname, lastname, e.dept_id, salary, d.dept_name 
FROM employee e, departmt d
WHERE e.dept_id = d.dept_id
ORDER BY d.dept_name
&lt;/cfquery&gt;

&lt;cfdocument format=&quot;PDF&quot;&gt;
  &lt;cfoutput query=&quot;empSalary&quot; group=&quot;dept_id&quot;&gt;
   <code><strong>&lt;cfdocumentsection&gt;</strong></code>
   &lt;cfdocumentitem type=&quot;header&quot;&gt;
      &lt;font size=&quot;-3&quot;&gt;&lt;i&gt;Salary Report&lt;/i&gt;&lt;/font&gt;
   &lt;/cfdocumentitem&gt;
   &lt;cfdocumentitem type=&quot;footer&quot;&gt;
      &lt;font size=&quot;-3&quot;&gt;Page #cfdocument.currentpagenumber#&lt;/font&gt;
   &lt;/cfdocumentitem&gt;      
   &lt;h2&gt;#dept_name#&lt;/h2&gt;
    &lt;table width=&quot;95%&quot; border=&quot;2&quot; cellspacing=&quot;2&quot; cellpadding=&quot;2&quot; &gt;
     &lt;tr&gt;
       &lt;th&gt;Employee&lt;/th&gt;
       &lt;th&gt;Salary&lt;/th&gt;
     &lt;/tr&gt;
     &lt;cfset deptTotal = 0 &gt;
     &lt;!--- inner cfoutput ---&gt;
     &lt;cfoutput&gt;
       &lt;tr&gt;
          &lt;td&gt;&lt;font size=&quot;-1&quot;&gt;
          #empSalary.lastname#, #empSalary.firstname#&lt;/font&gt;
        &lt;/td&gt;
        &lt;td align=&quot;right&quot;&gt;&lt;font size=&quot;-1&quot;&gt;
          #DollarFormat(empSalary.salary)#&lt;/font&gt;
        &lt;/td&gt;
         &lt;/tr&gt;
       &lt;cfset deptTotal = deptTotal + empSalary.salary&gt;         
     &lt;/cfoutput&gt;
      &lt;tr&gt;
          &lt;td align=&quot;right&quot;&gt;&lt;font size=&quot;-1&quot;&gt;Total&lt;/font&gt;&lt;/td&gt;
        &lt;td align=&quot;right&quot;&gt;&lt;font size=&quot;-1&quot;&gt;#DollarFormat(deptTotal)#&lt;/font&gt;&lt;/td&gt;
        &lt;/tr&gt;
      &lt;cfset deptTotal = 0&gt;
      &lt;/table&gt;
     <code><strong>&lt;/cfdocumentsection&gt;</strong></code>
   &lt;/cfoutput&gt;
&lt;/cfdocument&gt; 
</pre>

<hr />
<p align="right"><p align="right"><a href="00001443.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001445.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<p><a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00001444.htm" target="mm_window">View comments in LiveDocs</a></p>
 </body>
</html>



