<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="Content-Style-Type" content="text/css">
   <script src="pages.js" type="text/javascript" language="Javascript1.2" charset="UTF-8"></script>
   <title>Creating and using COM objects</title>
</head>
<body>
<p align="right"><p align="right"><a href="00001577.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001579.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<hr />
<h1>Creating and using COM objects</h1>
<p>You must use the <a href="00000302.htm#2820239"><code>cfobject</code></a> tag or the <a href="00000424.htm#1102241"><code>CreateObject</code></a> function to create an instance of the COM object (component) in ColdFusion before your application pages can invoke any methods or assign any properties in the component. </p>
<p>For example, the following code uses the <code>cfobject</code> tag to create the Windows CDO (Collaborative Data Objects) for NTS NewMail object to send mail: </p>
<pre>&lt;<code>cfobject</code> type=&quot;COM&quot;
      action=&quot;Create&quot;
      name=&quot;Mailer&quot;
      class=&quot;CDONTS.NewMail&quot;&gt;
</pre><p>The following line shows how to use the corresponding <code>CreateObject</code> function in CFScript:</p>
<pre><code>Mailer = CreateObject</code>(&quot;COM&quot;, &quot;CDONTS.NewMail&quot;);
</pre><p>The examples in later sections in this chapter use this object.</p>
<p><strong>Note: </strong>CDO is installed by default on all Windows NT and 2000 operating systems that have installed the Microsoft SMTP server. In Windows NT Server environments, the SMTP server is part of the Option Pack 4 setup. In Windows 2000 Server and Workstation environments, it is bundled with the operating system. For more information on CDO for NTS, see <a href="http://msdn.microsoft.com/library/default.asp?URL=/library/psdk/cdo/_olemsg_overview_of_cdo.htm" target="mm_window">http://msdn.microsoft.com/library/default.asp?URL=/library/psdk/cdo/_olemsg_overview_of_cdo.htm</a>.</p><p>The CDO for NTS NewMail component includes a number of methods and properties to perform a wide range of mail-handling tasks. (In the OLE/COM Object Viewer, methods and properties might be grouped together, so you could find it difficult to distinguish between them at first.)</p>
<p>The CDO for NTS NewMail object includes the following properties:</p>
<pre>Body [ String ]
Cc  [ String ]
From  [ String ]
Importance  [ Long ]
Subject  [ String ]
To  [ String ]
</pre><p>You use these properties to define elements of your mail message. The CDO for NTS NewMail object also includes a <code>send</code> method which has a number of optional arguments to send messages.</p>
<p>This section describes the following topics:</p>
<ul>
<li>
   <a href="00001579.htm#1127201">Connecting to COM objects</a>
</li>
<li>
   <a href="00001580.htm#1136089">Setting properties and invoking methods</a>
</li>
<li>
   <a href="00001581.htm#1136172">General COM object considerations</a>
</li>
<li>
   <a href="00001582.htm#1148538">Accessing Complex COM Objects using Java proxies</a>
</li>
<li>
   <a href="00001583.htm#1150289">Using the Application Scope to improve COM performance</a>
</li>
</ul>


<hr />
<p align="right"><p align="right"><a href="00001577.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001579.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<p><a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00001578.htm" target="mm_window">View comments in LiveDocs</a></p>
 </body>
</html>



