<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="Content-Style-Type" content="text/css">
   <script src="pages.js" type="text/javascript" language="Javascript1.2" charset="UTF-8"></script>
   <title>Updating a directory entry</title>
</head>
<body>
<p align="right"><p align="right"><a href="00001292.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001294.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<hr />
<h1>Updating a directory entry</h1>
<p>The <a href="00000283.htm#1100581"><code>cfldap</code></a> tag lets you change the values of entry attributes. To do so, you specify the entry DN in the <code>dn</code> attribute, and list the attributes to change and their new values in the <code>attributes</code> attribute. </p>
<p>The following example builds on the code that adds and deletes an entry. It can update one or more of an entry's attributes. Because the UID is part of the DN, you cannot change it.</p>
<h4>To update an entry:</h4>
<ol>
<li>
   Open update_ldap.cfm, which you created in <a href="00001291.htm#1096357">Adding a directory entry</a>.
</li>
<li>
   Between the <a href="00000241.htm#2647667"><code>cfelseif</code></a><code> Form.action is &quot;Retrieve&quot;</code> block and the <code>&lt;/</code><a href="00000274.htm#1100123"><code>cfif</code></a><code>&gt;</code> tag, add the following code:
<pre>
&lt;cfelseif Form.action is &quot;Update&quot;&gt;
&lt;cfset attributelist=&quot;cn=#Trim(form.FullName)#; sn=#Trim(Form.surname)#; 
mail=#Trim(Form.email)#; 
	telephonenumber=#Trim(Form.phone)#&quot;&gt;
&lt;cfldap action=&quot;modify&quot;
	modifytype=&quot;replace&quot;
	attributes=&quot;#attributeList#&quot;
	dn=&quot;uid=#Trim(Form.UID)#, ou=People, o=Airius.com&quot;
	server=#myServer#
	username=#myUserName#
	password=#myPassword#&gt;	
&lt;cfoutput&gt;&lt;h3&gt;Entry for User ID #Form.UID# has been updated&lt;/h3&gt;
&lt;/cfoutput&gt;
</pre>
</li>
<li>
   At the end of the code for the Delete button (the <code>input</code> tag with <code>Value=Delete) </code>at the bottom of the form<code>)</code>, delete the <code>&lt;/td&gt;</code> mark.
</li>
<li>
   After the end of the Delete button <code>input</code> tag, add the following code:
<pre>
&amp;nbsp
&lt;input type=&quot;Submit&quot;
	name=&quot;action&quot;
	value=&quot;Update&quot;
	tabindex=&quot;9&quot;&gt;&lt;/td&gt;
</pre>
</li>
<li>
   Save the file and run it in your browser.
</li>
</ol>
<h4><a name="wp1117888"></a>Reviewing the code</h4>
<p>The following table describes the code:</p>
<table border="0" cellpadding="0" cellspacing="0">
  <tr>
    <th>
Code
    </th>
    <th>
Description
    </th>
  </tr>
  <tr>
    <td>
<pre>&lt;cfelseif Form.action is &quot;Update&quot;&gt;
   &lt;cfset attributelist=&quot;cn=#Trim<br />      (form.FullName)#; <br />      sn=#Trim(Form.surname)#;<br />      mail=#Trim(Form.email)#; <br />      telephonenumber=#Trim(Form.phone)#&quot;&gt;
   &lt;cfldap action=&quot;modify&quot;
         modifytype=&quot;replace&quot;
         attributes=&quot;#attributeList#&quot;
            dn=&quot;uid=#Trim(Form.UID)#,<br />            ou=People, o=Airius.com&quot;
         server=#myServer#
         username=#myUserName#
         password=#myPassword#&gt;   
      &lt;cfoutput&gt;&lt;h3&gt;Entry for User ID<br />         #Form.UID# has been updated&lt;/h3&gt;<br />      &lt;/cfoutput&gt;
</pre>    </td>
    <td>
<p>If the user clicks Update, sets the attribute list to the form field values and replaces the attributes for the entry with the specified UID.</p>
<p>Displays a message to indicate that the entry was updated.</p>
<p>This code replaces <i>all</i> of the attributes in a form, without checking whether they are blank. A more complete example would check for blank fields and either require entered data or not include the corresponding attribute in the <code>attributes</code> string.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<pre>&amp;nbsp
&lt;input type=&quot;Submit&quot;
   name=&quot;action&quot;
   value=&quot;Update&quot;
   tabindex=&quot;9&quot;&gt;&lt;/td&gt;
</pre>    </td>
    <td>
<p>Defines the Submit button for the update action.</p>
    </td>
  </tr>
</table>



<hr />
<p align="right"><p align="right"><a href="00001292.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001294.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<p><a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00001293.htm" target="mm_window">View comments in LiveDocs</a></p>
 </body>
</html>



