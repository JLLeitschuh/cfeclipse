<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="Content-Style-Type" content="text/css">
   <script src="pages.js" type="text/javascript" language="Javascript1.2" charset="UTF-8"></script>
   <title>About persistent scope variables</title>
</head>
<body>
<p align="right"><p align="right"><a href="00001147.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001149.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<hr />
<h1>About persistent scope variables</h1>
<p>ColdFusion&#160;MX provides four variable scopes, described in the following table, that let you maintain data that must be available to multiple applications or users or must last beyond the scope of the current request.</p>
<table border="0" cellpadding="0" cellspacing="0">
  <tr>
    <th>
Variable scope
    </th>
    <th>
Description
    </th>
  </tr>
  <tr>
    <td>
<p>Client </p>
    </td>
    <td>
<p>Contains variables that are available for a single client browser over multiple browser sessions in an application. For information about browser sessions, see, <a href="00001156.htm#1205270">What is a session?</a>.</p>
<p>Useful for client-specific information, such as client preferences, that you want to store for a significant period of time.</p>
<p>Data is stored as cookies, database entries, or Registry values. Client variables can time out after an extended period. </p>
<p>Although do not have to use the Client scope prefix in the variable name, code that uses the prefix is more efficient and easier to maintain.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>Session </p>
    </td>
    <td>
<p>Contains variables that are available for a single client browser for a single browser session in an application. </p>
<p>Useful for client-specific information, such as shopping cart contents, that you want to persist while the client is visiting your application.</p>
<p>Data is stored in memory and times out after a period of inactivity or when the server shuts down. </p>
<p>ColdFusion&#160;MX Administrator lets you select between two kinds of session management, Standard ColdFusion Session management and J2EE session management. For information about types of session management, see <a href="00001156.htm#1162204">ColdFusion and J2EE session management</a>.</p>
<p>You must use the Session scope prefix in the variable name.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>Application </p>
    </td>
    <td>
<p>Contains variables that are available to all pages in an application for all clients. </p>
<p>Useful for application-specific information, such as contact information, that can vary over time and should be stored in a variable.</p>
<p>Data is stored in memory and times out after a period of inactivity or when the server shuts down.</p>
<p>You must use the Application scope prefix in the variable name.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>Server </p>
    </td>
    <td>
<p>Contains variables that are available to all applications in a server and all clients. </p>
<p>Useful for information that applies to all pages on the server, such as an aggregate page-hit counter.</p>
<p>Data is stored in memory. The variables do not time out, but you can delete variables you create, and all server variables are automatically deleted when the server stops running.</p>
<p>You must use the Server scope prefix in the variable name.</p>
    </td>
  </tr>
</table>

<p>The following sections provide information that is common to all or several of these variables. Later sections describe how to use the Client, Session, Application, and Server scopes in your applications, and provide detailed information about locking code.</p>
<h2><a name="wp1159639"></a>ColdFusion persistent variables and ColdFusion structures</h2>
<p>All persistent scopes are available as ColdFusion structures. As a result, you can use ColdFusion structure functions to access and manipulate Client, Session, Application, and Server scope contents. This chapter does not cover using these functions in detail, but does mention features or limitations that apply to specific scopes.</p>
<p><strong>Note: </strong>Although you can use the <a href="00000634.htm#137053"><code>StructClear</code></a> function to clear your data from the Server scope, the function does not delete the names of the variables, only their values, and it does not delete the contents of the Server.os and Server.ColdFusion structures. Using the <code>StructClear</code> function to clear the Session, or Application scope clears the entire scope, including the built-in variables. Using the <code>StructClear</code> function to clear the Client scope clears the variables from the server memory, but does not delete the stored copies of the variables.</p><h2><a name="wp1165941"></a>ColdFusion persistent variable issues</h2>
<p>Variables in the Session, Application, and Server scopes are kept in ColdFusion server memory. This storage method has several implications:</p>
<ul>
<li>
   All variables in these scopes are lost if the server stops running.
</li>
<li>
   Variables in these scopes are not shared by servers in a cluster.
</li>
<li>
   To prevent race conditions and ensure data consistency, lock access to all code that changes variables in these scopes or reads variables in these scopes with values that can change.
</li>
</ul>
<p><strong>Note: </strong>If you use J2EE session management and configure the J2EE server to retain session data between server restarts, ColdFusion retains session variables between server restarts.</p><p>Additionally, you must be careful when using client variables in a server cluster, where an application can run on multiple servers.</p>
<h3><a name="wp1212404"></a>Locking memory variables</h3>
<p>Because ColdFusion is a multithreaded system in which multiple requests can share Session, Application, and Server scope variables, it is possible for two or more requests to try to access and modify data at the same time. ColdFusion runs in a J2EE environment, which prevents simultaneous data access, so multiple requests do not cause severe system errors. However, such requests can result in inconsistent data values, particularly when a page might change more than one variable.</p>
<p>To prevent data errors with session, application, and server variables, lock code that writes and reads data in these scopes. For more information, see <a href="00001166.htm#1154837">Locking code with cflock</a>.</p>
<h3><a name="wp1165648"></a>Using variables in clustered systems</h3>
<p>Because memory variables are stored in memory, they are not available to all servers in a cluster. As a result, you generally do not use Session, Application, or Server scope variables in clustered environment. However, you might use these scope variables in a clustered system in the following circumstances: </p>
<ul>
<li>
   If the clustering system supports &quot;sticky&quot; sessions, in which the clustering system ensures that each user session remains on a single server. In this case, you can use session variables as you would on a single server.
</li>
<li>
   You can use Application and Server scope variables in a cluster for write-once variables that are consistently set, for example, from a database.
</li>
</ul>
<p>To use client variables on a clustered system, store the variables as cookies or in a database that is available to all servers. If you use database storage, on one server only, select the Purge Data for Clients that Remain Unvisited option on the Client Variables, Add/Edit Client Store page in the Server Settings area in the ColdFusion&#160;MX Administrator.</p>
<p>For more information on using client and session variables in clustered systems, see <a href="00001153.htm#1167915">Managing client identity information in a clustered environment</a>.</p>


<hr />
<p align="right"><p align="right"><a href="00001147.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001149.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<p><a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00001148.htm" target="mm_window">View comments in LiveDocs</a></p>
 </body>
</html>



