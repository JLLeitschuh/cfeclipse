<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="Content-Style-Type" content="text/css">
   <script src="pages.js" type="text/javascript" language="Javascript1.2" charset="UTF-8"></script>
   <title>Using unions</title>
</head>
<body>
<p align="right"><p align="right"><a href="00001267.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001269.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<hr />
<h1>Using unions</h1>
<p>The UNION operator lets you combine the results of two or more SELECT expressions into a single record set. The original tables must have the same number of columns, and corresponding columns must be UNION-compatible data types. Columns are UNION-compatible data types if they meet one of the following conditions:</p>
<ul>
<li>
   The same data type; for example, both Tinyint
</li>
<li>
   Both Numeric; for example, Tinyint, Smallint, Integer, Bigint, Double, Float, Real, Decimal, or Numeric
</li>
<li>
   Both Characters; for example, Char, Varchar, or LongVarchar
</li>
<li>
   Both Dates; for example, Time, TimeStamp, or Date
</li>
</ul>
<p><strong>Note: </strong>Query Of Queries does not support ODBC-formatted dates and times.</p><h4><a name="wp1157911"></a>Syntax</h4>
<pre>select_expression = select_expression UNION [ALL] select_expression
</pre><h4><a name="wp1138210"></a>Example</h4>
<p>This example uses the following tables:</p>
<table border="0" cellpadding="0" cellspacing="0">
  <tr>
    <th colspan="2" rowspan="1">
Table1
    </th>
  </tr>
  <tr>
    <td>
<p>Type(int)</p>
    </td>
    <td>
<p>Name(varchar)</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>1</p>
    </td>
    <td>
<p>Tennis</p>
    </td>
  </tr>
  <tr>
    <td>
<p>2 </p>
    </td>
    <td>
<p>Baseball</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>3</p>
    </td>
    <td>
<p>Football</p>
    </td>
  </tr>
</table>

<table border="0" cellpadding="0" cellspacing="0">
  <tr>
    <th colspan="2" rowspan="1">
Table2
    </th>
  </tr>
  <tr>
    <td>
<p>ID(int)</p>
    </td>
    <td>
<p>Sport(varchar)</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>3</p>
    </td>
    <td>
<p>Football</p>
    </td>
  </tr>
  <tr>
    <td>
<p>4</p>
    </td>
    <td>
<p>Volleyball</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>5</p>
    </td>
    <td>
<p>PingPong</p>
    </td>
  </tr>
</table>

<p>To combine Table1 and Table2, use a UNION statement, as follows:</p>
<pre>SELECT * FROM Table1 
UNION 
SELECT * FROM Table2 
</pre><p>The UNION statement produces the following result (UNION) table:</p>
<table border="0" cellpadding="0" cellspacing="0">
  <tr>
    <th colspan="2" rowspan="1">
Result table
    </th>
  </tr>
  <tr>
    <td>
<p>Type(int)</p>
    </td>
    <td>
<p>Name(varchar)</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>1</p>
    </td>
    <td>
<p>Tennis</p>
    </td>
  </tr>
  <tr>
    <td>
<p>2 </p>
    </td>
    <td>
<p>Baseball</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>3</p>
    </td>
    <td>
<p>Football</p>
    </td>
  </tr>
  <tr>
    <td>
<p>4</p>
    </td>
    <td>
<p>Volleyball</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>5</p>
    </td>
    <td>
<p>PingPong</p>
    </td>
  </tr>
</table>

<h3><a name="wp1138767"></a>Using aliases for column names</h3>
<p>The column names of a UNION table are the column names in the result set of the first SELECT statement in the UNION operation; ColdFusion ignores the column names in the other SELECT statement. To change the column names of the result table, you can use an alias, as follows:</p>
<pre>Select Type <code><strong>as SportType</strong></code>, Name<code><strong> as SportName</strong></code> from Table1
UNION
Select * from Table2
</pre><h3><a name="wp1149879"></a>Duplicate rows and multiple tables</h3>
<p>By default, the UNION operator removes duplicate rows from the result table. If you use the keyword ALL, then duplicates are included.</p>
<p>You can combine an unlimited number of tables using the UNION operator, for example: </p>
<pre>Select * from Table1
UNION 
Select * from Table2
UNION 
Select * from Table3
... 
</pre><h3><a name="wp1149890"></a>Parentheses and evaluation order</h3>
<p>By default, the Query of Queries SQL engine evaluates a statement containing UNION operators from left to right. You can use parentheses to change the order of evaluation. For example, the following two statements are different: </p>
<pre>/* First statement. */ 
SELECT * FROM TableA
UNION ALL 
<code><strong>(SELECT * FROM TableB </strong></code>
<code><strong>UNION </strong></code>
<code><strong>SELECT * FROM TableC</strong></code>
<code><strong>) </strong></code>

/* Second statement. */ 
<code><strong>(SELECT * FROM TableA </strong></code>
<code><strong>UNION ALL </strong></code>
<code><strong>SELECT * FROM TableB </strong></code>
<code><strong>) </strong></code>
UNION 
SELECT * FROM TableC 
</pre><p>In the first statement, there are no duplicates in the union between TableB and TableC. Then, in the union between that set and TableA, the ALL keyword includes the duplicates. In the second statement, duplicates are included in the union between TableA and TableB but are eliminated in the subsequent union with TableC. The ALL keyword has no effect on the final result of this expression. </p>
<h3><a name="wp1149914"></a>Using other keywords with UNION</h3>
<p>When you perform a UNION, the individual SELECT statements cannot have their own ORDER BY or COMPUTE clauses. You can only have one ORDER BY or COMPUTE clause after the last SELECT statement; this clause is applied to the final, combined result set. You can only specify GROUP BY and HAVING expressions in the individual SELECT statements. </p>


<hr />
<p align="right"><p align="right"><a href="00001267.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001269.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<p><a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00001268.htm" target="mm_window">View comments in LiveDocs</a></p>
 </body>
</html>



