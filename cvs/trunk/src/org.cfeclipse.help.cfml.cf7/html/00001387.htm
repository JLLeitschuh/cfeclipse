<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="Content-Style-Type" content="text/css">
   <script src="pages.js" type="text/javascript" language="Javascript1.2" charset="UTF-8"></script>
   <title>Validating data with the IsValid function and the cfparam tag</title>
</head>
<body>
<p align="right"><p align="right"><a href="00001386.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001388.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<hr />
<h1>Validating data with the IsValid function and the cfparam tag</h1>
<p>The <code>IsValid</code> function and <code>cfparam</code> tag validate any ColdFusion&#160;MX variable value, not just forms variables. Because they reside entirely on the ColdFusion server, they can provide a secure mechanism for ensuring that the required validation steps get performed. Users cannot evade any of the checks by modifying the form data that gets submitted. These techniques also provide greater flexibility in how you respond to user errors, because you can use full CFML syntax in your error-handling code.</p>
<p>These two validation techniques operate as follows:</p>
<ul>
<li>
   The <code>IsValid</code> function tests the value of a ColdFusion variable. If the value is valid, it returns True; if the value is invalid, it returns False.
</li>
<li>
   The <code>cfparam</code> tag with a <code>type</code> attribute tests the value of a ColdFusion value for validity. If the value is valid, it does nothing; if the value is invalid, it throws a ColdFusion expression exception.
</li>
</ul>
<p>You can use either technique interchangeably. The one you choose should depend on your coding style and programming practices. It can also depend on the specific information that you want to display if an error occurs.</p>
<h2><a name="wp1148212"></a>Example: IsValid function validation</h2>
<p>The following example checks whether a user has submitted a numeric ID and a valid e-mail address and phone number. If any of the submitted values does not meet the validation test, the page displays an error message.</p>
<pre>&lt;!--- Action code. First make sure the form was submitted. ---&gt;
&lt;cfif isDefined(&quot;form.saveSubmit&quot;)&gt;
   &lt;cfif isValid(&quot;integer&quot;, form.UserID) and isValid(&quot;email&quot;, form.emailAddr) 
         and isValid(&quot;telephone&quot;, form.phoneNo)&gt;
      &lt;cfoutput&gt;
         &lt;!--- Application code to update the database goes here ---&gt;
         &lt;h3&gt;The e-mail address and phone number for user #Form.UserID# 
            have been added&lt;/h3&gt;
      &lt;/cfoutput&gt;
   &lt;cfelse&gt;
      &lt;H3&gt;Please enter a valid user ID, phone number, and e-mail address.&lt;/H2&gt;
   &lt;/cfif&gt;
   &lt;cfelse&gt;
&lt;/cfif&gt;

&lt;!--- The form. ---&gt;
&lt;cfform action=&quot;#CGI.SCRIPT_NAME#&quot;&gt;
   User ID:&lt;cfinput type=&quot;Text&quot; name=&quot;UserID&quot;&gt;&lt;br&gt;
   Phone: &lt;cfinput type=&quot;Text&quot; name=&quot;phoneNo&quot;&gt;&lt;br&gt;
   E-mail: &lt;cfinput type=&quot;Text&quot; name=&quot;emailAddr&quot;&gt;&lt;br&gt;
   &lt;cfinput type=&quot;submit&quot; name=&quot;saveSubmit&quot; value=&quot;Save Data&quot;&gt;&lt;br&gt;
&lt;/cfform&gt;
</pre><h2><a name="wp1152094"></a>Examples: cfparam tag validation</h2>
<p>The following two examples use <code>cfparam</code> tags to do the same tests as in the <a href="00001387.htm#1148212">Example: IsValid function validation</a>. They check whether a user has submitted a numeric ID and a valid e-mail address and phone number. If any of the submitted values does not meet the validation test, ColdFusion throws an expression exception.</p>
<p>In the first example, the error is handled by the exprerr.cfm page specified in the <code>cferror</code> tag. In this case, if the user made multiple errors, ColdFusion lists only one.</p>
<p>In the second example, each invalid field is handled in a separate try/catch block. In this case, the user gets information about each error.</p>
<h4><a name="wp1152241"></a>Using an error-handling page</h4>
<p>The self-posting form and action page looks as follows:</p>
<pre>&lt;!--- Action part of the page. ---&gt;
&lt;!--- If an expression exception occurs, run the expresser.cfm page. ---&gt;
&lt;cferror type=&quot;EXCEPTION&quot; exception=&quot;expression&quot; template=&quot;expresserr.cfm&quot;&gt;
&lt;!--- Make sure the form was submitted. ---&gt;
&lt;cfif isDefined(&quot;form.saveSubmit&quot;)&gt;
&lt;!--- Use cfparam tags to check the form field data types. ---&gt;
      &lt;cfparam name=&quot;form.emailAddr&quot; type=&quot;email&quot;&gt;
      &lt;cfparam name=&quot;form.UserID&quot; type=&quot;integer&quot;&gt;
      &lt;cfparam name=&quot;form.phoneNo&quot; type=&quot;telephone&quot;&gt;
   &lt;!--- Application code to update the database goes here. ---&gt;
   &lt;cfoutput&gt;
      &lt;h3&gt;The e-mail address and phone number for user #Form.UserID# 
         have been added&lt;/h3&gt;
   &lt;/cfoutput&gt;
&lt;/cfif&gt;

&lt;!--- The form. ---&gt;
&lt;cfform action=&quot;#CGI.SCRIPT_NAME#&quot;&gt;
   User ID:&lt;cfinput type=&quot;Text&quot; name=&quot;UserID&quot;&gt;&lt;br&gt;
   Phone: &lt;cfinput type=&quot;Text&quot; name=&quot;phoneNo&quot;&gt;&lt;br&gt;
   E-mail: &lt;cfinput type=&quot;Text&quot; name=&quot;emailAddr&quot;&gt;&lt;br&gt;
   &lt;cfinput type=&quot;submit&quot; name=&quot;saveSubmit&quot; value=&quot;Save Data&quot;&gt;&lt;br&gt;
&lt;/cfform&gt;
</pre><p>The expresserr.cfm page looks as follows:</p>
<pre>&lt;cfoutput&gt;
   You entered invalid data.&lt;br&gt;
   Please click the browser Back button and try again&lt;br&gt;
   #cferror.RootCause.detailMessage#
&lt;/cfoutput&gt;
</pre><h4><a name="wp1152314"></a>Using cftry and cfcatch tags</h4>
<p>The self-posting form and action page looks as follows:</p>
<pre>&lt;!--- Use a Boolean variable to indicate whether all fields are good. ---&gt;
&lt;cfset goodData=&quot;Yes&quot;&gt;
&lt;!--- Make sure the form was submitted. ---&gt;
&lt;cfif isDefined(&quot;form.saveSubmit&quot;)&gt;
&lt;!--- The cftry block for testing the User ID value. ---&gt;
   &lt;cftry&gt;
&lt;!--- The cfparam tag checks the field data types. ---&gt;
      &lt;cfparam name=&quot;form.UserID&quot; type=&quot;integer&quot;&gt;
&lt;!--- If the data is invalid, ColdFusion throws an expression exception. ---&gt;
&lt;!--- Catch and handle the exception. ---&gt;
      &lt;cfcatch type=&quot;expression&quot;&gt;
         &lt;!--- Set the data validity indicator to False. ---&gt;
         &lt;cfset goodData=&quot;No&quot;&gt;
         &lt;cfoutput&gt;
            Invalid user ID.&lt;br&gt;
            #cfcatch.detail#&lt;br&gt;&lt;br&gt;
         &lt;/cfoutput&gt;
      &lt;/cfcatch&gt;
   &lt;/cftry&gt;
&lt;!--- The cftry block for testing the e-mail address value. ---&gt;
   &lt;cftry&gt;
      &lt;cfparam name=&quot;form.emailAddr&quot; type=&quot;email&quot;&gt;
      &lt;cfcatch type=&quot;expression&quot;&gt;
         &lt;cfset goodData=&quot;No&quot;&gt;
         &lt;cfoutput&gt;
            Invalid e-mail address.&lt;br&gt;
            #cfcatch.detail#&lt;br&gt;&lt;br&gt;   
         &lt;/cfoutput&gt;
      &lt;/cfcatch&gt;
   &lt;/cftry&gt;
&lt;!--- The cftry block for testing the telephone number value. ---&gt;
   &lt;cftry&gt;
      &lt;cfparam name=&quot;form.phoneNo&quot; type=&quot;telephone&quot;&gt;
      &lt;cfcatch type=&quot;expression&quot;&gt;
         &lt;cfset goodData=&quot;No&quot;&gt;
         &lt;cfoutput&gt;
            Invalid telephone number.&lt;br&gt;
            #cfcatch.detail#&lt;br&gt;&lt;br&gt;   
         &lt;/cfoutput&gt;
      &lt;/cfcatch&gt;
   &lt;/cftry&gt;
   &lt;!--- Do this only if the validity indicator was not set to False in a 
         validation catch block. ---&gt;
   &lt;cfif goodData&gt;
      &lt;!--- Application code to update the database goes here. ---&gt;
      &lt;cfoutput&gt;
         &lt;h3&gt;The e-mail address and phone number for user #Form.UserID# 
            have been added&lt;/h3&gt;
      &lt;/cfoutput&gt;
   &lt;/cfif&gt; &lt;!--- goodData is True---&gt;
&lt;/cfif&gt; &lt;!--- Form was submitted. ---&gt;

&lt;cfform action=&quot;#CGI.SCRIPT_NAME#&quot; preservedata=&quot;Yes&quot;&gt;
   User ID:&lt;cfinput type=&quot;Text&quot; name=&quot;UserID&quot;&gt;&lt;br&gt;
   Phone: &lt;cfinput type=&quot;Text&quot; name=&quot;phoneNo&quot;&gt;&lt;br&gt;
   E-mail: &lt;cfinput type=&quot;Text&quot; name=&quot;emailAddr&quot;&gt;&lt;br&gt;
   &lt;cfinput type=&quot;submit&quot; name=&quot;saveSubmit&quot; value=&quot;Save Data&quot;&gt;&lt;br&gt;
&lt;/cfform&gt;
</pre>

<hr />
<p align="right"><p align="right"><a href="00001386.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001388.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<p><a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00001387.htm" target="mm_window">View comments in LiveDocs</a></p>
 </body>
</html>



