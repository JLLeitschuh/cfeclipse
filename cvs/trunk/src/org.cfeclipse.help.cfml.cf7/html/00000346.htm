<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="Content-Style-Type" content="text/css">
   <script src="pages.js" type="text/javascript" language="Javascript1.2" charset="UTF-8"></script>
   <title>cftransaction</title>
</head>
<body>
<p align="right"><p align="right"><a href="00000345.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00000347.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<hr />
<h1>cftransaction</h1>
<h4><a name="wp1355939"></a>Description</h4>
<p>For enterprise database management systems that support transaction processing, instructs the database management system to treat multiple database operations as a single transaction. Provides database commit and rollback processing. See the documentation for your database management system to determine whether it supports SQL transaction processing.</p>
<h4><a name="wp1962501"></a>Category</h4>
<p><a href="00000198.htm#2459589">Database manipulation tags</a></p>
<h4><a name="wp1104166"></a>Syntax</h4>
<pre>&lt;cftransaction <br />   action = &quot;begin&quot; or &quot;commit&quot; or &quot;rollback&quot;<br />   isolation = &quot;read_uncommitted&quot; or &quot;read_committed&quot; or <br />      &quot;repeatable_read&quot; &gt;
&lt;/cftransaction&gt;
</pre><h4><a name="wp1962502"></a>See also</h4>
<p><a href="00000280.htm#1100472">cfinsert</a>, <a href="00000313.htm#1102102">cfprocparam</a>, <a href="00000314.htm#1102246">cfprocresult</a>, <a href="00000316.htm#1102316">cfquery</a>, <a href="00000317.htm#1102474">cfqueryparam</a>, <a href="00000338.htm#2607555">cfstoredproc</a>, <a href="00000350.htm#1104662">cfupdate</a>; <a href="00001234.htm#1115469">Commits, rollbacks, and transactions</a> in <a href="00001230.htm#1100400">Introduction to Databases and SQL</a> in <i>ColdFusion MX Developer's Guide</i></p>
<h4><a name="wp1429241"></a>Attributes</h4>
<table border="0" cellpadding="0" cellspacing="0">
  <tr>
    <th>
Attribute
    </th>
    <th>
Req/Opt
    </th>
    <th>
Default
    </th>
    <th>
Description
    </th>
  </tr>
  <tr>
    <td>
<p>action</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>begin</p>
    </td>
    <td>
<ul>
<li>
   begin: the start of the block of code to execute.
</li>
<li>
   commit: commits a pending transaction.
</li>
<li>
   rollback: rolls back a pending transaction.
</li>
</ul>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>isolation</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>ODBC lock type: </p>
<ul>
<li>
   read_uncommitted: reads without regard for other transactions that are taking place. Sometimes called a 'dirty read' because data that is read can be in a transitional state and therefore not accurate.
</li>
<li>
   read_committed: uses shared locks to assure that no other transaction modifies rows that this transaction uses.
</li>
<li>
   repeatable_read: same as read_committed, except that rows in the recordset are exclusively locked until the transaction completes. Due to high overhead, Macromedia does not recommend this isolation level for normal database access.
</li>
<li>
   serializable: places an exclusive lock on every data table in use for the duration of the transaction. Causes access to the database to be single-threaded and is therefore not recommended for normal database access.
</li>
</ul>
    </td>
  </tr>
</table>

<h4><a name="wp2806730"></a>Usage</h4>
<p>If you do not specify a value for the <code>action</code> attribute, automatic transaction processing proceeds as follows:</p>
<ul>
<li>
   If the <code>cfquery</code> operations within the transaction block complete without an error, the transaction is committed.
</li>
<li>
   If a <code>cfquery</code> tag generates an error within a <code>cftransaction</code> block, all <code>cfquery</code> operations in the transaction roll back.
</li>
</ul>
<p>If you do not specify a value for the <code>isolation</code> attribute, ColdFusion uses the default isolation level for the associated database.</p>
<p>Using CFML error handling and the <code>action</code> attribute, however, you can also explicitly control whether a transaction is committed or rolled back, based on the success or failure of the database query. Within a transaction block, you can do the following:</p>
<ul>
<li>
   Commit a database transaction by nesting the <code>&lt;cftransaction action = &quot;commit&quot;/&gt;</code> tag within the block
</li>
<li>
   Roll back a transaction by nesting the <code>&lt;cftransaction action = &quot;rollback&quot;/&gt;</code> tag within the block 
</li>
</ul>
<p>(In these examples, the slash is alternate syntax that is the equivalent of an end tag.)</p>
<p>Within a transaction block, you can write queries to more than one database, but you must commit or roll back a transaction to one database before writing a query to another. </p>
<p>To control how the database engine performs locking during the transaction, use the <code>isolation</code> attribute. </p>
<h4><a name="wp1104188"></a>Example</h4>
<pre>&lt;p&gt;CFTRANSACTION can be used to group multiple queries that use CFQUERY
into one business event. Changes to data that is requested by the queries
are not committed to the datasource until all actions within the transaction 
block have executed successfully.
&lt;p&gt;This a view-only example. 
&lt;!--- 
&lt;cftransaction&gt;
   &lt;cfquery name=&#39;makeNewCourse&#39; datasource=&#39;Snippets&#39;&gt;
   INSERT INTO Courses
      (Number, Descript)
   VALUES
      (&#39;#myNumber#&#39;, &#39;#myDescription#&#39;)
   &lt;/cfquery&gt;

   &lt;cfquery name=&#39;insertNewCourseToList&#39; datasource=&#39;Snippets&#39;&gt;
   INSERT INTO CourseList
      (CorNumber, CorDesc, Dept_ID,
      CorName, CorLevel, LastUpdate)
   VALUES
      (&#39;#myNumber#&#39;, &#39;#myDescription#&#39;, &#39;#myDepartment#&#39;,
      &#39;#myDescription#&#39;, &#39;#myCorLevel#&#39;, #Now()#)
   &lt;/cfquery&gt;
&lt;/cftransaction&gt; 
---&gt;
</pre>

<hr />
<p align="right"><p align="right"><a href="00000345.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00000347.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<p><a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00000346.htm" target="mm_window">View comments in LiveDocs</a></p>
 </body>
</html>



