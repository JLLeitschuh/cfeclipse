<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="Content-Style-Type" content="text/css">
   <script src="pages.js" type="text/javascript" language="Javascript1.2" charset="UTF-8"></script>
   <title>Putting executable code in a separate file</title>
</head>
<body>
<p align="right"><p align="right"><a href="00001028.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001030.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<hr />
<h1>Putting executable code in a separate file</h1>
<p>You can put executable code in a separate file from the main component definition page. By placing the method execution code in a separate file, you can separate property initialization code, meta information, and the method definition shell from the executable method definition code. This technique lets you modularize your code and helps prevent CFML pages from getting too long and complex.</p>
<p>To separate the component method code, use a <a href="00000277.htm#1100248"><code>cfinclude</code></a> tag on the component definition page to call the page that contains the component method code. </p>
<p><strong>Note: </strong>If your method takes arguments or returns data to the page that invokes it, the <a href="00000218.htm#2855190"><code>cfargument</code></a> tag and the <a href="00000326.htm#2498057"><code>cfreturn</code></a> tag must be on the component definition page, not on the included page. </p><h4>To create a component method using the cfinclude tag:</h4>
<ol>
<li>
   Create a tellTime.cfc file with the following code:
<pre>
&lt;cfcomponent&gt;
	&lt;cffunction name=&quot;getUTCTime&quot;&gt;
		&lt;cfinclude template=&quot;getUTCTime.cfm&quot;&gt;
	&lt;cfreturn utcStruct.Hour &amp; &quot;:&quot; &amp; utcStruct.Minute&gt;
	&lt;/cffunction&gt;
&lt;/cfcomponent&gt;
</pre>
</li>
<li>
   Create a ColdFusion page with the following code, and save it as getUTCTime.cfm in the same directory as tellTime.cfc:
<pre>
&lt;cfscript&gt;
	serverTime=now();
	utcTime=GetTimeZoneInfo();
	utcStruct=structNew();
	utcStruct.Hour=DatePart(&quot;h&quot;, serverTime);
	utcStruct.Minute=DatePart(&quot;n&quot;, serverTime);
	utcStruct.Hour=utcStruct.Hour + utcTime.utcHourOffSet;
	utcStruct.Minute=utcStruct.Minute + utcTime.utcMinuteOffSet;
	if (utcStruct.Minute LT 10)
		utcStruct.Minute = &quot;0&quot; &amp; utcStruct.Minute;
&lt;/cfscript&gt;
</pre>
<p>In the example, the <code>getUTCTime</code> method definition calls the getUTCTime.cfm file with the <a href="00000277.htm#1100248"><code>cfinclude</code></a> tag. The getUTCTime.cfm code calculates the UTC time representation of the current time and populates a structure with hour and minute values. The method in tellTime.cfc then uses the information in the structure to return the current UTC time as a string to the calling page. The included page must not include a <code>cfreturn</code> statement.</p>
</li>
</ol>


<hr />
<p align="right"><p align="right"><a href="00001028.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001030.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<p><a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00001029.htm" target="mm_window">View comments in LiveDocs</a></p>
 </body>
</html>



