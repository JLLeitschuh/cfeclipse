<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="Content-Style-Type" content="text/css">
   <script src="pages.js" type="text/javascript" language="Javascript1.2" charset="UTF-8"></script>
   <title>cfdocument</title>
</head>
<body>
<p align="right"><p align="right"><a href="00000235.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00000237.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<hr />
<h1>cfdocument</h1>
<h4><a name="wp3766063"></a>Description</h4>
<p>Creates PDF or FlashPaper output from a text block containing CFML and HTML.</p>
<h4><a name="wp3766074"></a>Category</h4>
<p><a href="00000199.htm#2459638">Data output tags</a></p>
<h4><a name="wp3765843"></a>Syntax</h4>
<pre>&lt;cfdocument <br />   format = &quot;PDF&quot; or &quot;FlashPaper&quot;<br />   filename = &quot;filename&quot;<br />   overwrite = &quot;yes&quot; or &quot;no&quot;<br />   name = &quot;output variable name&quot;<br />   pagetype = &quot;page type&quot;<br />   pageheight = &quot;page height in inches&quot;<br />   pagewidth = &quot;page width in inches&quot;<br />   orientation = &quot;portrait/landscape&quot;<br />   margintop = &quot;number&quot;<br />   marginbottom = &quot;number&quot;<br />   marginleft = &quot;number&quot;<br />   marginright = &quot;number&quot;<br />   unit = &quot;in&quot; or &quot;cm&quot;<br />   encryption = &quot;128-bit&quot; or &quot;40-bit&quot; or &quot;none&quot;<br />   ownerpassword = &quot;password&quot;<br />   userpassword = &quot;password&quot;<br />   permissions = &quot;permission list&quot;<br />   fontembed = &quot;yes&quot; or &quot;no&quot;<br />   backgroundvisible = &quot;yes&quot; or &quot;no&quot;<br />   scale = &quot;percentage less than 100&quot;&gt;

   <code><i>HTML and CFML code</i></code>
&lt;/cfdocument&gt;
</pre><h4><a name="wp3765845"></a>See also</h4>
<p><a href="00000323.htm#1102863"><code>cfreport</code></a><code>, </code><a href="00000237.htm#3766460">cfdocumentitem</a>, <a href="00000238.htm#3766659">cfdocumentsection</a></p>
<h4><a name="wp3765850"></a>History</h4>
<p>ColdFusion&#160;MX&#160;7: Added this tag.</p>
<h4><a name="wp3765868"></a>Attributes</h4>
<table border="0" cellpadding="0" cellspacing="0">
  <tr>
    <th>
Attribute
    </th>
    <th>
Req/Opt
    </th>
    <th>
Default
    </th>
    <th>
Description
    </th>
  </tr>
  <tr>
    <td>
<p>format</p>
    </td>
    <td>
<p>Required</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>Specifies the report format:</p>
<ul>
<li>
   PDF 
</li>
<li>
   FlashPaper
</li>
</ul>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>filename</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>Specifies the name of a file to contain the PDF or FlashPaper output.</p>
<p>If you omit the <code>filename</code> attribute, ColdFusion&#160;MX streams output to the browser.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>overwrite</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>no</p>
    </td>
    <td>
<p>Specifies whether ColdFusion&#160;MX overwrites an existing file. Used in conjunction with the <code>filename</code> attribute</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>name</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>Specifies the name of an existing variable into which the tag stores the PDF or FlashPaper output.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>pagetype</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>A4</p>
    </td>
    <td>
<p>Specifies the page size into which ColdFusion generates the report: </p>
<ul>
<li>
   legal: 8.5 inches x 14 inches.
</li>
<li>
   letter: 8.5 inches x 11 inches.
</li>
<li>
   A4: 8.27 inches x 11.69 inches.
</li>
<li>
   A5: 5.81 inches x 8.25 inches.
</li>
<li>
   B5: 9.81 inches x 13.88 inches.
</li>
<li>
   Custom: custom height and width. If you specify custom, you must also specify the <code>pageheight</code> and <code>pagewidth</code> attributes, can optionally specify margin attributes, and can optionally specify whether the units are inches or centimeters.
</li>
</ul>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>pageheight</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>Specifies the page height in inches (default) or centimeters. This attribute is only valid if <code>pagetype=custom</code>. To specify page height in centimeters, include the <code>unit=cm</code> attribute.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>pagewidth</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>Specifies the page width in inches (default) or centimeters. This attribute is only valid if <code>pagetype=custom</code>. To specify page width in centimeters, include the <code>unit=cm</code> attribute.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>orientation</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>portrait</p>
    </td>
    <td>
<p>Specifies the page orientation:</p>
<ul>
<li>
   portrait
</li>
<li>
   landscape
</li>
</ul>
    </td>
  </tr>
  <tr>
    <td>
<p>margintop</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>Specifies the top margin in inches (default) or centimeters. To specify the top margin in centimeters, include the <code>unit=cm</code> attribute.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>marginbottom</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>Specifies the bottom margin in inches (default) or centimeters. To specify the bottom margin in centimeters, include the <code>unit=cm</code> attribute.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>marginleft</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>Specifies the left margin in inches (default) or centimeters. To specify the left margin in centimeters, include the <code>unit=cm</code> attribute.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>marginright</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>Specifies the right margin in inches (default) or centimeters. To specify the right margin in centimeters, include the <code>unit=cm</code> attribute.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>unit</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>in</p>
    </td>
    <td>
<p>Specifies the default unit for the <code>pageheight</code>, <code>pagewidth</code>, and <code>margin</code> attributes:</p>
<ul>
<li>
   in: inches.
</li>
<li>
   cm: centimeters.
</li>
</ul>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>encryption</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>None</p>
    </td>
    <td>
<p>(<code>format=&quot;PDF&quot;</code> only) Specifies whether the output is encrypted:</p>
<ul>
<li>
   128-bit
</li>
<li>
   40-bit
</li>
<li>
   none
</li>
</ul>
    </td>
  </tr>
  <tr>
    <td>
<p>ownerpassword</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>(<code>format=&quot;PDF&quot;</code> only) Specifies an owner password.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>userpassword</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>(<code>format=&quot;PDF&quot;</code> only) Specifies a user password.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>permissions</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>&#160;</p>
    </td>
    <td>
<p>(<code>format=&quot;PDF&quot;</code> only) Specifies one or more of the following permissions:</p>
<ul>
<li>
   AllowPrinting
</li>
<li>
   AllowModifyContents
</li>
<li>
   AllowCopy
</li>
<li>
   AllowModifyAnnotations
</li>
<li>
   AllowFillIn
</li>
<li>
   AllowScreenReaders
</li>
<li>
   AllowAssembly
</li>
<li>
   AllowDegradedPrinting
</li>
</ul>
<p>Separate multiple permissions with a comma.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>fontembed</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>yes</p>
    </td>
    <td>
<p>Specifies whether ColdFusion embeds fonts in the output:</p>
<ul>
<li>
   yes: embed fonts.
</li>
<li>
   no: do not embed fonts.
</li>
</ul>
<p>Selective: embed all fonts except Java fonts and core fonts. For more information, see Usage.</p>
    </td>
  </tr>
  <tr>
    <td>
<p>backgroundvisible</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>no</p>
    </td>
    <td>
<p>Specifies whether the background prints when the user prints the document:</p>
<ul>
<li>
   yes: include the background when printing.
</li>
<li>
   no: do not include the background when printing.
</li>
</ul>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>scale</p>
    </td>
    <td>
<p>Optional</p>
    </td>
    <td>
<p>Calculated by ColdFusion</p>
    </td>
    <td>
<p>Specifies a scale factor as a percentage. Use this option to reduce the size of the HTML output so that it fits on that paper. Specify a number less than 100.</p>
    </td>
  </tr>
</table>

<h4><a name="wp3765945"></a>Usage</h4>
<p>Use the <code>cfdocument</code> tag to render HTML and CFML output into PDF or FlashPaper format. ColdFusion MX does not return HTML and CFML outside of the <br /><code>&lt;cfdocument&gt;</code> <code>&lt;/cfdocument&gt;</code> pair.</p>
<p>The <code>cfdocument</code> tag can render HTML that supports the following standards:</p>
<ul>
<li>
   HTML 4.01 
</li>
<li>
   XML 1.0 
</li>
<li>
   DOM Level 1 and 2 
</li>
<li>
   CSS1 and CSS2
</li>
</ul>
<p>The <code>cfdocument</code> tag does not support the Internet Explorer-specific HTML generated by Microsoft Word.</p>
<p>The PDF or FlashPaper document returned by the <code>cfdocument</code> tag overwrites any previous HTML in the input stream and ignores any HTML after the <code>&lt;/cfdocument&gt;</code> tag.</p>
<p>You cannot embed a <code>cfreport</code> tag in a <code>cfdocument</code> tag.</p>
<p>When you use the <code>cfdocument</code> tag, ColdFusion MX creates a new scope named cfdocument. This scope contains the following variables:</p>
<ul>
<li>
   currentpagenumber
</li>
<li>
   totalpagecount
</li>
</ul>
<p><strong>Note: </strong>The cfdocument scope variables are reserved for page number rendering. Do not use them in ColdFusion expressions. For example, the following code does not work:</p><pre>&lt;cfif cfdocument.currentpagenumber gt 1&gt;
   &lt;cfoutput&gt;#cfdocument.currentpagenumber-1#&lt;/cfoutput&gt;
&lt;/cfif&gt;
</pre><h4><a name="wp3765992"></a>Example</h4>
<pre>&lt;cfdocument format=&quot;flashpaper&quot;&gt;
&lt;p&gt;This is a document rendered by the cfdocument tag.&lt;/p&gt;

&lt;table width=&quot;50%&quot; border=&quot;2&quot; cellspacing=&quot;2&quot; cellpadding=&quot;2&quot;&gt;
  &lt;tr&gt;
    &lt;td&gt;&lt;strong&gt;Name&lt;/strong&gt;&lt;/td&gt;
    &lt;td&gt;&lt;strong&gt;Role&lt;/strong&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Bill&lt;/td&gt;
    &lt;td&gt;Lead&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Susan&lt;/td&gt;
    &lt;td&gt;Principal Writer&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Adelaide&lt;/td&gt;
    &lt;td&gt;Part Time Senior Writer&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Thomas&lt;/td&gt;
    &lt;td&gt;Full Time for 6 months&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Michael&lt;/td&gt;
    &lt;td&gt;Full Time for 4 months&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;
&lt;/cfdocument&gt; 
</pre>

<hr />
<p align="right"><p align="right"><a href="00000235.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00000237.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<p><a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00000236.htm" target="mm_window">View comments in LiveDocs</a></p>
 </body>
</html>



