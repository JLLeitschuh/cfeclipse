<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="Content-Style-Type" content="text/css">
   <script src="pages.js" type="text/javascript" language="Javascript1.2" charset="UTF-8"></script>
   <title>Report functions </title>
</head>
<body>
<p align="right"><p align="right"><a href="00001471.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001473.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<hr />
<h1>Report functions </h1>
<p>Report functions are user-defined CFML functions that you code using the Report Function Editor and invoke in report fields. You can use them to format data (such as concatenating and formatting all the field that make up an address), to retrieve data, and for many other purposes.</p>
<h4>To create a report function:</h4>
<ol>
<li>
   Select Report &gt; Report Functions from the menu bar.
<p>The Report Function Editor displays.</p>
</li>
<li>
   Click the plus sign to add a new report function.
<p>The Add Report Function dialog box displays.</p>
</li>
<li>
   Specify a name and click OK.
</li>
<li>
   The Report Function Editor places a <code>cfreturn</code> tag in the text entry area.
</li>
<li>
   Code the function. This is a ColdFusion user-defined function so all UDF rules and features are available for use. The following example show a report function that concatenates address fields:
<pre>
&lt;cfargument name=&quot;Name&quot; required=&quot;yes&quot;/&gt;
&lt;cfargument name=&quot;Address1&quot; required=&quot;yes&quot;/&gt;
&lt;cfargument name=&quot;Address2&quot; required=&quot;yes&quot;/&gt;
&lt;cfargument name=&quot;City&quot; required=&quot;yes&quot;/&gt;
&lt;cfargument name=&quot;State&quot; required=&quot;yes&quot;/&gt;
&lt;cfargument name=&quot;Zip&quot; required=&quot;yes&quot;/&gt;

&lt;cfset variables.CRLF = Chr(13) &amp; Chr(10)&gt;
&lt;cfset variables.ResultVar=&quot;&quot;&gt;

&lt;cfif Trim(arguments.Name) NEQ &quot;&quot;&gt;
&#160;&#160;&#160;&lt;cfset variables.ResultVar=&#39;#arguments.Name#&#39;&gt;
&lt;/cfif&gt;
&lt;cfif Trim(arguments.Address1) NEQ &quot;&quot;&gt;
&#160;&#160;&#160;&lt;cfif variables.ResultVar NEQ &quot;&quot;&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&lt;cfset variables.ResultVar=&#39;#variables.ResultVar &amp; variables.CRLF#&#39;&gt;
&#160;&#160;&#160;&lt;/cfif&gt;
&#160;&#160;&#160;&lt;cfset variables.ResultVar=&#39;#variables.ResultVar &amp; arguments.Address1#&#39;&gt;
&lt;/cfif&gt;
&lt;cfif Trim(arguments.Address2) NEQ &quot;&quot;&gt;
&#160;&#160;&#160;&lt;cfif variables.ResultVar NEQ &quot;&quot;&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&lt;cfset variables.ResultVar=&#39;#variables.ResultVar &amp; variables.CRLF#&#39;&gt;
&#160;&#160;&#160;&lt;/cfif&gt;
&#160;&#160;&#160;&lt;cfset variables.ResultVar=&#39;#variables.ResultVar &amp; arguments.Address2#&#39;&gt;
&lt;/cfif&gt;
&lt;cfif variables.ResultVar NEQ &quot;&quot;&gt;
&#160;&#160;&#160;&lt;cfset variables.ResultVar=&#39;#variables.ResultVar &amp; variables.CRLF#&#39;&gt;
&lt;/cfif&gt;

&lt;cfset variables.ResultVar=&#39;#variables.ResultVar &amp; arguments.City &amp; &quot;, &quot; &amp; 
arguments.State &amp; &quot; &quot; &amp; arguments.Zip#&#39;&gt;

&lt;cfreturn variables.ResultVar&gt;
</pre>
</li>
<li>
   Click OK when you are finished.
</li>
</ol>
<h4>To use a report function:</h4>
<ol>
<li>
   Place a dynamic field on the appropriate report band.
<p>The Add Field dialog box displays.</p>
</li>
<li>
   Specify Manually Entered Expression and click OK.
<p>The Expression Builder displays.</p>
</li>
<li>
   Specify &quot;report.<i>functionname</i>&quot;.
</li>
<li>
   Click OK.
</li>
</ol>
<h3><a name="wp134343"></a>Expressions and the Expression Builder</h3>
<p>Many elements of the Report Builder (including query fields, calculated fields, input parameters, images, and report object attributes) are single operand ColdFusion expressions. Because these elements are expressions, you can manipulate them with CFML functions.</p>
<p>The Expression Builder is a graphical interface that lets you quickly apply CFML functions to Report Builder elements. Uses for the Expression Builder include the following:</p>
<ul>
<li>
   Many of the report object attributes (such as PrintWhen) accept expressions, which you can associate with query parameters, input parameters, or ColdFusion page variables. You can tie report attributes and columns to display based on runtime data or user preference.
</li>
<li>
   Concatenating fields
</li>
<li>
   Formatting fields
</li>
<li>
   Calculated fields
</li>
<li>
   Accessing and displaying ColdFusion page variables and scopes
</li>
</ul>
<p>For information on using the Expression Builder, see Report Builder online Help.</p>
<p>For more information on expressions, see <a href="00000924.htm#2689636">Using Expressions and Number Signs</a>.</p>


<hr />
<p align="right"><p align="right"><a href="00001471.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001473.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<p><a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00001472.htm" target="mm_window">View comments in LiveDocs</a></p>
 </body>
</html>



