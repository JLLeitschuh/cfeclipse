<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="Content-Style-Type" content="text/css">
   <script src="pages.js" type="text/javascript" language="Javascript1.2" charset="UTF-8"></script>
   <title>Handling query results using UDFs</title>
</head>
<body>
<p align="right"><p align="right"><a href="00001017.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001019.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<hr />
<h1>Handling query results using UDFs</h1>
<p>When you call a UDF in the body of a tag that has a <code>query</code> attribute, such as a <a href="00000290.htm#3301338"><code>cfloop</code></a><code> query=...</code> tag, any function argument that is a query column name passes a single element of the column, not the entire column. Therefore, the function must manipulate a single query element. </p>
<p>For example, the following code defines a function to combine a single first name and last name to make a full name. It queries the cfdocexamples database to get the first and last names of all employees, and then it uses a <a href="00000309.htm#1101659"><code>cfoutput</code></a> tag to loop through the query and call the function on each row in the query.</p>
<pre>&lt;cfscript&gt;
function FullName(aFirstName, aLastName)
 { return aFirstName &amp; &quot; &quot; &amp; aLastName; }
&lt;/cfscript&gt;

&lt;cfquery name=&quot;GetEmployees&quot; datasource=&quot;cfdocexamples&quot;&gt; 
   SELECT FirstName, LastName
   FROM Employee
&lt;/cfquery&gt;

&lt;cfoutput query=&quot;GetEmployees&quot;&gt;
#FullName(FirstName, LastName)#&lt;br&gt;
&lt;/cfoutput&gt;
</pre><p>You generally use functions that manipulate many rows of a query <i>outside</i> tags that loop over queries. Pass the query to the function and loop over it inside the function. For example, the following function changes text in a query column to uppercase. It takes a query name as an argument.</p>
<pre>function UCaseColumn(myquery, colName)&#160;{
   var currentRow = 1;
   for (; currentRow lte myquery.RecordCount; <br />      currentRow = currentRow + 1)
   {
      myquery[colName][currentRow] =<br />         UCase(myquery[colName][currentRow]);
   }
   Return &quot;&quot;;
}
</pre><p>The following code uses a script that calls the <code>UCaseColumn</code> function to convert all the last names in the GetEmployees query to uppercase. It then uses <a href="00000309.htm#1101659"><code>cfoutput</code></a> to loop over the query and display the contents of the column.</p>
<pre>&lt;cfscript&gt;
   UCaseColumn(GetEmployees, &quot;LastName&quot;);
&lt;/cfscript&gt;
&lt;cfoutput query=&quot;GetEmployees&quot;&gt;
   #LastName#&lt;br&gt;
&lt;/cfoutput&gt;
</pre>

<hr />
<p align="right"><p align="right"><a href="00001017.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001019.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<p><a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00001018.htm" target="mm_window">View comments in LiveDocs</a></p>
 </body>
</html>



