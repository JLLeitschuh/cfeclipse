<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="Content-Style-Type" content="text/css">
   <script src="pages.js" type="text/javascript" language="Javascript1.2" charset="UTF-8"></script>
   <title>Indexing cfpop query results</title>
</head>
<body>
<p align="right"><p align="right"><a href="00001320.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001322.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<hr />
<h1>Indexing cfpop query results</h1>
<p>The contents of mail servers are generally volatile; specifically, the message number is reset as messages are added and deleted. To avoid mismatches between the unique message number identifiers on the server and in the Verity collection, you must re-index the collection before processing a search.</p>
<p>As with the other query types, you must provide a unique value for the <code>key</code> attribute and enter the data fields to index in the <code>body</code> attribute.</p>
<p>The following example updates the pop_query collection with the current mail for user1, and searches and returns the message number and subject line for all messages that contain the word <i>action</i>:</p>
<pre>&lt;!--- Run POP query. ---&gt;
&lt;cfpop action=&quot;getall&quot;
   name=&quot;p_messages&quot;
   server=&quot;mail.company.com&quot;
   userName=&quot;user1&quot;
   password=&quot;user1&quot;&gt;

&lt;!--- Output POP query record set. ---&gt;
&lt;cfoutput query=&quot;p_messages&quot;&gt;
   #messagenumber# &lt;br&gt;
   #from# &lt;br&gt;
   #to# &lt;br&gt;
   #subject# &lt;br&gt;
   #body# &lt;br&gt;
&lt;hr&gt;
&lt;/cfoutput&gt;

&lt;!--- Index record set. ---&gt;
&lt;cfindex action=&quot;refresh&quot;
   collection=&quot;pop_query&quot;
   key=&quot;messagenumber&quot;
   type=&quot;custom&quot;
   title=&quot;subject&quot;
   query=&quot;p_messages&quot;
   body=&quot;body&quot;&gt;

&lt;!--- Search messages for the word &quot;action&quot;. ---&gt;
&lt;cfsearch collection=&quot;pop_query&quot;
   name=&quot;s_messages&quot;
   criteria=&quot;action&quot;
   maxrows = &quot;100&quot;&gt;
   
&lt;!--- Output search record set. ---&gt;
&lt;cfoutput query=&quot;s_messages&quot;&gt;
   #key#, #title# &lt;br&gt;
&lt;/cfoutput&gt;

</pre>

<hr />
<p align="right"><p align="right"><a href="00001320.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001322.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<p><a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00001321.htm" target="mm_window">View comments in LiveDocs</a></p>
 </body>
</html>



