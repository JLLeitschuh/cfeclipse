<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="Content-Style-Type" content="text/css">
   <script src="pages.js" type="text/javascript" language="Javascript1.2" charset="UTF-8"></script>
   <title>Example: editing data in a grid</title>
</head>
<body>
<p align="right"><p align="right"><a href="00001368.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001370.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<hr />
<h1>Example: editing data in a grid</h1>
<p>The following example creates an editable grid. For code brevity, the example handles only three of the fields in the Employee table. A more realistic example would include, at a minimum, all seven table fields. It might also hide the contents of the Emp_ID column or display the Department name (from the Departmt table), instead of the Department ID.</p>
<h4>To create the editable grid:</h4>
<ol>
<li>
   Create a ColdFusion page with the following content: 
<pre>
&lt;cfquery name=&quot;empdata&quot; datasource=&quot;cfdocexamples&quot;&gt;
	SELECT * FROM Employee
&lt;/cfquery&gt;

&lt;cfform name=&quot;GridForm&quot;
	action=&quot;handle_grid.cfm&quot;&gt;

	&lt;cfgrid name=&quot;employee_grid&quot;
		height=425
		width=300
		vspace=10
		selectmode=&quot;edit&quot;
		query=&quot;empdata&quot;
		insert=&quot;Yes&quot;
		delete=&quot;Yes&quot;&gt;
		
		&lt;cfgridcolumn name=&quot;Emp_ID&quot;
			header=&quot;Emp ID&quot;
			width=50
			headeralign=&quot;center&quot;
			headerbold=&quot;Yes&quot;
			select=&quot;No&quot;&gt;

		&lt;cfgridcolumn name=&quot;LastName&quot;
			header=&quot;Last Name&quot;
			width=100
			headeralign=&quot;center&quot;
			headerbold=&quot;Yes&quot;&gt;

		&lt;cfgridcolumn name=&quot;Dept_ID&quot;
			header=&quot;Dept&quot;
			width=35
			headeralign=&quot;center&quot;
			headerbold=&quot;Yes&quot;&gt;

	&lt;/cfgrid&gt;
	&lt;br&gt;
	&lt;cfinput name=&quot;submitit&quot; type=&quot;Submit&quot; value=&quot;Submit&quot;&gt;
&lt;/cfform&gt;
</pre>
</li>
<li>
   Save the file as grid2.cfm.
</li>
<li>
   View the results in your browser.
<p>The following figure shows the output of this code:</p>
<p><br />
<img src="images/grid210.jpg" alt="Editable grid" border="0" hspace="0" vspace="0"/>
<br />
</p>
</li>
</ol>
<p>The following sections describe how to write the handle_grid.cfm page to process user edits to the grid. </p>
<h4><a name="wp1120988"></a>Reviewing the code</h4>
<p>The following table describes the code and its function:</p>
<table border="0" cellpadding="0" cellspacing="0">
  <tr>
    <th>
Code
    </th>
    <th>
Description
    </th>
  </tr>
  <tr>
    <td>
<pre>&lt;cfgrid name=&quot;employee_grid&quot;
   height=425
   width=300
   vspace=10
   selectmode=&quot;edit&quot;
   query=&quot;empdata&quot;
   insert=&quot;Yes&quot;
   delete=&quot;Yes&quot;&gt;
</pre>    </td>
    <td>
<p>Populates a <a href="00000266.htm#1836171"><code>cfgrid</code></a> control with data from the empdata query. Selecting a grid cell enables you to edit it. You can insert and delete rows. The grid is 425 X 300 pixels and has 10 pixels of space above and below it.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<pre>&lt;cfgridcolumn name=&quot;Emp_ID&quot;
   header=&quot;Emp ID&quot;
   width=50
   headeralign=&quot;center&quot;
   headerbold=&quot;Yes&quot;
   select=&quot;No&quot;&gt;
</pre>    </td>
    <td>
<p>Creates a 50-pixel wide column for the data in the Emp_ID column of the data source. Centers a header named Emp ID and makes it bold. </p>
<p>Does not allow users to select fields in this column for editing. Since this field is the table's primary key, users should not be able to change it for existing records, and the DBMS should generate this field as an autoincrement value.</p>
    </td>
  </tr>
  <tr>
    <td>
<pre>&lt;cfgridcolumn name=&quot;LastName&quot;
   header=&quot;Last Name&quot;
   width=100
   headeralign=&quot;center&quot;
   headerbold=&quot;Yes&quot;&gt;
</pre>    </td>
    <td>
<p>Creates a 100-pixel wide column for the data in the LastName column of the data source. Centers a header named Last Name and makes it bold. </p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<pre>&lt;cfgridcolumn name=&quot;Dept_ID&quot;
   header=&quot;Dept&quot;
   width=35
   headeralign=&quot;center&quot;
   headerbold=&quot;Yes&quot;&gt;
<code>&lt;/cfgrid&gt;</code>
</pre>    </td>
    <td>
<p>Creates a 35-pixel wide column for the data in the Dept_ID column of the data source. Centers a header named Dept and makes it bold. </p>
    </td>
  </tr>
</table>



<hr />
<p align="right"><p align="right"><a href="00001368.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001370.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<p><a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00001369.htm" target="mm_window">View comments in LiveDocs</a></p>
 </body>
</html>



