<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="Content-Style-Type" content="text/css">
   <script src="pages.js" type="text/javascript" language="Javascript1.2" charset="UTF-8"></script>
   <title>Exercise 5: Enabling the departure and price criteria on the Trip Search form</title>
</head>
<body>
<p align="right"><p align="right"><a href="00000135.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00000137.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<hr />
<h1>Exercise 5: Enabling the departure and price criteria on the Trip Search form</h1>
<p>In this exercise, you will modify the Trip Search Results page to add the criteria needed for the departure and price query. </p>
<h4>To enable the departure and price criteria:</h4>
<ol>
<li>
   Open the gettrips.cfc file.
</li>
<li>
   In the getTripsFromForm method, position the pointer before the <code>cfquery</code> code block.
</li>
<li>
   To build the <code>departureDate</code> WHERE subclause, enter or copy and paste the code in the following table immediately <i>before</i> the <code>cfquery</code> code block:
<table border="0" cellpadding="0" cellspacing="0">
  <tr>
    <th>
For this database
    </th>
    <th>
Enter this code
    </th>
  </tr>
  <tr>
    <td>
<p>(Windows users) Microsoft Access database file</p>
    </td>
    <td>
<pre>&lt;!--- Build subclause for departureDate ---&gt;
&lt;cfif Form.departureValue GT &quot;&quot;&gt;
&lt;cfif Form.departureOperator EQ &quot;EQUALS&quot;&gt;
&lt;cfset WhereClause = WhereClause &amp; &quot; and departureDate = &quot; &amp; CreateODBCDate(Form.departureValue)&gt;
&lt;cfelseif Form.departureOperator EQ &quot;AFTER&quot;&gt;
&lt;cfset WhereClause = WhereClause &amp; &quot; and departureDate&#160; &gt; &quot; &amp; CreateODBCDate(Form.departureValue)&gt;
&lt;cfelseif Form.departureOperator EQ &quot;BEFORE&quot;&gt;
&lt;cfset WhereClause = WhereClause &amp; &quot; and departureDate &#160;&lt; &#160;&quot; &amp; CreateODBCDate(Form.departureValue)&gt;
&lt;/cfif&gt;
&lt;/cfif&gt;
</pre>    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<p>(UNIX users) PointBase database file</p>
    </td>
    <td>
<pre>&lt;!--- Build subclause for departureDate ---&gt;
&lt;cfif Form.departureValue GT &quot;&quot;&gt;
&lt;cfif Form.departureOperator EQ &quot;EQUALS&quot;&gt;
&lt;cfset WhereClause = WhereClause &amp; &quot; and departureDate = Date &#39;&quot; &#160;&amp; &#160;Form.departureValue&#160; &amp; &#160;&quot;&#39;&quot;&gt; 
&lt;cfelseif Form.departureOperator EQ &quot;AFTER&quot;&gt;
&lt;cfset WhereClause = WhereClause &amp; &quot; and departureDate &gt; Date &#39;&quot; &#160;&amp;&#160;Form.departureValue &#160;&amp; &#160;&quot;&#39;&quot;&gt;
&lt;cfelseif Form.departureOperator EQ &quot;BEFORE&quot;&gt;
&lt;cfset WhereClause = WhereClause &amp; &quot; and departureDate &lt; Date &#39;&quot;&#160; &amp; &#160;Form.departureValue &#160;&amp;&#160; &quot;&#39;&quot;&gt;
&lt;/cfif&gt;
&lt;/cfif&gt;
</pre>    </td>
  </tr>
</table>

</li>
<li>
   To build the <code>price</code> WHERE subclause, enter the following code after the code you entered in the previous step.
<pre>
&lt;!--- Build subclause for price---&gt;		
&lt;cfif Form.priceValue GT &quot;&quot;&gt;			
	&lt;cfif Form.priceOperator EQ &quot;EQUALS&quot;&gt;			
		&lt;cfset WhereClause = WhereClause &amp; &quot; and price = &quot; &amp; form.priceValue&gt;
	&lt;cfelseif Form.priceOperator EQ &quot;GREATER&quot;&gt;
		&lt;cfset WhereClause = WhereClause &amp; &quot; and price &gt; &quot; &amp; form.priceValue&gt;
	&lt;cfelseif Form.priceOperator EQ &quot;SMALLER&quot;&gt;
		&lt;cfset WhereClause = WhereClause &amp; &quot; and price &lt; &quot; &amp; form.priceValue&gt;
	&lt;/cfif&gt;
&lt;/cfif&gt;
</pre>
</li>
<li>
   Save the file.
</li>
</ol>


<hr />
<p align="right"><p align="right"><a href="00000135.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00000137.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<p><a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00000136.htm" target="mm_window">View comments in LiveDocs</a></p>
 </body>
</html>



