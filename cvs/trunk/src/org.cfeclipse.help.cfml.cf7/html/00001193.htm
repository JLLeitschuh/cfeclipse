<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta http-equiv="Content-Style-Type" content="text/css">
   <script src="pages.js" type="text/javascript" language="Javascript1.2" charset="UTF-8"></script>
   <title>Example: securitytest.cfm</title>
</head>
<body>
<p align="right"><p align="right"><a href="00001192.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001194.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<hr />
<h1>Example: securitytest.cfm</h1>
<p>The securitytest.cfm page shows how any application page can use ColdFusion user authorization features. Application.cfc ensures the existence of an authenticated user before the page content appears. The securitytest.cfm page uses the <a href="00000533.htm#4047189"><code>IsUserInRole</code></a> and <a href="00000469.htm#4046631"><code>GetAuthUser</code></a> functions to control the information that is displayed.</p>
<p>The securitytest.cfm page consists of the following:</p>
<pre>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;html&gt;
&lt;head&gt;
   &lt;title&gt;Security test page&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;
&lt;cfoutput&gt;
   &lt;h2&gt;Welcome #GetAuthUser()#!&lt;/h2&gt;
&lt;/cfoutput&gt;

ALL Logged-in Users see this message.&lt;br&gt;
&lt;br&gt;
&lt;cfscript&gt;
   if (IsUserInRole(&quot;Human Resources&quot;))
      WriteOutput(&quot;Human Resources members see this message.&lt;br&gt;&lt;br&gt;&quot;);
   if (IsUserInRole(&quot;Documentation&quot;))
      WriteOutput(&quot;Documentation members see this message.&lt;br&gt;&lt;br&gt;&quot;);
   if (IsUserInRole(&quot;Sales&quot;))
      WriteOutput(&quot;Sales members see this message.&lt;br&gt;&lt;br&gt;&quot;);
   if (IsUserInRole(&quot;Manager&quot;))
      WriteOutput(&quot;Managers see this message.&lt;br&gt;&lt;br&gt;&quot;);
   if (IsUserInRole(&quot;Employee&quot;))
      WriteOutput(&quot;Employees see this message.&lt;br&gt;&lt;br&gt;&quot;);
   if (IsUserInRole(&quot;Contractor&quot;))
      WriteOutput(&quot;Contractors see this message.&lt;br&gt;&lt;br&gt;&quot;);
&lt;/cfscript&gt;

&lt;/body&gt;
&lt;/html&gt;
</pre><h4><a name="wp1117341"></a>Reviewing the code</h4>
<p>The following table describes the securitytest.cfm page CFML code and its function:</p>
<table border="0" cellpadding="0" cellspacing="0">
  <tr>
    <th>
Code
    </th>
    <th>
Description
    </th>
  </tr>
  <tr>
    <td>
<pre>&lt;cfoutput&gt;
&lt;h2&gt;Welcome #GetAuthUser()#!&lt;/h2&gt;
&lt;/cfoutput&gt;
</pre>    </td>
    <td>
<p>Displays a welcome message that includes the user's login ID.</p>
    </td>
  </tr>
  <tr bgcolor="#F8F8F8">
    <td>
<pre>ALL Logged-in Users see this    message.&lt;br&gt;
&lt;br&gt;
</pre>    </td>
    <td>
<p>Displays this message in all cases. The page does not display until a user is logged in.</p>
    </td>
  </tr>
  <tr>
    <td>
<pre>&lt;cfscript&gt;
   if (IsUserInRole(&quot;Human Resources&quot;))
      WriteOutput(&quot;Human Resources members
      see this message.&lt;br&gt;&lt;br&gt;&quot;);
   if (IsUserInRole(&quot;Documentation&quot;))
      WriteOutput(&quot;Documentation members see
      this message.&lt;br&gt;&lt;br&gt;&quot;);
   if (IsUserInRole(&quot;Sales&quot;))
      WriteOutput(&quot;Sales members see this
      message.&lt;br&gt;&lt;br&gt;&quot;);
   if (IsUserInRole(&quot;Manager&quot;))
      WriteOutput(&quot;Managers see this
      message.&lt;br&gt;&lt;br&gt;&quot;);
   if (IsUserInRole(&quot;Employee&quot;))
      WriteOutput(&quot;Employees see this
      message.&lt;br&gt;&lt;br&gt;&quot;);
   if (IsUserInRole(&quot;Contractor&quot;))
      WriteOutput(&quot;Contractors see this
      message.&lt;br&gt;&lt;br&gt;&quot;);
&lt;/cfscript&gt;
</pre>    </td>
    <td>
<p>Tests whether the user belongs to each of the valid roles. If the user is in a role, displays a message with the role name.</p>
<p>The user sees one message per role to which he or she belongs.</p>
    </td>
  </tr>
</table>



<hr />
<p align="right"><p align="right"><a href="00001192.htm"><img src="images/previous.gif" width="9" height="14" border="0" alt="Previous"></a>&nbsp;&nbsp;<a href="00001194.htm"><img src="images/next.gif" width="9" height="14" border="0" alt="Next"></a>
</p></p>
<p><a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00001193.htm" target="mm_window">View comments in LiveDocs</a></p>
 </body>
</html>



